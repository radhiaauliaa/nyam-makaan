"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "lib_firestore_js";
exports.ids = ["lib_firestore_js"];
exports.modules = {

/***/ "./lib/firestore.js":
/*!**************************!*\
  !*** ./lib/firestore.js ***!
  \**************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   addPromo: () => (/* binding */ addPromo),\n/* harmony export */   addPromoAndUpdateRestaurant: () => (/* binding */ addPromoAndUpdateRestaurant),\n/* harmony export */   addReview: () => (/* binding */ addReview),\n/* harmony export */   addToFavorites: () => (/* binding */ addToFavorites),\n/* harmony export */   countUserApprovedReports: () => (/* binding */ countUserApprovedReports),\n/* harmony export */   createMenu: () => (/* binding */ createMenu),\n/* harmony export */   createNotification: () => (/* binding */ createNotification),\n/* harmony export */   createReservation: () => (/* binding */ createReservation),\n/* harmony export */   createReservationNotification: () => (/* binding */ createReservationNotification),\n/* harmony export */   createRestaurant: () => (/* binding */ createRestaurant),\n/* harmony export */   createSystemNotification: () => (/* binding */ createSystemNotification),\n/* harmony export */   createUserReservationNotification: () => (/* binding */ createUserReservationNotification),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   deleteAllOwnerNotifications: () => (/* binding */ deleteAllOwnerNotifications),\n/* harmony export */   deleteMenu: () => (/* binding */ deleteMenu),\n/* harmony export */   deleteNotification: () => (/* binding */ deleteNotification),\n/* harmony export */   deletePromo: () => (/* binding */ deletePromo),\n/* harmony export */   deleteReview: () => (/* binding */ deleteReview),\n/* harmony export */   getActivePromosForMenu: () => (/* binding */ getActivePromosForMenu),\n/* harmony export */   getActivePromosForRestaurant: () => (/* binding */ getActivePromosForRestaurant),\n/* harmony export */   getAllRestaurants: () => (/* binding */ getAllRestaurants),\n/* harmony export */   getAllUsers: () => (/* binding */ getAllUsers),\n/* harmony export */   getDashboardStats: () => (/* binding */ getDashboardStats),\n/* harmony export */   getLowRatedRestaurants: () => (/* binding */ getLowRatedRestaurants),\n/* harmony export */   getMenuById: () => (/* binding */ getMenuById),\n/* harmony export */   getMenusByRestaurant: () => (/* binding */ getMenusByRestaurant),\n/* harmony export */   getMenusByRestaurantId: () => (/* binding */ getMenusByRestaurantId),\n/* harmony export */   getOwnerNotifications: () => (/* binding */ getOwnerNotifications),\n/* harmony export */   getOwnerRestaurants: () => (/* binding */ getOwnerRestaurants),\n/* harmony export */   getOwnerReviews: () => (/* binding */ getOwnerReviews),\n/* harmony export */   getPendingRestaurantsCount: () => (/* binding */ getPendingRestaurantsCount),\n/* harmony export */   getPromoById: () => (/* binding */ getPromoById),\n/* harmony export */   getPromosByRestaurantId: () => (/* binding */ getPromosByRestaurantId),\n/* harmony export */   getReportedUsersByStatus: () => (/* binding */ getReportedUsersByStatus),\n/* harmony export */   getReports: () => (/* binding */ getReports),\n/* harmony export */   getRestaurantById: () => (/* binding */ getRestaurantById),\n/* harmony export */   getRestaurantReservations: () => (/* binding */ getRestaurantReservations),\n/* harmony export */   getRestaurantReviews: () => (/* binding */ getRestaurantReviews),\n/* harmony export */   getRestaurantReviewsSummary: () => (/* binding */ getRestaurantReviewsSummary),\n/* harmony export */   getRestaurantsByOwner: () => (/* binding */ getRestaurantsByOwner),\n/* harmony export */   getReviewById: () => (/* binding */ getReviewById),\n/* harmony export */   getReviewReports: () => (/* binding */ getReviewReports),\n/* harmony export */   getSystemNotifications: () => (/* binding */ getSystemNotifications),\n/* harmony export */   getUnreadNotificationCount: () => (/* binding */ getUnreadNotificationCount),\n/* harmony export */   getUnreadNotificationsCount: () => (/* binding */ getUnreadNotificationsCount),\n/* harmony export */   getUnreadSystemNotificationsCount: () => (/* binding */ getUnreadSystemNotificationsCount),\n/* harmony export */   getUserById: () => (/* binding */ getUserById),\n/* harmony export */   getUserFavorites: () => (/* binding */ getUserFavorites),\n/* harmony export */   getUserNotifications: () => (/* binding */ getUserNotifications),\n/* harmony export */   getUserNotificationsOnce: () => (/* binding */ getUserNotificationsOnce),\n/* harmony export */   getUserReviews: () => (/* binding */ getUserReviews),\n/* harmony export */   getUsersWithApprovedReports: () => (/* binding */ getUsersWithApprovedReports),\n/* harmony export */   getUsersWithRepeatedNegativeReviews: () => (/* binding */ getUsersWithRepeatedNegativeReviews),\n/* harmony export */   isRestaurantFavorite: () => (/* binding */ isRestaurantFavorite),\n/* harmony export */   markAllNotificationsAsRead: () => (/* binding */ markAllNotificationsAsRead),\n/* harmony export */   markAllSystemNotificationsAsRead: () => (/* binding */ markAllSystemNotificationsAsRead),\n/* harmony export */   markNotificationAsRead: () => (/* binding */ markNotificationAsRead),\n/* harmony export */   markSystemNotificationAsRead: () => (/* binding */ markSystemNotificationAsRead),\n/* harmony export */   removeFromFavorites: () => (/* binding */ removeFromFavorites),\n/* harmony export */   reportReview: () => (/* binding */ reportReview),\n/* harmony export */   subscribeToRestaurantReservations: () => (/* binding */ subscribeToRestaurantReservations),\n/* harmony export */   suspendRestaurantAccount: () => (/* binding */ suspendRestaurantAccount),\n/* harmony export */   suspendUserAccount: () => (/* binding */ suspendUserAccount),\n/* harmony export */   syncRestaurantRating: () => (/* binding */ syncRestaurantRating),\n/* harmony export */   toggleFavorite: () => (/* binding */ toggleFavorite),\n/* harmony export */   updateMenu: () => (/* binding */ updateMenu),\n/* harmony export */   updatePromo: () => (/* binding */ updatePromo),\n/* harmony export */   updateReportStatus: () => (/* binding */ updateReportStatus),\n/* harmony export */   updateRestaurant: () => (/* binding */ updateRestaurant),\n/* harmony export */   updateRestaurantOpenStatus: () => (/* binding */ updateRestaurantOpenStatus),\n/* harmony export */   updateRestaurantRating: () => (/* binding */ updateRestaurantRating),\n/* harmony export */   updateRestaurantStatus: () => (/* binding */ updateRestaurantStatus),\n/* harmony export */   updateReviewReply: () => (/* binding */ updateReviewReply),\n/* harmony export */   updateUser: () => (/* binding */ updateUser),\n/* harmony export */   updateUserRole: () => (/* binding */ updateUserRole)\n/* harmony export */ });\n/* harmony import */ var firebase_firestore__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! firebase/firestore */ \"firebase/firestore\");\n/* harmony import */ var _firebase__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./firebase */ \"./lib/firebase.js\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([firebase_firestore__WEBPACK_IMPORTED_MODULE_0__, _firebase__WEBPACK_IMPORTED_MODULE_1__]);\n([firebase_firestore__WEBPACK_IMPORTED_MODULE_0__, _firebase__WEBPACK_IMPORTED_MODULE_1__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n// =======================================================================\n// FIRESTORE IMPORTS\n// =======================================================================\n\n\n// Helper\nconst asDate = (v)=>v?.toDate?.() || v;\n// =======================================================================\n// ============================= ADMIN HELPERS ============================\n// =======================================================================\n// Get users with approved reports aggregated by userId\nconst getUsersWithApprovedReports = async (minCount = 1)=>{\n    try {\n        const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"reports\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"status\", \"==\", \"approved\"));\n        const snap = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n        const counts = new Map();\n        const lastCreatedAt = new Map();\n        const byUser = new Map();\n        snap.forEach((d)=>{\n            const data = d.data();\n            const uid = data.userId;\n            if (!uid) return;\n            counts.set(uid, (counts.get(uid) || 0) + 1);\n            const created = asDate(data.createdAt);\n            const prev = lastCreatedAt.get(uid);\n            if (!prev || created && created > prev) lastCreatedAt.set(uid, created);\n            byUser.set(uid, true);\n        });\n        const results = [];\n        for (const uid of byUser.keys()){\n            const count = counts.get(uid) || 0;\n            if (count >= minCount) {\n                // fetch user minimal profile\n                const userSnap = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"users\", uid));\n                const user = userSnap.exists() ? userSnap.data() : {};\n                results.push({\n                    userId: uid,\n                    count,\n                    lastReportAt: lastCreatedAt.get(uid) || null,\n                    displayName: user.displayName || user.name || \"\",\n                    email: user.email || \"\"\n                });\n            }\n        }\n        // sort by count desc\n        results.sort((a, b)=>b.count - a.count);\n        return {\n            success: true,\n            data: results\n        };\n    } catch (err) {\n        console.error(\"❌ [Firestore] getUsersWithApprovedReports error:\", err);\n        return {\n            success: false,\n            error: err.message,\n            data: []\n        };\n    }\n};\n// Get users who posted negative reviews repeatedly for the same restaurant\nconst getUsersWithRepeatedNegativeReviews = async (threshold = 10)=>{\n    try {\n        const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"reviews\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"rating\", \"<=\", 2));\n        const snap = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n        const keyCounts = new Map(); // key = `${userId}_${restaurantId}`\n        const lastAt = new Map();\n        snap.forEach((d)=>{\n            const data = d.data();\n            const uid = data.userId;\n            const rid = data.restaurantId;\n            if (!uid || !rid) return;\n            const key = `${uid}_${rid}`;\n            keyCounts.set(key, (keyCounts.get(key) || 0) + 1);\n            const created = asDate(data.createdAt);\n            const prev = lastAt.get(key);\n            if (!prev || created && created > prev) lastAt.set(key, created);\n        });\n        const results = [];\n        for (const [key, count] of keyCounts.entries()){\n            if (count >= threshold) {\n                const [userId, restaurantId] = key.split(\"_\");\n                const userSnap = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"users\", userId));\n                const user = userSnap.exists() ? userSnap.data() : {};\n                const restSnap = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"restaurants\", restaurantId));\n                const restaurant = restSnap.exists() ? restSnap.data() : {};\n                results.push({\n                    userId,\n                    restaurantId,\n                    count,\n                    lastAt: lastAt.get(key) || null,\n                    userName: user.displayName || user.name || \"\",\n                    userEmail: user.email || \"\",\n                    restaurantName: restaurant.name || \"\"\n                });\n            }\n        }\n        // sort by count desc\n        results.sort((a, b)=>b.count - a.count);\n        return {\n            success: true,\n            data: results\n        };\n    } catch (err) {\n        console.error(\"❌ [Firestore] getUsersWithRepeatedNegativeReviews error:\", err);\n        return {\n            success: false,\n            error: err.message,\n            data: []\n        };\n    }\n};\n// Get low-rated restaurants\nconst getLowRatedRestaurants = async (threshold = 2)=>{\n    try {\n        const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"restaurants\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"rating\", \"<\", threshold));\n        const snap = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n        const data = snap.docs.map((d)=>({\n                id: d.id,\n                ...d.data()\n            }));\n        return {\n            success: true,\n            data\n        };\n    } catch (err) {\n        console.error(\"❌ [Firestore] getLowRatedRestaurants error:\", err);\n        return {\n            success: false,\n            error: err.message,\n            data: []\n        };\n    }\n};\n// Get reported users from reviewReports by status (default: pending)\nconst getReportedUsersByStatus = async (status = \"pending\")=>{\n    try {\n        const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"reviewReports\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"reportStatus\", \"==\", status), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.orderBy)(\"createdAt\", \"desc\"));\n        const snap = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n        // Map reviewId -> report createdAt\n        const reviewIds = new Set();\n        const createdMap = new Map();\n        snap.forEach((d)=>{\n            const data = d.data();\n            const reviewId = data.reviewId;\n            if (reviewId) {\n                reviewIds.add(reviewId);\n                const created = asDate(data.createdAt);\n                const prev = createdMap.get(reviewId);\n                if (!prev || created && created > prev) createdMap.set(reviewId, created);\n            }\n        });\n        // Fetch related reviews to resolve userId\n        const reviewDocs = await Promise.all(Array.from(reviewIds).map((rid)=>(0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"reviews\", rid))));\n        const userCounts = new Map();\n        const userLast = new Map();\n        const userSet = new Set();\n        reviewDocs.forEach((snap)=>{\n            if (!snap.exists()) return;\n            const data = snap.data();\n            const uid = data.userId;\n            if (!uid) return;\n            userSet.add(uid);\n            userCounts.set(uid, (userCounts.get(uid) || 0) + 1);\n            const last = userLast.get(uid);\n            const created = createdMap.get(snap.id);\n            if (!last || created && created > last) userLast.set(uid, created);\n        });\n        // Fetch minimal user profiles\n        const users = await Promise.all(Array.from(userSet).map((uid)=>(0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"users\", uid)).then((d)=>({\n                    uid,\n                    d\n                }))));\n        const results = users.map(({ uid, d })=>{\n            const data = d.exists() ? d.data() : {};\n            return {\n                userId: uid,\n                displayName: data.displayName || data.name || \"\",\n                email: data.email || \"\",\n                count: userCounts.get(uid) || 0,\n                lastReportAt: userLast.get(uid) || null\n            };\n        }).sort((a, b)=>b.count - a.count);\n        return {\n            success: true,\n            data: results\n        };\n    } catch (err) {\n        console.error(\"❌ [Firestore] getReportedUsersByStatus error:\", err);\n        return {\n            success: false,\n            error: err.message,\n            data: []\n        };\n    }\n};\n// =======================================================================\n// ============================ PROMO FUNCTIONS ==========================\n// =======================================================================\n// Add promo AND update restaurant\nconst addPromoAndUpdateRestaurant = async (promoData)=>{\n    try {\n        console.log(\"\\uD83D\\uDD04 [Firestore] Adding promo and updating restaurant...\");\n        // 1. Add promo to promos collection\n        const promoRef = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.addDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"promos\"), {\n            ...promoData,\n            createdAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)(),\n            updatedAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n        });\n        // 2. Update restaurant with promo data\n        const restaurantRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"restaurants\", promoData.restaurantId);\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(restaurantRef, {\n            isPromo: true,\n            discount: promoData.discountValue,\n            minPurchase: promoData.minPurchase || 50000,\n            promoExpiry: promoData.endDate,\n            promoTitle: promoData.name,\n            promoDescription: promoData.description,\n            promoText: `Diskon ${promoData.discountValue}% ${promoData.discountType === \"percentage\" ? \"\" : \"Rp\"}`,\n            updatedAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n        });\n        console.log(\"✅ [Firestore] Promo added and restaurant updated successfully\");\n        return promoRef.id;\n    } catch (error) {\n        console.error(\"❌ [Firestore] Error adding promo and updating restaurant:\", error);\n        throw error;\n    }\n};\n// Update existing addPromo function to also update restaurant\nconst addPromo = async (promoData)=>{\n    try {\n        // Use the new function that updates both\n        return await addPromoAndUpdateRestaurant(promoData);\n    } catch (error) {\n        console.error(\"❌ [Firestore] Error in addPromo:\", error);\n        throw error;\n    }\n};\n// Get active promos for restaurant\nconst getActivePromosForRestaurant = async (restaurantId)=>{\n    try {\n        console.log(\"\\uD83D\\uDD0D [Firestore] Getting active promos for restaurant:\", restaurantId);\n        const today = new Date();\n        today.setHours(0, 0, 0, 0);\n        const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"promos\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"restaurantId\", \"==\", restaurantId), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"status\", \"==\", \"active\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"startDate\", \"<=\", today), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"endDate\", \">=\", today));\n        const querySnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n        const promos = [];\n        querySnapshot.forEach((doc)=>{\n            const data = doc.data();\n            promos.push({\n                id: doc.id,\n                ...data,\n                startDate: asDate(data.startDate),\n                endDate: asDate(data.endDate)\n            });\n        });\n        console.log(`✅ [Firestore] Found ${promos.length} active promos for restaurant ${restaurantId}`);\n        return promos;\n    } catch (error) {\n        console.error(\"❌ [Firestore] Error getting active promos:\", error);\n        return [];\n    }\n};\n// =======================================================================\n// ============================ MENUS & RESTAURANT =======================\n// =======================================================================\n// Get menu by restaurantId (UPDATED)\nconst getMenusByRestaurantId = async (restaurantId)=>{\n    try {\n        console.log(\"\\uD83D\\uDD0D [Firestore] Searching menus in SUBCOLLECTION for restaurant:\", restaurantId);\n        // Query dari subcollection: restaurants/{restaurantId}/menus\n        const menusRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"restaurants\", restaurantId, \"menus\");\n        const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(menusRef);\n        const querySnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n        const menus = [];\n        querySnapshot.forEach((doc)=>{\n            const menuData = doc.data();\n            console.log(\"\\uD83D\\uDCC4 [Firestore] Menu document from subcollection:\", doc.id, menuData);\n            menus.push({\n                id: doc.id,\n                ...menuData,\n                restaurantId: restaurantId\n            });\n        });\n        console.log(\"✅ [Firestore] Found\", menus.length, \"menus in subcollection\");\n        return menus;\n    } catch (error) {\n        console.error(\"❌ [Firestore] Error getting menus from subcollection:\", error);\n        // Fallback: coba dari collection menus yang lama (jika ada)\n        try {\n            console.log(\"\\uD83D\\uDD04 [Firestore] Trying fallback: collection menus...\");\n            const fallbackQuery = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"menus\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"restaurantId\", \"==\", restaurantId));\n            const fallbackSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(fallbackQuery);\n            const fallbackMenus = [];\n            fallbackSnapshot.forEach((doc)=>{\n                fallbackMenus.push({\n                    id: doc.id,\n                    ...doc.data()\n                });\n            });\n            console.log(\"✅ [Firestore] Fallback found:\", fallbackMenus.length, \"menus\");\n            return fallbackMenus;\n        } catch (fallbackError) {\n            console.error(\"❌ [Firestore] Fallback also failed:\", fallbackError);\n            return [];\n        }\n    }\n};\nconst getActivePromosForMenu = async (menuId)=>{\n    try {\n        console.log(\"\\uD83D\\uDD0D [Firestore] Getting active promos for menu:\", menuId);\n        const today = new Date();\n        today.setHours(0, 0, 0, 0);\n        const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"promos\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"menuIds\", \"array-contains\", menuId), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"status\", \"==\", \"active\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"startDate\", \"<=\", today), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"endDate\", \">=\", today));\n        const querySnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n        const promos = [];\n        querySnapshot.forEach((doc)=>{\n            const promoData = doc.data();\n            promos.push({\n                id: doc.id,\n                ...promoData,\n                startDate: asDate(promoData.startDate),\n                endDate: asDate(promoData.endDate)\n            });\n        });\n        console.log(`✅ [Firestore] Found ${promos.length} active promos for menu ${menuId}`);\n        return promos;\n    } catch (error) {\n        console.error(\"❌ [Firestore] Error getting active promos:\", error);\n        return [];\n    }\n};\n// Get restaurant by ID (UPDATED)\nconst getRestaurantById = async (restaurantId)=>{\n    try {\n        const docRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"restaurants\", restaurantId);\n        const docSnap = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(docRef);\n        if (docSnap.exists()) {\n            return {\n                id: docSnap.id,\n                ...docSnap.data()\n            };\n        } else {\n            throw new Error(\"Restaurant not found\");\n        }\n    } catch (error) {\n        console.error(\"❌ [Firestore] Error getting restaurant:\", error);\n        throw error;\n    }\n};\n// Get restaurants by owner (UPDATED)\nconst getRestaurantsByOwner = async (ownerId)=>{\n    try {\n        const restaurantsRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"restaurants\");\n        const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(restaurantsRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"ownerId\", \"==\", ownerId));\n        const querySnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n        const restaurants = [];\n        querySnapshot.forEach((doc)=>{\n            restaurants.push({\n                id: doc.id,\n                ...doc.data()\n            });\n        });\n        return restaurants;\n    } catch (error) {\n        console.error(\"❌ [Firestore] Error getting restaurants:\", error);\n        throw error;\n    }\n};\n// =======================================================================\n// ============================ SYSTEM NOTIFICATIONS =====================\n// =======================================================================\nconst getSystemNotifications = async (limitCount = 20)=>{\n    try {\n        const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"systemNotifications\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.orderBy)(\"createdAt\", \"desc\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.limit)(limitCount));\n        const snap = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n        const result = [];\n        snap.forEach((d)=>{\n            const data = d.data();\n            result.push({\n                id: d.id,\n                ...data,\n                createdAt: asDate(data.createdAt),\n                readAt: asDate(data.readAt)\n            });\n        });\n        return result;\n    } catch (err) {\n        console.error(\"❌ [Firestore] getSystemNotifications error:\", err);\n        throw err;\n    }\n};\nconst getPendingRestaurantsCount = async ()=>{\n    try {\n        const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"restaurants\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"status\", \"==\", \"pending\"));\n        const snap = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n        return snap.size;\n    } catch (err) {\n        console.error(\"❌ [Firestore] getPendingRestaurantsCount error:\", err);\n        throw err;\n    }\n};\nconst createSystemNotification = async (title, message, type = \"system\", relatedId = null)=>{\n    try {\n        const ref = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"systemNotifications\"));\n        const data = {\n            id: ref.id,\n            title,\n            message,\n            type,\n            relatedId,\n            userId: \"system\",\n            read: false,\n            createdAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n        };\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.setDoc)(ref, data);\n        return {\n            success: true,\n            id: ref.id\n        };\n    } catch (err) {\n        console.error(\"❌ [Firestore] createSystemNotification error:\", err);\n        return {\n            success: false,\n            error: err.message\n        };\n    }\n};\nconst getUnreadSystemNotificationsCount = async ()=>{\n    try {\n        const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"systemNotifications\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"read\", \"==\", false), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"userId\", \"==\", \"system\"));\n        const snap = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n        return {\n            success: true,\n            count: snap.size\n        };\n    } catch (err) {\n        console.error(\"❌ [Firestore] getUnreadSystemNotificationsCount error:\", err);\n        return {\n            success: false,\n            count: 0\n        };\n    }\n};\nconst markAllSystemNotificationsAsRead = async ()=>{\n    try {\n        const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"systemNotifications\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"read\", \"==\", false), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"userId\", \"==\", \"system\"));\n        const snap = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n        const batch = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.writeBatch)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db);\n        snap.docs.forEach((docSnap)=>{\n            const ref = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"systemNotifications\", docSnap.id);\n            batch.update(ref, {\n                read: true,\n                readAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n            });\n        });\n        await batch.commit();\n        return {\n            success: true,\n            message: `${snap.size} notifikasi sistem ditandai sebagai dibaca`\n        };\n    } catch (err) {\n        console.error(\"❌ [Firestore] markAllSystemNotificationsAsRead error:\", err);\n        return {\n            success: false,\n            error: err.message\n        };\n    }\n};\nconst markSystemNotificationAsRead = async (notificationId)=>{\n    try {\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"systemNotifications\", notificationId), {\n            read: true,\n            readAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n        });\n        return {\n            success: true\n        };\n    } catch (err) {\n        console.error(\"❌ [Firestore] markSystemNotificationAsRead error:\", err);\n        return {\n            success: false,\n            error: err.message\n        };\n    }\n};\n// =======================================================================\n// =============================== USER FUNCTIONS ========================\n// =======================================================================\nconst updateUser = async (userId, updateData)=>{\n    try {\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"users\", userId), {\n            ...updateData,\n            updatedAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n        });\n        return {\n            success: true\n        };\n    } catch (err) {\n        return {\n            success: false,\n            error: err.message\n        };\n    }\n};\nconst getAllUsers = async ()=>{\n    try {\n        const snap = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"users\"));\n        return snap.docs.map((d)=>({\n                id: d.id,\n                ...d.data(),\n                createdAt: asDate(d.data().createdAt)\n            }));\n    } catch (err) {\n        console.error(\"❌ [Firestore] getAllUsers error:\", err);\n        throw err;\n    }\n};\n// =======================================================================\n// ============================== RESTAURANTS ============================\n// =======================================================================\nconst createRestaurant = async (restaurantData)=>{\n    try {\n        const existingRestaurants = await getRestaurantsByOwner(restaurantData.ownerId);\n        if (existingRestaurants.length > 0) {\n            throw new Error(\"Anda sudah memiliki restoran. Setiap owner hanya boleh memiliki 1 restoran.\");\n        }\n        const docRef = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.addDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"restaurants\"), {\n            ...restaurantData,\n            createdAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)(),\n            updatedAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n        });\n        // Notify admin about new restaurant registration\n        try {\n            const title = \"Pendaftaran Restoran Baru\";\n            const message = `${restaurantData.name || \"Restoran\"} menunggu verifikasi admin.`;\n            await createSystemNotification(title, message, \"restaurant_registration\", docRef.id);\n        } catch (e) {\n            console.warn(\"Failed to create admin notification for restaurant registration:\", e?.message || e);\n        }\n        return docRef.id;\n    } catch (error) {\n        console.error(\"❌ [Firestore] Error creating restaurant:\", error);\n        throw error;\n    }\n};\nconst getAllRestaurants = async ()=>{\n    try {\n        const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"restaurants\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.orderBy)(\"createdAt\", \"desc\"));\n        const querySnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n        const restaurants = [];\n        querySnapshot.forEach((doc)=>{\n            restaurants.push({\n                id: doc.id,\n                ...doc.data()\n            });\n        });\n        return restaurants;\n    } catch (error) {\n        console.error(\"❌ [Firestore] Error getting restaurants:\", error);\n        throw error;\n    }\n};\nconst updateRestaurantStatus = async (restaurantId, status, rejectionReason = null)=>{\n    try {\n        const restaurantRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"restaurants\", restaurantId);\n        const updateData = {\n            status,\n            updatedAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n        };\n        if (rejectionReason) {\n            updateData.rejectionReason = rejectionReason;\n            updateData.rejectionDate = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)();\n        }\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(restaurantRef, updateData);\n    } catch (error) {\n        console.error(\"❌ [Firestore] Error updating restaurant status:\", error);\n        throw error;\n    }\n};\nconst updateRestaurant = async (restaurantId, data)=>{\n    try {\n        const restaurantRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"restaurants\", restaurantId);\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(restaurantRef, {\n            ...data,\n            updatedAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n        });\n        console.log(\"✅ [Firestore] Restaurant updated successfully:\", restaurantId);\n        return true;\n    } catch (error) {\n        console.error(\"❌ [Firestore] Error updating restaurant:\", error);\n        throw error;\n    }\n};\n// =======================================================================\n// ============================= RESERVATIONS ============================\n// =======================================================================\nconst getRestaurantReservations = async (restaurantId)=>{\n    try {\n        const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"reservations\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"restaurantId\", \"==\", restaurantId), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.orderBy)(\"createdAt\", \"desc\"));\n        const snap = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n        return snap.docs.map((d)=>({\n                id: d.id,\n                ...d.data(),\n                createdAt: asDate(d.data().createdAt),\n                date: asDate(d.data().date)\n            }));\n    } catch (err) {\n        console.error(\"❌ [Firestore] getRestaurantReservations error:\", err);\n        throw err;\n    }\n};\n// =======================================================================\n// =============================== FAVORITES =============================\n// =======================================================================\nconst isRestaurantFavorite = async (userId, restaurantId)=>{\n    try {\n        const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"favorites\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"userId\", \"==\", userId), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"restaurantId\", \"==\", restaurantId));\n        const querySnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n        return {\n            success: true,\n            isFavorite: !querySnapshot.empty\n        };\n    } catch (error) {\n        console.error(\"❌ [Firestore] Error checking favorite:\", error);\n        return {\n            success: false,\n            error: error.message,\n            isFavorite: false\n        };\n    }\n};\nconst addToFavorites = async (userId, restaurantId, restaurantData)=>{\n    try {\n        console.log(\"➕ [Firestore] Adding to favorites:\", {\n            userId,\n            restaurantId\n        });\n        const docId = `${userId}_${restaurantId}`;\n        const favoriteRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"favorites\", docId);\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.setDoc)(favoriteRef, {\n            userId,\n            restaurantId,\n            restaurantData,\n            addedAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n        });\n        console.log(\"✅ [Firestore] Successfully added to favorites\");\n        return {\n            success: true,\n            message: \"Restoran berhasil ditambahkan ke favorit\"\n        };\n    } catch (error) {\n        console.error(\"❌ [Firestore] Error adding to favorites:\", error);\n        return {\n            success: false,\n            error: error.message\n        };\n    }\n};\nconst removeFromFavorites = async (userId, restaurantId)=>{\n    try {\n        console.log(\"➖ [Firestore] Removing from favorites:\", {\n            userId,\n            restaurantId\n        });\n        const docId = `${userId}_${restaurantId}`;\n        const favoriteRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"favorites\", docId);\n        const favoriteSnap = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(favoriteRef);\n        if (favoriteSnap.exists()) {\n            await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.deleteDoc)(favoriteRef);\n            console.log(\"✅ [Firestore] Successfully removed from favorites\");\n            return {\n                success: true,\n                message: \"Restoran berhasil dihapus dari favorit\"\n            };\n        } else {\n            console.log(\"⚠️ [Firestore] Favorite not found\");\n            return {\n                success: false,\n                error: \"Favorite not found\"\n            };\n        }\n    } catch (error) {\n        console.error(\"❌ [Firestore] Error removing from favorites:\", error);\n        return {\n            success: false,\n            error: error.message\n        };\n    }\n};\nconst getUserFavorites = async (userId)=>{\n    try {\n        console.log(\"\\uD83D\\uDD0D [Firestore] Getting favorites for user:\", userId);\n        const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"favorites\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"userId\", \"==\", userId));\n        const querySnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n        console.log(\"✅ [Firestore] Found\", querySnapshot.size, \"favorites\");\n        const favorites = [];\n        for (const docSnap of querySnapshot.docs){\n            const data = docSnap.data();\n            let restaurantData = data.restaurantData;\n            if (!restaurantData || Object.keys(restaurantData).length === 0) {\n                console.log(\"⚠️ [Firestore] restaurantData is null for:\", data.restaurantId);\n                try {\n                    const restaurantDoc = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"restaurants\", data.restaurantId));\n                    if (restaurantDoc.exists()) {\n                        const restaurant = restaurantDoc.data();\n                        restaurantData = {\n                            name: restaurant.name || \"Restoran\",\n                            image: restaurant.image || null,\n                            category: restaurant.category || \"Restoran\",\n                            description: restaurant.description || \"\",\n                            rating: restaurant.rating || 0\n                        };\n                        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"favorites\", docSnap.id), {\n                            restaurantData: restaurantData\n                        });\n                        console.log(\"\\uD83D\\uDD04 [Firestore] Updated restaurantData for:\", data.restaurantId);\n                    }\n                } catch (fetchError) {\n                    console.error(\"❌ [Firestore] Error fetching restaurant:\", fetchError);\n                    restaurantData = {\n                        name: \"Restoran\",\n                        restaurantId: data.restaurantId\n                    };\n                }\n            }\n            favorites.push({\n                id: docSnap.id,\n                restaurantId: data.restaurantId,\n                userId: data.userId,\n                restaurantData: restaurantData,\n                addedAt: asDate(data.addedAt)\n            });\n        }\n        console.log(\"\\uD83D\\uDCCA [Firestore] Returning\", favorites.length, \"favorites\");\n        return {\n            success: true,\n            data: favorites\n        };\n    } catch (error) {\n        console.error(\"❌ [Firestore] Error getting user favorites:\", error);\n        return {\n            success: false,\n            error: error.message,\n            data: []\n        };\n    }\n};\nconst toggleFavorite = async (userId, restaurantId, restaurantData = null)=>{\n    try {\n        console.log(\"\\uD83D\\uDD04 [ToggleFavorite] Toggling:\", {\n            userId,\n            restaurantId,\n            restaurantData: restaurantData ? \"exists\" : \"null\"\n        });\n        const docId = `${userId}_${restaurantId}`;\n        const favoriteRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"favorites\", docId);\n        const favoriteSnap = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(favoriteRef);\n        if (favoriteSnap.exists()) {\n            await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.deleteDoc)(favoriteRef);\n            return {\n                success: true,\n                action: \"removed\",\n                message: \"Restoran dihapus dari favorit\",\n                isFavorite: false\n            };\n        } else {\n            let restData = restaurantData;\n            if (!restData) {\n                try {\n                    const restaurantDoc = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"restaurants\", restaurantId));\n                    if (restaurantDoc.exists()) {\n                        const restaurant = restaurantDoc.data();\n                        restData = {\n                            name: restaurant.name || \"Restoran\",\n                            image: restaurant.image || null,\n                            category: restaurant.category || \"Restoran\",\n                            description: restaurant.description || \"\",\n                            rating: restaurant.rating || 0,\n                            priceRange: restaurant.priceRange || \"\",\n                            address: restaurant.address || \"\"\n                        };\n                        console.log(\"\\uD83D\\uDCE6 [ToggleFavorite] Fetched restaurant data:\", restData.name);\n                    }\n                } catch (fetchError) {\n                    console.error(\"❌ [ToggleFavorite] Error fetching restaurant data:\", fetchError);\n                    restData = {\n                        name: \"Restoran\",\n                        restaurantId: restaurantId\n                    };\n                }\n            }\n            await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.setDoc)(favoriteRef, {\n                userId,\n                restaurantId,\n                restaurantData: restData,\n                addedAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n            });\n            console.log(\"✅ [ToggleFavorite] Added to favorites with data\");\n            return {\n                success: true,\n                action: \"added\",\n                message: \"Restoran ditambahkan ke favorit\",\n                isFavorite: true\n            };\n        }\n    } catch (error) {\n        console.error(\"❌ [ToggleFavorite] Error:\", error);\n        return {\n            success: false,\n            error: error.message,\n            action: \"error\"\n        };\n    }\n};\n// =======================================================================\n// ============================ NOTIFICATIONS SYSTEM =====================\n// =======================================================================\nconst createNotification = async (notificationData)=>{\n    try {\n        const notificationRef = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.addDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"notifications\"), {\n            ...notificationData,\n            isRead: false,\n            createdAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)(),\n            updatedAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n        });\n        return {\n            success: true,\n            notificationId: notificationRef.id\n        };\n    } catch (error) {\n        console.error(\"Error creating notification:\", error);\n        return {\n            success: false,\n            error: error.message\n        };\n    }\n};\nconst getOwnerNotifications = (ownerId, callback)=>{\n    if (!ownerId) {\n        console.error(\"Owner ID is required\");\n        callback([]);\n        return ()=>{};\n    }\n    try {\n        const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"notifications\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"ownerId\", \"==\", ownerId), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.orderBy)(\"createdAt\", \"desc\"));\n        const unsubscribe = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.onSnapshot)(q, (querySnapshot)=>{\n            const notifications = [];\n            querySnapshot.forEach((doc)=>{\n                notifications.push({\n                    id: doc.id,\n                    ...doc.data()\n                });\n            });\n            console.log(\"Notifications fetched:\", notifications.length); // Debug log\n            callback(notifications);\n        }, (error)=>{\n            console.error(\"Error fetching notifications:\", error);\n            callback([]);\n        });\n        return unsubscribe;\n    } catch (error) {\n        console.error(\"Error setting up notifications listener:\", error);\n        callback([]);\n        return ()=>{};\n    }\n};\nconst getUnreadNotificationCount = async (ownerId)=>{\n    try {\n        const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"notifications\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"ownerId\", \"==\", ownerId), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"isRead\", \"==\", false));\n        const querySnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n        return {\n            success: true,\n            count: querySnapshot.size\n        };\n    } catch (error) {\n        console.error(\"Error getting unread count:\", error);\n        return {\n            success: false,\n            error: error.message,\n            count: 0\n        };\n    }\n};\nconst markNotificationAsRead = async (notificationId)=>{\n    try {\n        const notificationRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"notifications\", notificationId);\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(notificationRef, {\n            isRead: true\n        });\n        return {\n            success: true\n        };\n    } catch (error) {\n        console.error(\"Error marking notification as read:\", error);\n        return {\n            success: false,\n            error: error.message\n        };\n    }\n};\nconst markAllNotificationsAsRead = async (ownerId)=>{\n    try {\n        const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"notifications\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"ownerId\", \"==\", ownerId), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"isRead\", \"==\", false));\n        const querySnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n        const batch = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.writeBatch)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db);\n        querySnapshot.forEach((docSnapshot)=>{\n            const notificationRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"notifications\", docSnapshot.id);\n            batch.update(notificationRef, {\n                isRead: true\n            });\n        });\n        await batch.commit();\n        return {\n            success: true\n        };\n    } catch (error) {\n        console.error(\"Error marking all notifications as read:\", error);\n        return {\n            success: false,\n            error: error.message\n        };\n    }\n};\nconst createReservation = async (reservationData)=>{\n    try {\n        const reservationRef = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.addDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"reservations\"), {\n            ...reservationData,\n            createdAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)(),\n            updatedAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n        });\n        const reservationId = reservationRef.id;\n        const restaurantRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"restaurants\", reservationData.restaurantId);\n        const restaurantDoc = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(restaurantRef);\n        if (restaurantDoc.exists()) {\n            const restaurant = restaurantDoc.data();\n            await createNotification({\n                type: \"new_reservation\",\n                title: \"Reservasi Baru\",\n                message: `${reservationData.customerName} membuat reservasi untuk ${reservationData.guestCount} orang`,\n                ownerId: restaurant.ownerId,\n                restaurantId: reservationData.restaurantId,\n                restaurantName: restaurant.name,\n                reservationId: reservationId,\n                customerName: reservationData.customerName,\n                guestCount: reservationData.guestCount,\n                date: reservationData.date,\n                time: reservationData.time,\n                status: \"pending\"\n            });\n        }\n        return {\n            success: true,\n            reservationId\n        };\n    } catch (error) {\n        console.error(\"Error creating reservation:\", error);\n        return {\n            success: false,\n            error: error.message\n        };\n    }\n};\nconst deleteNotification = async (notificationId)=>{\n    try {\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.deleteDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"notifications\", notificationId));\n        return {\n            success: true\n        };\n    } catch (error) {\n        console.error(\"Error deleting notification:\", error);\n        return {\n            success: false,\n            error: error.message\n        };\n    }\n};\nconst deleteAllOwnerNotifications = async (ownerId)=>{\n    try {\n        const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"notifications\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"ownerId\", \"==\", ownerId));\n        const snapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n        const batch = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.writeBatch)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db);\n        snapshot.forEach((doc)=>{\n            batch.delete(doc.ref);\n        });\n        await batch.commit();\n        return {\n            success: true\n        };\n    } catch (error) {\n        console.error(\"Error deleting all notifications:\", error);\n        return {\n            success: false,\n            error: error.message\n        };\n    }\n};\nconst getUserNotifications = (userId, callback)=>{\n    try {\n        const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"notifications\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"userId\", \"==\", userId), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.orderBy)(\"createdAt\", \"desc\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.limit)(50));\n        return (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.onSnapshot)(q, (snapshot)=>{\n            const notifications = snapshot.docs.map((d)=>({\n                    id: d.id,\n                    ...d.data(),\n                    createdAt: asDate(d.data().createdAt)\n                }));\n            callback(notifications);\n        });\n    } catch (error) {\n        console.error(\"Error setting up notifications listener:\", error);\n        return ()=>{};\n    }\n};\nconst getUserNotificationsOnce = async (userId)=>{\n    try {\n        const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"notifications\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"userId\", \"==\", userId), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.orderBy)(\"createdAt\", \"desc\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.limit)(50));\n        const querySnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n        const notifications = querySnapshot.docs.map((doc)=>({\n                id: doc.id,\n                ...doc.data(),\n                createdAt: asDate(doc.data().createdAt)\n            }));\n        return {\n            success: true,\n            data: notifications\n        };\n    } catch (error) {\n        console.error(\"Error getting notifications:\", error);\n        return {\n            success: false,\n            error: error.message,\n            data: []\n        };\n    }\n};\nconst getUnreadNotificationsCount = async (userId)=>{\n    try {\n        const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"notifications\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"userId\", \"==\", userId), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"isRead\", \"==\", false));\n        const querySnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n        return {\n            success: true,\n            count: querySnapshot.size\n        };\n    } catch (error) {\n        console.error(\"Error getting unread count:\", error);\n        return {\n            success: false,\n            error: error.message,\n            count: 0\n        };\n    }\n};\n// =======================================================================\n// ================================ REVIEWS ==============================\n// =======================================================================\nconst addReview = async (reviewData)=>{\n    try {\n        console.log(\"\\uD83D\\uDD0D [Firestore] addReview called with data:\", reviewData);\n        const validatedData = {\n            restaurantId: reviewData.restaurantId || \"\",\n            restaurantName: reviewData.restaurantName || \"Restoran\",\n            rating: Number(reviewData.rating) || 0,\n            comment: reviewData.comment || \"\",\n            userId: reviewData.userId || \"\",\n            userName: reviewData.userName || \"User\",\n            userEmail: reviewData.userEmail || \"\",\n            createdAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)(),\n            hasOwnerReply: false,\n            ownerReply: \"\",\n            ownerId: \"\",\n            ownerName: \"\",\n            repliedAt: null\n        };\n        console.log(\"\\uD83D\\uDD0D [Firestore] Validated data:\", validatedData);\n        if (!validatedData.restaurantId) {\n            throw new Error(\"Restaurant ID is required\");\n        }\n        if (!validatedData.userId) {\n            throw new Error(\"User ID is required\");\n        }\n        if (validatedData.rating === 0) {\n            throw new Error(\"Rating is required\");\n        }\n        const reviewRef = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.addDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"reviews\"), validatedData);\n        console.log(\"✅ [Firestore] Review berhasil dibuat dengan ID:\", reviewRef.id);\n        // Create owner notification for new review (best-effort)\n        try {\n            const restId = validatedData.restaurantId;\n            if (restId) {\n                const restSnap = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"restaurants\", restId));\n                const restaurant = restSnap.exists() ? restSnap.data() : null;\n                const ownerId = restaurant?.ownerId;\n                if (ownerId) {\n                    await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.addDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"notifications\"), {\n                        ownerId,\n                        type: \"new_review\",\n                        title: \"Ulasan Baru\",\n                        message: `${validatedData.userName || \"User\"} memberi rating ${validatedData.rating}/5`,\n                        restaurantId: restId,\n                        restaurantName: restaurant?.name || validatedData.restaurantName,\n                        reviewId: reviewRef.id,\n                        rating: validatedData.rating,\n                        isRead: false,\n                        createdAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)(),\n                        updatedAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n                    });\n                }\n            }\n        } catch (notifyErr) {\n            console.error(\"❌ [Firestore] Error creating review notification:\", notifyErr);\n        }\n        // Recalculate restaurant rating so listing cards reflect new review\n        try {\n            await updateRestaurantRating(validatedData.restaurantId);\n        } catch (e) {\n            console.warn(\"Failed to update restaurant rating after addReview:\", e?.message || e);\n        }\n        return {\n            success: true,\n            id: reviewRef.id\n        };\n    } catch (error) {\n        console.error(\"❌ [Firestore] Error in addReview:\", error);\n        return {\n            success: false,\n            error: error.message\n        };\n    }\n};\nconst getRestaurantReviews = async (restaurantId)=>{\n    try {\n        console.log(\"\\uD83D\\uDD0D [Firestore] getRestaurantReviews - Fetching reviews for restaurant:\", restaurantId);\n        const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"reviews\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"restaurantId\", \"==\", restaurantId), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.orderBy)(\"createdAt\", \"desc\"));\n        const querySnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n        console.log(\"\\uD83D\\uDD0D [Firestore] getRestaurantReviews - Raw reviews found:\", querySnapshot.size);\n        const reviews = [];\n        querySnapshot.forEach((doc)=>{\n            const reviewData = doc.data();\n            const review = {\n                id: doc.id,\n                ...reviewData,\n                ownerReply: reviewData.ownerReply || null,\n                repliedAt: reviewData.repliedAt || null,\n                ownerName: reviewData.ownerName || null,\n                createdAt: asDate(reviewData.createdAt)\n            };\n            reviews.push(review);\n        });\n        console.log(\"✅ [Firestore] getRestaurantReviews - Final reviews:\", reviews.length);\n        return {\n            success: true,\n            data: reviews\n        };\n    } catch (error) {\n        console.error(\"❌ [Firestore] getRestaurantReviews - Error:\", error);\n        return {\n            success: false,\n            error: error.message\n        };\n    }\n};\nconst updateReviewReply = async (reviewId, replyData)=>{\n    try {\n        console.log(\"\\uD83D\\uDD0D [Firestore] updateReviewReply - Updating reply for review:\", reviewId);\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"reviews\", reviewId), {\n            ownerReply: replyData.reply,\n            ownerId: replyData.ownerId,\n            ownerName: replyData.ownerName,\n            repliedAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)(),\n            hasOwnerReply: true\n        });\n        console.log(\"✅ [Firestore] updateReviewReply - Reply updated successfully\");\n        return {\n            success: true\n        };\n    } catch (error) {\n        console.error(\"❌ [Firestore] updateReviewReply - Error:\", error);\n        return {\n            success: false,\n            error: error.message\n        };\n    }\n};\nconst getOwnerRestaurants = async (ownerId)=>{\n    try {\n        const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"restaurants\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"ownerId\", \"==\", ownerId));\n        const snap = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n        return {\n            success: true,\n            data: snap.docs.map((doc)=>({\n                    id: doc.id,\n                    ...doc.data()\n                }))\n        };\n    } catch (err) {\n        return {\n            success: false,\n            error: err.message\n        };\n    }\n};\nconst getOwnerReviews = async (ownerId)=>{\n    try {\n        console.log(\"\\uD83D\\uDD0D [Firestore] getOwnerReviews - Starting for owner:\", ownerId);\n        if (!ownerId) {\n            console.error(\"❌ [Firestore] Owner ID is required\");\n            return {\n                success: false,\n                error: \"Owner ID is required\"\n            };\n        }\n        const restaurantsQuery = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"restaurants\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"ownerId\", \"==\", ownerId));\n        const restaurantsSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(restaurantsQuery);\n        console.log(\"\\uD83D\\uDD0D [Firestore] getOwnerReviews - Restaurants found:\", restaurantsSnapshot.size);\n        if (restaurantsSnapshot.empty) {\n            console.log(\"⚠️ [Firestore] No restaurants found for this owner\");\n            return {\n                success: true,\n                data: []\n            };\n        }\n        const restaurantIds = [];\n        const restaurantMap = {};\n        restaurantsSnapshot.forEach((doc)=>{\n            restaurantIds.push(doc.id);\n            restaurantMap[doc.id] = doc.data().name;\n            console.log(`🏪 [Firestore] Restaurant: ${doc.id} - ${doc.data().name}`);\n        });\n        console.log(\"\\uD83D\\uDD0D [Firestore] Restaurant IDs to search:\", restaurantIds);\n        const reviewsQuery = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"reviews\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.orderBy)(\"createdAt\", \"desc\"));\n        const reviewsSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(reviewsQuery);\n        console.log(\"\\uD83D\\uDD0D [Firestore] Total reviews in database:\", reviewsSnapshot.size);\n        const reviews = [];\n        reviewsSnapshot.forEach((doc)=>{\n            const reviewData = doc.data();\n            if (restaurantIds.includes(reviewData.restaurantId)) {\n                const review = {\n                    id: doc.id,\n                    ...reviewData,\n                    restaurantName: restaurantMap[reviewData.restaurantId] || reviewData.restaurantName,\n                    createdAt: asDate(reviewData.createdAt),\n                    repliedAt: asDate(reviewData.repliedAt)\n                };\n                console.log(\"✅ [Firestore] Review belongs to owner:\", review);\n                reviews.push(review);\n            }\n        });\n        console.log(\"✅ [Firestore] getOwnerReviews - Final reviews found:\", reviews.length);\n        return {\n            success: true,\n            data: reviews\n        };\n    } catch (error) {\n        console.error(\"❌ [Firestore] getOwnerReviews - Error:\", error);\n        return {\n            success: false,\n            error: error.message\n        };\n    }\n};\nconst getUserReviews = async (userId)=>{\n    try {\n        console.log(\"\\uD83D\\uDD0D [Firestore] getUserReviews - Starting for user:\", userId);\n        if (!userId) {\n            console.error(\"❌ [Firestore] User ID is required\");\n            return {\n                success: false,\n                error: \"User ID is required\"\n            };\n        }\n        const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"reviews\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"userId\", \"==\", userId), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.orderBy)(\"createdAt\", \"desc\"));\n        const querySnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n        console.log(\"\\uD83D\\uDD0D [Firestore] getUserReviews - Raw reviews found:\", querySnapshot.size);\n        const reviews = [];\n        querySnapshot.forEach((doc)=>{\n            const reviewData = doc.data();\n            const review = {\n                id: doc.id,\n                ...reviewData,\n                ownerReply: reviewData.ownerReply || null,\n                repliedAt: reviewData.repliedAt || null,\n                createdAt: asDate(reviewData.createdAt)\n            };\n            reviews.push(review);\n        });\n        console.log(\"✅ [Firestore] getUserReviews - Final reviews count:\", reviews.length);\n        return {\n            success: true,\n            data: reviews\n        };\n    } catch (error) {\n        console.error(\"❌ [Firestore] getUserReviews - Error:\", error);\n        return {\n            success: false,\n            error: error.message\n        };\n    }\n};\nconst updateRestaurantRating = async (restaurantId)=>{\n    try {\n        console.log(`🔍 [Rating] START: Updating rating for restaurant: ${restaurantId}`);\n        const restaurantRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"restaurants\", restaurantId);\n        const restaurantSnap = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(restaurantRef);\n        const restaurantName = restaurantSnap.exists() ? restaurantSnap.data().name : \"Unknown\";\n        console.log(`📋 [Rating] Restaurant: ${restaurantName} (${restaurantId})`);\n        const reviewsRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"reviews\");\n        const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(reviewsRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"restaurantId\", \"==\", restaurantId));\n        const querySnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n        console.log(`📊 [Rating] Found ${querySnapshot.size} total review documents`);\n        if (querySnapshot.empty) {\n            console.log(`❌ [Rating] No reviews found, setting to 0`);\n            await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(restaurantRef, {\n                rating: 0,\n                reviewCount: 0,\n                lastRatingUpdate: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n            });\n            return {\n                success: true,\n                rating: 0,\n                count: 0\n            };\n        }\n        let totalRating = 0;\n        let reviewCount = 0;\n        querySnapshot.forEach((doc)=>{\n            const review = doc.data();\n            if (review.rating && review.rating > 0) {\n                totalRating += review.rating;\n                reviewCount++;\n            }\n        });\n        const averageRating = reviewCount > 0 ? totalRating / reviewCount : 0;\n        console.log(`🧮 [Rating] Calculation:`);\n        console.log(`   - Valid reviews: ${reviewCount}/${querySnapshot.size}`);\n        console.log(`   - Total rating: ${totalRating}`);\n        console.log(`   - Average: ${averageRating.toFixed(1)}`);\n        console.log(`💾 [Rating] Updating restaurant document...`);\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(restaurantRef, {\n            rating: Number(averageRating.toFixed(1)),\n            reviewCount: reviewCount,\n            lastRatingUpdate: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n        });\n        console.log(`✅ [Rating] SUCCESS: Updated ${restaurantName} to rating ${averageRating.toFixed(1)} (${reviewCount} reviews)`);\n        return {\n            success: true,\n            rating: averageRating,\n            reviewCount: reviewCount\n        };\n    } catch (error) {\n        console.error(\"❌ [Rating] ERROR:\", error);\n        return {\n            success: false,\n            error: error.message\n        };\n    }\n};\nconst updateUserRole = async (userId, newRole)=>{\n    try {\n        const userRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"users\", userId);\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(userRef, {\n            role: newRole,\n            updatedAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n        });\n        console.log(`User ${userId} role changed to ${newRole}`);\n        return true;\n    } catch (error) {\n        console.error(\"Error updating user role:\", error);\n        throw error;\n    }\n};\n// Fungsi untuk mendapatkan semua reports\n// (Removed duplicate getReports; see consolidated version below that includes reviewId filter and timestamp normalization)\n// Fungsi untuk menangguhkan akun user\nconst suspendUserAccount = async (userId, reason)=>{\n    try {\n        const userRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"users\", userId);\n        // Update status user\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(userRef, {\n            status: \"suspended\",\n            suspensionReason: reason,\n            suspendedAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n        });\n        // Log the suspension\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.addDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"suspension_logs\"), {\n            userId,\n            reason,\n            actionBy: \"admin\",\n            actionType: \"suspend\",\n            createdAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n        });\n        return {\n            success: true\n        };\n    } catch (error) {\n        console.error(\"Error suspending user:\", error);\n        return {\n            success: false,\n            error: error.message\n        };\n    }\n};\n// Fungsi untuk menangguhkan restoran\nconst suspendRestaurantAccount = async (restaurantId, reason)=>{\n    try {\n        const restaurantRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"restaurants\", restaurantId);\n        // Update status restoran\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(restaurantRef, {\n            status: \"suspended\",\n            suspensionReason: reason,\n            suspendedAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n        });\n        // Log the suspension\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.addDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"suspension_logs\"), {\n            restaurantId,\n            reason,\n            actionBy: \"admin\",\n            actionType: \"suspend\",\n            createdAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n        });\n        return {\n            success: true\n        };\n    } catch (error) {\n        console.error(\"Error suspending restaurant:\", error);\n        return {\n            success: false,\n            error: error.message\n        };\n    }\n};\n// =======================================================================\n// ======================== REAL-TIME RESERVATIONS =======================\n// =======================================================================\nconst subscribeToRestaurantReservations = (restaurantId, callback)=>{\n    try {\n        const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"reservations\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"restaurantId\", \"==\", restaurantId), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.orderBy)(\"createdAt\", \"desc\"));\n        return (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.onSnapshot)(q, (querySnapshot)=>{\n            const reservations = [];\n            querySnapshot.forEach((doc)=>{\n                reservations.push({\n                    id: doc.id,\n                    ...doc.data(),\n                    createdAt: asDate(doc.data().createdAt),\n                    date: asDate(doc.data().date)\n                });\n            });\n            callback(reservations);\n        });\n    } catch (error) {\n        console.error(\"❌ [Firestore] Error in subscribeToRestaurantReservations:\", error);\n        throw error;\n    }\n};\n// =======================================================================\n// =============================== MENU =================================\n// =======================================================================\nconst createMenu = async (menuData)=>{\n    try {\n        const docRef = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.addDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"menus\"), {\n            ...menuData,\n            createdAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)(),\n            updatedAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n        });\n        return docRef.id;\n    } catch (error) {\n        console.error(\"❌ [Firestore] Error creating menu:\", error);\n        throw error;\n    }\n};\nconst getMenusByRestaurant = async (restaurantId)=>{\n    try {\n        const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"menus\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"restaurantId\", \"==\", restaurantId), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.orderBy)(\"createdAt\", \"desc\"));\n        const querySnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n        const menus = [];\n        querySnapshot.forEach((doc)=>{\n            menus.push({\n                id: doc.id,\n                ...doc.data(),\n                createdAt: asDate(doc.data().createdAt)\n            });\n        });\n        return menus;\n    } catch (error) {\n        console.error(\"❌ [Firestore] Error getting menus:\", error);\n        throw error;\n    }\n};\nconst updateMenu = async (menuId, menuData)=>{\n    try {\n        const menuRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"menus\", menuId);\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(menuRef, {\n            ...menuData,\n            updatedAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n        });\n    } catch (error) {\n        console.error(\"❌ [Firestore] Error updating menu:\", error);\n        throw error;\n    }\n};\nconst deleteMenu = async (menuId)=>{\n    try {\n        const menuRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"menus\", menuId);\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.deleteDoc)(menuRef);\n    } catch (error) {\n        console.error(\"❌ [Firestore] Error deleting menu:\", error);\n        throw error;\n    }\n};\nconst getMenuById = async (menuId)=>{\n    try {\n        const menuRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"menus\", menuId);\n        const menuSnap = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(menuRef);\n        if (menuSnap.exists()) {\n            return {\n                id: menuSnap.id,\n                ...menuSnap.data()\n            };\n        } else {\n            throw new Error(\"Menu tidak ditemukan\");\n        }\n    } catch (error) {\n        console.error(\"❌ [Firestore] Error getting menu:\", error);\n        throw error;\n    }\n};\n// =======================================================================\n// =============================== PROMOS ================================\n// =======================================================================\nconst getPromosByRestaurantId = async (restaurantId)=>{\n    try {\n        const promosRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"promos\");\n        const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(promosRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"restaurantId\", \"==\", restaurantId), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.orderBy)(\"createdAt\", \"desc\"));\n        const querySnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n        const promos = [];\n        querySnapshot.forEach((doc)=>{\n            promos.push({\n                id: doc.id,\n                ...doc.data(),\n                createdAt: asDate(doc.data().createdAt),\n                startDate: asDate(doc.data().startDate),\n                endDate: asDate(doc.data().endDate)\n            });\n        });\n        return promos;\n    } catch (error) {\n        console.error(\"❌ [Firestore] Error getting promos:\", error);\n        throw error;\n    }\n};\nconst updatePromo = async (promoId, promoData)=>{\n    try {\n        const promoRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"promos\", promoId);\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(promoRef, {\n            ...promoData,\n            updatedAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n        });\n    } catch (error) {\n        console.error(\"❌ [Firestore] Error updating promo:\", error);\n        throw error;\n    }\n};\nconst deletePromo = async (promoId)=>{\n    try {\n        const promoRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"promos\", promoId);\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.deleteDoc)(promoRef);\n    } catch (error) {\n        console.error(\"❌ [Firestore] Error deleting promo:\", error);\n        throw error;\n    }\n};\nconst getPromoById = async (promoId)=>{\n    try {\n        const promoRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"promos\", promoId);\n        const promoSnap = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(promoRef);\n        if (promoSnap.exists()) {\n            return {\n                id: promoSnap.id,\n                ...promoSnap.data()\n            };\n        } else {\n            throw new Error(\"Promo tidak ditemukan\");\n        }\n    } catch (error) {\n        console.error(\"❌ [Firestore] Error getting promo:\", error);\n        throw error;\n    }\n};\n// =======================================================================\n// ============================ RESTAURANT STATUS ========================\n// =======================================================================\nconst updateRestaurantOpenStatus = async (restaurantId, isOpen)=>{\n    try {\n        const restaurantRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"restaurants\", restaurantId);\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(restaurantRef, {\n            isOpen,\n            updatedAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n        });\n    } catch (error) {\n        console.error(\"❌ [Firestore] Error updating restaurant status:\", error);\n        throw error;\n    }\n};\n// =======================================================================\n// ============================ DASHBOARD STATS ==========================\n// =======================================================================\nconst getDashboardStats = async (ownerId)=>{\n    try {\n        const restaurants = await getRestaurantsByOwner(ownerId);\n        let totalPendingReservations = 0;\n        let totalTodayReservations = 0;\n        for (const restaurant of restaurants){\n            const reservations = await getRestaurantReservations(restaurant.id);\n            totalPendingReservations += reservations.filter((r)=>r.status === \"pending\").length;\n            const today = new Date().toDateString();\n            totalTodayReservations += reservations.filter((r)=>{\n                const reservationDate = new Date(r.date).toDateString();\n                return reservationDate === today;\n            }).length;\n        }\n        return {\n            totalRestaurants: restaurants.length,\n            totalPendingReservations,\n            totalTodayReservations\n        };\n    } catch (error) {\n        console.error(\"❌ [Firestore] Error getting dashboard stats:\", error);\n        throw error;\n    }\n};\nconst getRestaurantReviewsSummary = async (restaurantId)=>{\n    try {\n        const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"reviews\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"restaurantId\", \"==\", restaurantId));\n        const querySnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n        if (querySnapshot.empty) {\n            return {\n                averageRating: 0,\n                reviewCount: 0,\n                totalRating: 0\n            };\n        }\n        let totalRating = 0;\n        const reviews = [];\n        querySnapshot.forEach((doc)=>{\n            const reviewData = doc.data();\n            reviews.push({\n                id: doc.id,\n                ...reviewData\n            });\n            totalRating += reviewData.rating || 0;\n        });\n        const reviewCount = reviews.length;\n        const averageRating = reviewCount > 0 ? totalRating / reviewCount : 0;\n        return {\n            averageRating,\n            reviewCount,\n            totalRating,\n            reviews\n        };\n    } catch (error) {\n        console.error(\"Error getting restaurant reviews summary:\", error);\n        throw error;\n    }\n};\nconst syncRestaurantRating = async (restaurantId)=>{\n    try {\n        const reviewsRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"reviews\");\n        const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(reviewsRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"restaurantId\", \"==\", restaurantId));\n        const querySnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n        const reviewCount = querySnapshot.size;\n        let totalRating = 0;\n        querySnapshot.forEach((doc)=>{\n            const review = doc.data();\n            if (review.rating && review.rating > 0) {\n                totalRating += review.rating;\n            }\n        });\n        const averageRating = reviewCount > 0 ? totalRating / reviewCount : 0;\n        const restaurantRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"restaurants\", restaurantId);\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(restaurantRef, {\n            rating: Number(averageRating.toFixed(1)),\n            reviewCount: reviewCount,\n            lastRatingUpdate: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n        });\n        console.log(`✅ Synced rating for ${restaurantId}: ${averageRating.toFixed(1)} (${reviewCount} reviews)`);\n        return {\n            success: true,\n            rating: averageRating,\n            reviewCount: reviewCount\n        };\n    } catch (error) {\n        console.error(\"❌ Error syncing rating:\", error);\n        return {\n            success: false,\n            error: error.message\n        };\n    }\n};\n// =======================================================================\n// =========================== REPORT REVIEW =============================\n// =======================================================================\nconst reportReview = async (reportData)=>{\n    try {\n        const reportRef = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.addDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"reviewReports\"), {\n            ...reportData,\n            createdAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)(),\n            updatedAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n        });\n        // Update review dengan status report\n        const reviewRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"reviews\", reportData.reviewId);\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(reviewRef, {\n            reportStatus: \"pending\",\n            reportedAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)(),\n            updatedAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n        });\n        // Notify admin (system notification)\n        try {\n            const title = \"Laporan Ulasan Baru\";\n            const restaurant = reportData.restaurantName || reportData.restaurantId || \"Restoran\";\n            const reason = reportData.reason || reportData.category || \"Alasan tidak tersedia\";\n            const message = `Ulasan dilaporkan pada ${restaurant}. Alasan: ${reason}.`;\n            await createSystemNotification(title, message, \"review_report\", reportRef.id);\n        } catch (e) {\n            console.warn(\"Failed to create admin notification for review report:\", e?.message || e);\n        }\n        return {\n            success: true,\n            reportId: reportRef.id\n        };\n    } catch (error) {\n        console.error(\"Error reporting review:\", error);\n        return {\n            success: false,\n            error: error.message\n        };\n    }\n};\nconst getReviewReports = async (status = \"pending\")=>{\n    try {\n        let q;\n        if (status === \"all\") {\n            q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"reviewReports\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.orderBy)(\"createdAt\", \"desc\"));\n        } else {\n            q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"reviewReports\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"reportStatus\", \"==\", status), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.orderBy)(\"createdAt\", \"desc\"));\n        }\n        const snapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n        const reports = snapshot.docs.map((doc)=>({\n                id: doc.id,\n                ...doc.data()\n            }));\n        return {\n            success: true,\n            data: reports\n        };\n    } catch (error) {\n        console.error(\"Error getting review reports:\", error);\n        return {\n            success: false,\n            error: error.message\n        };\n    }\n};\nconst updateReportStatus = async (reportId, status, adminNotes = \"\")=>{\n    try {\n        const reportRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"reviewReports\", reportId);\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(reportRef, {\n            reportStatus: status,\n            adminNotes,\n            updatedAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)(),\n            resolvedAt: status !== \"pending\" ? (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)() : null\n        });\n        if (status === \"approved\") {\n            const reportDoc = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(reportRef);\n            const reportData = reportDoc.data();\n            const reviewRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"reviews\", reportData.reviewId);\n            await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.updateDoc)(reviewRef, {\n                reportStatus: \"approved\",\n                updatedAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n            });\n        }\n        return {\n            success: true\n        };\n    } catch (error) {\n        console.error(\"Error updating report status:\", error);\n        return {\n            success: false,\n            error: error.message\n        };\n    }\n};\nconst createReservationNotification = async (ownerId, reservationData)=>{\n    try {\n        console.log(\"\\uD83D\\uDCDD Membuat notifikasi untuk owner:\", ownerId);\n        console.log(\"\\uD83D\\uDCCA Data reservasi:\", reservationData);\n        if (!ownerId) {\n            console.error(\"❌ Owner ID tidak ditemukan\");\n            return {\n                success: false,\n                error: \"Owner ID tidak ditemukan\"\n            };\n        }\n        const notificationData = {\n            ownerId: ownerId,\n            type: \"new_reservation\",\n            title: \"\\uD83C\\uDF89 Reservasi Baru!\",\n            message: `${reservationData.customerName} membuat reservasi untuk ${reservationData.guestCount} orang`,\n            restaurantName: reservationData.restaurantName,\n            customerName: reservationData.customerName,\n            guestCount: reservationData.guestCount,\n            reservationId: reservationData.id,\n            restaurantId: reservationData.restaurantId,\n            isRead: false,\n            createdAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)(),\n            date: reservationData.date,\n            time: reservationData.time,\n            phone: reservationData.phone,\n            totalPrice: reservationData.totalPrice,\n            downPayment: reservationData.downPayment\n        };\n        console.log(\"\\uD83D\\uDCC4 Data notifikasi yang akan disimpan:\", notificationData);\n        const docRef = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.addDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"notifications\"), notificationData);\n        console.log(\"✅ Notifikasi berhasil dibuat dengan ID:\", docRef.id);\n        return {\n            success: true,\n            id: docRef.id,\n            message: \"Notifikasi berhasil dibuat\"\n        };\n    } catch (error) {\n        console.error(\"❌ Error creating notification:\", error);\n        return {\n            success: false,\n            error: error.message,\n            stack: error.stack\n        };\n    }\n};\nconst getReports = async ()=>{\n    try {\n        const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"reports\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"reviewId\", \"!=\", null), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.orderBy)(\"createdAt\", \"desc\"));\n        const querySnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n        const reports = querySnapshot.docs.map((doc)=>({\n                id: doc.id,\n                ...doc.data()\n            }));\n        // Convert timestamps\n        return reports.map((report)=>({\n                ...report,\n                createdAt: report.createdAt?.toDate ? report.createdAt.toDate() : report.createdAt,\n                updatedAt: report.updatedAt?.toDate ? report.updatedAt.toDate() : report.updatedAt\n            }));\n    } catch (error) {\n        console.error(\"Error getting reports:\", error);\n        return [];\n    }\n};\n// Get user by ID\nconst getUserById = async (userId)=>{\n    try {\n        const userDoc = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"users\", userId));\n        if (userDoc.exists()) {\n            return {\n                id: userDoc.id,\n                ...userDoc.data()\n            };\n        }\n        return null;\n    } catch (error) {\n        console.error(\"Error getting user:\", error);\n        return null;\n    }\n};\n// Get review by ID\nconst getReviewById = async (reviewId)=>{\n    try {\n        const reviewDoc = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"reviews\", reviewId));\n        if (reviewDoc.exists()) {\n            const data = reviewDoc.data();\n            return {\n                id: reviewDoc.id,\n                ...data,\n                createdAt: data.createdAt?.toDate ? data.createdAt.toDate() : data.createdAt\n            };\n        }\n        return null;\n    } catch (error) {\n        console.error(\"Error getting review:\", error);\n        return null;\n    }\n};\n// Delete review\nconst deleteReview = async (reviewId)=>{\n    try {\n        // Fetch review to get restaurantId before deletion\n        const reviewRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"reviews\", reviewId);\n        const snap = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(reviewRef);\n        const restaurantId = snap.exists() ? snap.data().restaurantId : null;\n        // Delete review\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.deleteDoc)(reviewRef);\n        // Log deletion\n        await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.addDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"review_deletions\"), {\n            reviewId,\n            restaurantId: restaurantId || null,\n            deletedAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)(),\n            deletedBy: \"admin\",\n            reason: \"Report approved\"\n        });\n        // Recalculate restaurant rating so listing cards stay in sync\n        if (restaurantId) {\n            try {\n                await updateRestaurantRating(restaurantId);\n            } catch (e) {\n                console.warn(\"Failed to update restaurant rating after deletion:\", e?.message || e);\n            }\n        }\n        return {\n            success: true\n        };\n    } catch (error) {\n        console.error(\"Error deleting review:\", error);\n        return {\n            success: false,\n            error: error.message\n        };\n    }\n};\n// Count user approved reports\nconst countUserApprovedReports = async (userId)=>{\n    try {\n        const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"reports\"), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"userId\", \"==\", userId), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"status\", \"==\", \"approved\"));\n        const querySnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n        return querySnapshot.size;\n    } catch (error) {\n        console.error(\"Error counting user reports:\", error);\n        return 0;\n    }\n};\n// Export semua fungsi\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({\n    // Promo Functions\n    addPromo,\n    addPromoAndUpdateRestaurant,\n    getActivePromosForRestaurant,\n    getActivePromosForMenu,\n    getPromosByRestaurantId,\n    updatePromo,\n    deletePromo,\n    getPromoById,\n    // Menu & Restaurant Functions\n    getMenusByRestaurantId,\n    getRestaurantById,\n    getRestaurantsByOwner,\n    createRestaurant,\n    getAllRestaurants,\n    updateRestaurantStatus,\n    updateRestaurant,\n    updateRestaurantOpenStatus,\n    // Notification Functions\n    getSystemNotifications,\n    createSystemNotification,\n    getOwnerNotifications,\n    getUserNotifications,\n    getUserNotificationsOnce,\n    markNotificationAsRead,\n    markAllNotificationsAsRead,\n    createNotification,\n    deleteNotification,\n    deleteAllOwnerNotifications,\n    // Review Functions\n    addReview,\n    getRestaurantReviews,\n    getOwnerReviews,\n    getUserReviews,\n    updateReviewReply,\n    updateRestaurantRating,\n    reportReview,\n    getReviewReports,\n    updateReportStatus,\n    // Reservation Functions\n    getRestaurantReservations,\n    createReservation,\n    subscribeToRestaurantReservations,\n    // Favorite Functions\n    isRestaurantFavorite,\n    addToFavorites,\n    removeFromFavorites,\n    getUserFavorites,\n    toggleFavorite,\n    // Other Functions\n    getDashboardStats,\n    updateUser,\n    getAllUsers,\n    updateUserRole\n});\nconst createUserReservationNotification = async (userId, reservationData)=>{\n    try {\n        if (!userId) return {\n            success: false,\n            error: \"User ID tidak ditemukan\"\n        };\n        const notificationData = {\n            userId,\n            type: \"reservation_confirmed\",\n            title: \"Reservasi Disetujui\",\n            message: `Reservasi Anda di ${reservationData.restaurantName} untuk ${reservationData.guestCount} orang telah dikonfirmasi`,\n            reservationId: reservationData.id,\n            restaurantId: reservationData.restaurantId,\n            restaurantName: reservationData.restaurantName,\n            date: reservationData.date,\n            time: reservationData.time,\n            totalPrice: reservationData.totalPrice,\n            downPayment: reservationData.downPayment,\n            isRead: false,\n            createdAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)(),\n            updatedAt: (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.serverTimestamp)()\n        };\n        const docRef = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.addDoc)((0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_firebase__WEBPACK_IMPORTED_MODULE_1__.db, \"notifications\"), notificationData);\n        return {\n            success: true,\n            id: docRef.id\n        };\n    } catch (error) {\n        console.error(\"❌ Error creating user reservation notification:\", error);\n        return {\n            success: false,\n            error: error.message\n        };\n    }\n};\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QzFCeUMsTUFBTUwsZ0JBQWdCSyxJQUFJO1lBQzFCaUcsWUFBWXRHLGdCQUFnQnNHLFVBQVU7WUFDdENDLGFBQWF2RyxnQkFBZ0J1RyxXQUFXO1lBQ3hDakgsUUFBUTtZQUNSaEssV0FBV3JCLG1FQUFlQTtZQUMxQmtGLFdBQVdsRixtRUFBZUE7UUFDNUI7UUFDQSxNQUFNbUgsU0FBUyxNQUFNdEgsMERBQU1BLENBQUNYLDhEQUFVQSxDQUFDZSx5Q0FBRUEsRUFBRSxrQkFBa0JrTDtRQUM3RCxPQUFPO1lBQUU5SSxTQUFTO1lBQU1zQixJQUFJd0QsT0FBT3hELEVBQUU7UUFBQztJQUN4QyxFQUFFLE9BQU9uQixPQUFPO1FBQ2RELFFBQVFDLEtBQUssQ0FBQyxtREFBbURBO1FBQ2pFLE9BQU87WUFBRUgsU0FBUztZQUFPRyxPQUFPQSxNQUFNQyxPQUFPO1FBQUM7SUFDaEQ7QUFDRixFQUFFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbnlhbS1tYWthbi8uL2xpYi9maXJlc3RvcmUuanM/MDYwYSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBGSVJFU1RPUkUgSU1QT1JUU1xyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5pbXBvcnQge1xyXG4gIGNvbGxlY3Rpb24sIGRvYywgZ2V0RG9jLCBnZXREb2NzLCBzZXREb2MsIHVwZGF0ZURvYywgZGVsZXRlRG9jLFxyXG4gIHF1ZXJ5LCB3aGVyZSwgb3JkZXJCeSwgbGltaXQsIGFkZERvYywgb25TbmFwc2hvdCwgd3JpdGVCYXRjaCxcclxuICBzZXJ2ZXJUaW1lc3RhbXBcclxufSBmcm9tIFwiZmlyZWJhc2UvZmlyZXN0b3JlXCI7XHJcbmltcG9ydCB7IGRiIH0gZnJvbSBcIi4vZmlyZWJhc2VcIjtcclxuXHJcbi8vIEhlbHBlclxyXG5jb25zdCBhc0RhdGUgPSAodikgPT4gdj8udG9EYXRlPy4oKSB8fCB2O1xyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gQURNSU4gSEVMUEVSUyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vLyBHZXQgdXNlcnMgd2l0aCBhcHByb3ZlZCByZXBvcnRzIGFnZ3JlZ2F0ZWQgYnkgdXNlcklkXHJcbmV4cG9ydCBjb25zdCBnZXRVc2Vyc1dpdGhBcHByb3ZlZFJlcG9ydHMgPSBhc3luYyAobWluQ291bnQgPSAxKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHEgPSBxdWVyeShcclxuICAgICAgY29sbGVjdGlvbihkYiwgJ3JlcG9ydHMnKSxcclxuICAgICAgd2hlcmUoJ3N0YXR1cycsICc9PScsICdhcHByb3ZlZCcpXHJcbiAgICApO1xyXG4gICAgY29uc3Qgc25hcCA9IGF3YWl0IGdldERvY3MocSk7XHJcblxyXG4gICAgY29uc3QgY291bnRzID0gbmV3IE1hcCgpO1xyXG4gICAgY29uc3QgbGFzdENyZWF0ZWRBdCA9IG5ldyBNYXAoKTtcclxuICAgIGNvbnN0IGJ5VXNlciA9IG5ldyBNYXAoKTtcclxuXHJcbiAgICBzbmFwLmZvckVhY2goKGQpID0+IHtcclxuICAgICAgY29uc3QgZGF0YSA9IGQuZGF0YSgpO1xyXG4gICAgICBjb25zdCB1aWQgPSBkYXRhLnVzZXJJZDtcclxuICAgICAgaWYgKCF1aWQpIHJldHVybjtcclxuICAgICAgY291bnRzLnNldCh1aWQsIChjb3VudHMuZ2V0KHVpZCkgfHwgMCkgKyAxKTtcclxuICAgICAgY29uc3QgY3JlYXRlZCA9IGFzRGF0ZShkYXRhLmNyZWF0ZWRBdCk7XHJcbiAgICAgIGNvbnN0IHByZXYgPSBsYXN0Q3JlYXRlZEF0LmdldCh1aWQpO1xyXG4gICAgICBpZiAoIXByZXYgfHwgKGNyZWF0ZWQgJiYgY3JlYXRlZCA+IHByZXYpKSBsYXN0Q3JlYXRlZEF0LnNldCh1aWQsIGNyZWF0ZWQpO1xyXG4gICAgICBieVVzZXIuc2V0KHVpZCwgdHJ1ZSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zdCByZXN1bHRzID0gW107XHJcbiAgICBmb3IgKGNvbnN0IHVpZCBvZiBieVVzZXIua2V5cygpKSB7XHJcbiAgICAgIGNvbnN0IGNvdW50ID0gY291bnRzLmdldCh1aWQpIHx8IDA7XHJcbiAgICAgIGlmIChjb3VudCA+PSBtaW5Db3VudCkge1xyXG4gICAgICAgIC8vIGZldGNoIHVzZXIgbWluaW1hbCBwcm9maWxlXHJcbiAgICAgICAgY29uc3QgdXNlclNuYXAgPSBhd2FpdCBnZXREb2MoZG9jKGRiLCAndXNlcnMnLCB1aWQpKTtcclxuICAgICAgICBjb25zdCB1c2VyID0gdXNlclNuYXAuZXhpc3RzKCkgPyB1c2VyU25hcC5kYXRhKCkgOiB7fTtcclxuICAgICAgICByZXN1bHRzLnB1c2goe1xyXG4gICAgICAgICAgdXNlcklkOiB1aWQsXHJcbiAgICAgICAgICBjb3VudCxcclxuICAgICAgICAgIGxhc3RSZXBvcnRBdDogbGFzdENyZWF0ZWRBdC5nZXQodWlkKSB8fCBudWxsLFxyXG4gICAgICAgICAgZGlzcGxheU5hbWU6IHVzZXIuZGlzcGxheU5hbWUgfHwgdXNlci5uYW1lIHx8ICcnLFxyXG4gICAgICAgICAgZW1haWw6IHVzZXIuZW1haWwgfHwgJydcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIHNvcnQgYnkgY291bnQgZGVzY1xyXG4gICAgcmVzdWx0cy5zb3J0KChhLCBiKSA9PiBiLmNvdW50IC0gYS5jb3VudCk7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHRzIH07XHJcbiAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCfinYwgW0ZpcmVzdG9yZV0gZ2V0VXNlcnNXaXRoQXBwcm92ZWRSZXBvcnRzIGVycm9yOicsIGVycik7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVyci5tZXNzYWdlLCBkYXRhOiBbXSB9O1xyXG4gIH1cclxufTtcclxuXHJcbi8vIEdldCB1c2VycyB3aG8gcG9zdGVkIG5lZ2F0aXZlIHJldmlld3MgcmVwZWF0ZWRseSBmb3IgdGhlIHNhbWUgcmVzdGF1cmFudFxyXG5leHBvcnQgY29uc3QgZ2V0VXNlcnNXaXRoUmVwZWF0ZWROZWdhdGl2ZVJldmlld3MgPSBhc3luYyAodGhyZXNob2xkID0gMTApID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgcSA9IHF1ZXJ5KFxyXG4gICAgICBjb2xsZWN0aW9uKGRiLCAncmV2aWV3cycpLFxyXG4gICAgICB3aGVyZSgncmF0aW5nJywgJzw9JywgMilcclxuICAgICk7XHJcbiAgICBjb25zdCBzbmFwID0gYXdhaXQgZ2V0RG9jcyhxKTtcclxuXHJcbiAgICBjb25zdCBrZXlDb3VudHMgPSBuZXcgTWFwKCk7IC8vIGtleSA9IGAke3VzZXJJZH1fJHtyZXN0YXVyYW50SWR9YFxyXG4gICAgY29uc3QgbGFzdEF0ID0gbmV3IE1hcCgpO1xyXG5cclxuICAgIHNuYXAuZm9yRWFjaCgoZCkgPT4ge1xyXG4gICAgICBjb25zdCBkYXRhID0gZC5kYXRhKCk7XHJcbiAgICAgIGNvbnN0IHVpZCA9IGRhdGEudXNlcklkO1xyXG4gICAgICBjb25zdCByaWQgPSBkYXRhLnJlc3RhdXJhbnRJZDtcclxuICAgICAgaWYgKCF1aWQgfHwgIXJpZCkgcmV0dXJuO1xyXG4gICAgICBjb25zdCBrZXkgPSBgJHt1aWR9XyR7cmlkfWA7XHJcbiAgICAgIGtleUNvdW50cy5zZXQoa2V5LCAoa2V5Q291bnRzLmdldChrZXkpIHx8IDApICsgMSk7XHJcbiAgICAgIGNvbnN0IGNyZWF0ZWQgPSBhc0RhdGUoZGF0YS5jcmVhdGVkQXQpO1xyXG4gICAgICBjb25zdCBwcmV2ID0gbGFzdEF0LmdldChrZXkpO1xyXG4gICAgICBpZiAoIXByZXYgfHwgKGNyZWF0ZWQgJiYgY3JlYXRlZCA+IHByZXYpKSBsYXN0QXQuc2V0KGtleSwgY3JlYXRlZCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zdCByZXN1bHRzID0gW107XHJcbiAgICBmb3IgKGNvbnN0IFtrZXksIGNvdW50XSBvZiBrZXlDb3VudHMuZW50cmllcygpKSB7XHJcbiAgICAgIGlmIChjb3VudCA+PSB0aHJlc2hvbGQpIHtcclxuICAgICAgICBjb25zdCBbdXNlcklkLCByZXN0YXVyYW50SWRdID0ga2V5LnNwbGl0KCdfJyk7XHJcbiAgICAgICAgY29uc3QgdXNlclNuYXAgPSBhd2FpdCBnZXREb2MoZG9jKGRiLCAndXNlcnMnLCB1c2VySWQpKTtcclxuICAgICAgICBjb25zdCB1c2VyID0gdXNlclNuYXAuZXhpc3RzKCkgPyB1c2VyU25hcC5kYXRhKCkgOiB7fTtcclxuICAgICAgICBjb25zdCByZXN0U25hcCA9IGF3YWl0IGdldERvYyhkb2MoZGIsICdyZXN0YXVyYW50cycsIHJlc3RhdXJhbnRJZCkpO1xyXG4gICAgICAgIGNvbnN0IHJlc3RhdXJhbnQgPSByZXN0U25hcC5leGlzdHMoKSA/IHJlc3RTbmFwLmRhdGEoKSA6IHt9O1xyXG4gICAgICAgIHJlc3VsdHMucHVzaCh7XHJcbiAgICAgICAgICB1c2VySWQsXHJcbiAgICAgICAgICByZXN0YXVyYW50SWQsXHJcbiAgICAgICAgICBjb3VudCxcclxuICAgICAgICAgIGxhc3RBdDogbGFzdEF0LmdldChrZXkpIHx8IG51bGwsXHJcbiAgICAgICAgICB1c2VyTmFtZTogdXNlci5kaXNwbGF5TmFtZSB8fCB1c2VyLm5hbWUgfHwgJycsXHJcbiAgICAgICAgICB1c2VyRW1haWw6IHVzZXIuZW1haWwgfHwgJycsXHJcbiAgICAgICAgICByZXN0YXVyYW50TmFtZTogcmVzdGF1cmFudC5uYW1lIHx8ICcnXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBzb3J0IGJ5IGNvdW50IGRlc2NcclxuICAgIHJlc3VsdHMuc29ydCgoYSwgYikgPT4gYi5jb3VudCAtIGEuY291bnQpO1xyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmVzdWx0cyB9O1xyXG4gIH0gY2F0Y2ggKGVycikge1xyXG4gICAgY29uc29sZS5lcnJvcign4p2MIFtGaXJlc3RvcmVdIGdldFVzZXJzV2l0aFJlcGVhdGVkTmVnYXRpdmVSZXZpZXdzIGVycm9yOicsIGVycik7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVyci5tZXNzYWdlLCBkYXRhOiBbXSB9O1xyXG4gIH1cclxufTtcclxuXHJcbi8vIEdldCBsb3ctcmF0ZWQgcmVzdGF1cmFudHNcclxuZXhwb3J0IGNvbnN0IGdldExvd1JhdGVkUmVzdGF1cmFudHMgPSBhc3luYyAodGhyZXNob2xkID0gMikgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBxID0gcXVlcnkoXHJcbiAgICAgIGNvbGxlY3Rpb24oZGIsICdyZXN0YXVyYW50cycpLFxyXG4gICAgICB3aGVyZSgncmF0aW5nJywgJzwnLCB0aHJlc2hvbGQpXHJcbiAgICApO1xyXG4gICAgY29uc3Qgc25hcCA9IGF3YWl0IGdldERvY3MocSk7XHJcbiAgICBjb25zdCBkYXRhID0gc25hcC5kb2NzLm1hcCgoZCkgPT4gKHsgaWQ6IGQuaWQsIC4uLmQuZGF0YSgpIH0pKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGEgfTtcclxuICB9IGNhdGNoIChlcnIpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBbRmlyZXN0b3JlXSBnZXRMb3dSYXRlZFJlc3RhdXJhbnRzIGVycm9yOicsIGVycik7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVyci5tZXNzYWdlLCBkYXRhOiBbXSB9O1xyXG4gIH1cclxufTtcclxuXHJcbi8vIEdldCByZXBvcnRlZCB1c2VycyBmcm9tIHJldmlld1JlcG9ydHMgYnkgc3RhdHVzIChkZWZhdWx0OiBwZW5kaW5nKVxyXG5leHBvcnQgY29uc3QgZ2V0UmVwb3J0ZWRVc2Vyc0J5U3RhdHVzID0gYXN5bmMgKHN0YXR1cyA9ICdwZW5kaW5nJykgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBxID0gcXVlcnkoXHJcbiAgICAgIGNvbGxlY3Rpb24oZGIsICdyZXZpZXdSZXBvcnRzJyksXHJcbiAgICAgIHdoZXJlKCdyZXBvcnRTdGF0dXMnLCAnPT0nLCBzdGF0dXMpLFxyXG4gICAgICBvcmRlckJ5KCdjcmVhdGVkQXQnLCAnZGVzYycpXHJcbiAgICApO1xyXG4gICAgY29uc3Qgc25hcCA9IGF3YWl0IGdldERvY3MocSk7XHJcblxyXG4gICAgLy8gTWFwIHJldmlld0lkIC0+IHJlcG9ydCBjcmVhdGVkQXRcclxuICAgIGNvbnN0IHJldmlld0lkcyA9IG5ldyBTZXQoKTtcclxuICAgIGNvbnN0IGNyZWF0ZWRNYXAgPSBuZXcgTWFwKCk7XHJcbiAgICBzbmFwLmZvckVhY2goKGQpID0+IHtcclxuICAgICAgY29uc3QgZGF0YSA9IGQuZGF0YSgpO1xyXG4gICAgICBjb25zdCByZXZpZXdJZCA9IGRhdGEucmV2aWV3SWQ7XHJcbiAgICAgIGlmIChyZXZpZXdJZCkge1xyXG4gICAgICAgIHJldmlld0lkcy5hZGQocmV2aWV3SWQpO1xyXG4gICAgICAgIGNvbnN0IGNyZWF0ZWQgPSBhc0RhdGUoZGF0YS5jcmVhdGVkQXQpO1xyXG4gICAgICAgIGNvbnN0IHByZXYgPSBjcmVhdGVkTWFwLmdldChyZXZpZXdJZCk7XHJcbiAgICAgICAgaWYgKCFwcmV2IHx8IChjcmVhdGVkICYmIGNyZWF0ZWQgPiBwcmV2KSkgY3JlYXRlZE1hcC5zZXQocmV2aWV3SWQsIGNyZWF0ZWQpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBGZXRjaCByZWxhdGVkIHJldmlld3MgdG8gcmVzb2x2ZSB1c2VySWRcclxuICAgIGNvbnN0IHJldmlld0RvY3MgPSBhd2FpdCBQcm9taXNlLmFsbChcclxuICAgICAgQXJyYXkuZnJvbShyZXZpZXdJZHMpLm1hcCgocmlkKSA9PiBnZXREb2MoZG9jKGRiLCAncmV2aWV3cycsIHJpZCkpKVxyXG4gICAgKTtcclxuXHJcbiAgICBjb25zdCB1c2VyQ291bnRzID0gbmV3IE1hcCgpO1xyXG4gICAgY29uc3QgdXNlckxhc3QgPSBuZXcgTWFwKCk7XHJcbiAgICBjb25zdCB1c2VyU2V0ID0gbmV3IFNldCgpO1xyXG4gICAgcmV2aWV3RG9jcy5mb3JFYWNoKChzbmFwKSA9PiB7XHJcbiAgICAgIGlmICghc25hcC5leGlzdHMoKSkgcmV0dXJuO1xyXG4gICAgICBjb25zdCBkYXRhID0gc25hcC5kYXRhKCk7XHJcbiAgICAgIGNvbnN0IHVpZCA9IGRhdGEudXNlcklkO1xyXG4gICAgICBpZiAoIXVpZCkgcmV0dXJuO1xyXG4gICAgICB1c2VyU2V0LmFkZCh1aWQpO1xyXG4gICAgICB1c2VyQ291bnRzLnNldCh1aWQsICh1c2VyQ291bnRzLmdldCh1aWQpIHx8IDApICsgMSk7XHJcbiAgICAgIGNvbnN0IGxhc3QgPSB1c2VyTGFzdC5nZXQodWlkKTtcclxuICAgICAgY29uc3QgY3JlYXRlZCA9IGNyZWF0ZWRNYXAuZ2V0KHNuYXAuaWQpO1xyXG4gICAgICBpZiAoIWxhc3QgfHwgKGNyZWF0ZWQgJiYgY3JlYXRlZCA+IGxhc3QpKSB1c2VyTGFzdC5zZXQodWlkLCBjcmVhdGVkKTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIEZldGNoIG1pbmltYWwgdXNlciBwcm9maWxlc1xyXG4gICAgY29uc3QgdXNlcnMgPSBhd2FpdCBQcm9taXNlLmFsbChcclxuICAgICAgQXJyYXkuZnJvbSh1c2VyU2V0KS5tYXAoKHVpZCkgPT4gZ2V0RG9jKGRvYyhkYiwgJ3VzZXJzJywgdWlkKSkudGhlbigoZCk9Pih7IHVpZCwgZCB9KSkpXHJcbiAgICApO1xyXG5cclxuICAgIGNvbnN0IHJlc3VsdHMgPSB1c2Vycy5tYXAoKHsgdWlkLCBkIH0pID0+IHtcclxuICAgICAgY29uc3QgZGF0YSA9IGQuZXhpc3RzKCkgPyBkLmRhdGEoKSA6IHt9O1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHVzZXJJZDogdWlkLFxyXG4gICAgICAgIGRpc3BsYXlOYW1lOiBkYXRhLmRpc3BsYXlOYW1lIHx8IGRhdGEubmFtZSB8fCAnJyxcclxuICAgICAgICBlbWFpbDogZGF0YS5lbWFpbCB8fCAnJyxcclxuICAgICAgICBjb3VudDogdXNlckNvdW50cy5nZXQodWlkKSB8fCAwLFxyXG4gICAgICAgIGxhc3RSZXBvcnRBdDogdXNlckxhc3QuZ2V0KHVpZCkgfHwgbnVsbCxcclxuICAgICAgfTtcclxuICAgIH0pLnNvcnQoKGEsIGIpID0+IGIuY291bnQgLSBhLmNvdW50KTtcclxuXHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiByZXN1bHRzIH07XHJcbiAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCfinYwgW0ZpcmVzdG9yZV0gZ2V0UmVwb3J0ZWRVc2Vyc0J5U3RhdHVzIGVycm9yOicsIGVycik7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVyci5tZXNzYWdlLCBkYXRhOiBbXSB9O1xyXG4gIH1cclxufTtcclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT0gUFJPTU8gRlVOQ1RJT05TID09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG4vLyBBZGQgcHJvbW8gQU5EIHVwZGF0ZSByZXN0YXVyYW50XHJcbmV4cG9ydCBjb25zdCBhZGRQcm9tb0FuZFVwZGF0ZVJlc3RhdXJhbnQgPSBhc3luYyAocHJvbW9EYXRhKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnNvbGUubG9nKCfwn5SEIFtGaXJlc3RvcmVdIEFkZGluZyBwcm9tbyBhbmQgdXBkYXRpbmcgcmVzdGF1cmFudC4uLicpO1xyXG4gICAgXHJcbiAgICAvLyAxLiBBZGQgcHJvbW8gdG8gcHJvbW9zIGNvbGxlY3Rpb25cclxuICAgIGNvbnN0IHByb21vUmVmID0gYXdhaXQgYWRkRG9jKGNvbGxlY3Rpb24oZGIsICdwcm9tb3MnKSwge1xyXG4gICAgICAuLi5wcm9tb0RhdGEsXHJcbiAgICAgIGNyZWF0ZWRBdDogc2VydmVyVGltZXN0YW1wKCksXHJcbiAgICAgIHVwZGF0ZWRBdDogc2VydmVyVGltZXN0YW1wKClcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIDIuIFVwZGF0ZSByZXN0YXVyYW50IHdpdGggcHJvbW8gZGF0YVxyXG4gICAgY29uc3QgcmVzdGF1cmFudFJlZiA9IGRvYyhkYiwgJ3Jlc3RhdXJhbnRzJywgcHJvbW9EYXRhLnJlc3RhdXJhbnRJZCk7XHJcbiAgICBhd2FpdCB1cGRhdGVEb2MocmVzdGF1cmFudFJlZiwge1xyXG4gICAgICBpc1Byb21vOiB0cnVlLFxyXG4gICAgICBkaXNjb3VudDogcHJvbW9EYXRhLmRpc2NvdW50VmFsdWUsXHJcbiAgICAgIG1pblB1cmNoYXNlOiBwcm9tb0RhdGEubWluUHVyY2hhc2UgfHwgNTAwMDAsXHJcbiAgICAgIHByb21vRXhwaXJ5OiBwcm9tb0RhdGEuZW5kRGF0ZSxcclxuICAgICAgcHJvbW9UaXRsZTogcHJvbW9EYXRhLm5hbWUsXHJcbiAgICAgIHByb21vRGVzY3JpcHRpb246IHByb21vRGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgcHJvbW9UZXh0OiBgRGlza29uICR7cHJvbW9EYXRhLmRpc2NvdW50VmFsdWV9JSAke3Byb21vRGF0YS5kaXNjb3VudFR5cGUgPT09ICdwZXJjZW50YWdlJyA/ICcnIDogJ1JwJ31gLFxyXG4gICAgICB1cGRhdGVkQXQ6IHNlcnZlclRpbWVzdGFtcCgpXHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zb2xlLmxvZygn4pyFIFtGaXJlc3RvcmVdIFByb21vIGFkZGVkIGFuZCByZXN0YXVyYW50IHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5Jyk7XHJcbiAgICByZXR1cm4gcHJvbW9SZWYuaWQ7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBbRmlyZXN0b3JlXSBFcnJvciBhZGRpbmcgcHJvbW8gYW5kIHVwZGF0aW5nIHJlc3RhdXJhbnQ6JywgZXJyb3IpO1xyXG4gICAgdGhyb3cgZXJyb3I7XHJcbiAgfVxyXG59O1xyXG5cclxuLy8gVXBkYXRlIGV4aXN0aW5nIGFkZFByb21vIGZ1bmN0aW9uIHRvIGFsc28gdXBkYXRlIHJlc3RhdXJhbnRcclxuZXhwb3J0IGNvbnN0IGFkZFByb21vID0gYXN5bmMgKHByb21vRGF0YSkgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICAvLyBVc2UgdGhlIG5ldyBmdW5jdGlvbiB0aGF0IHVwZGF0ZXMgYm90aFxyXG4gICAgcmV0dXJuIGF3YWl0IGFkZFByb21vQW5kVXBkYXRlUmVzdGF1cmFudChwcm9tb0RhdGEpO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCfinYwgW0ZpcmVzdG9yZV0gRXJyb3IgaW4gYWRkUHJvbW86JywgZXJyb3IpO1xyXG4gICAgdGhyb3cgZXJyb3I7XHJcbiAgfVxyXG59O1xyXG5cclxuLy8gR2V0IGFjdGl2ZSBwcm9tb3MgZm9yIHJlc3RhdXJhbnRcclxuZXhwb3J0IGNvbnN0IGdldEFjdGl2ZVByb21vc0ZvclJlc3RhdXJhbnQgPSBhc3luYyAocmVzdGF1cmFudElkKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnNvbGUubG9nKCfwn5SNIFtGaXJlc3RvcmVdIEdldHRpbmcgYWN0aXZlIHByb21vcyBmb3IgcmVzdGF1cmFudDonLCByZXN0YXVyYW50SWQpO1xyXG4gICAgXHJcbiAgICBjb25zdCB0b2RheSA9IG5ldyBEYXRlKCk7XHJcbiAgICB0b2RheS5zZXRIb3VycygwLCAwLCAwLCAwKTtcclxuICAgIFxyXG4gICAgY29uc3QgcSA9IHF1ZXJ5KFxyXG4gICAgICBjb2xsZWN0aW9uKGRiLCAncHJvbW9zJyksXHJcbiAgICAgIHdoZXJlKCdyZXN0YXVyYW50SWQnLCAnPT0nLCByZXN0YXVyYW50SWQpLFxyXG4gICAgICB3aGVyZSgnc3RhdHVzJywgJz09JywgJ2FjdGl2ZScpLFxyXG4gICAgICB3aGVyZSgnc3RhcnREYXRlJywgJzw9JywgdG9kYXkpLFxyXG4gICAgICB3aGVyZSgnZW5kRGF0ZScsICc+PScsIHRvZGF5KVxyXG4gICAgKTtcclxuICAgIFxyXG4gICAgY29uc3QgcXVlcnlTbmFwc2hvdCA9IGF3YWl0IGdldERvY3MocSk7XHJcbiAgICBjb25zdCBwcm9tb3MgPSBbXTtcclxuICAgIFxyXG4gICAgcXVlcnlTbmFwc2hvdC5mb3JFYWNoKChkb2MpID0+IHtcclxuICAgICAgY29uc3QgZGF0YSA9IGRvYy5kYXRhKCk7XHJcbiAgICAgIHByb21vcy5wdXNoKHtcclxuICAgICAgICBpZDogZG9jLmlkLFxyXG4gICAgICAgIC4uLmRhdGEsXHJcbiAgICAgICAgc3RhcnREYXRlOiBhc0RhdGUoZGF0YS5zdGFydERhdGUpLFxyXG4gICAgICAgIGVuZERhdGU6IGFzRGF0ZShkYXRhLmVuZERhdGUpXHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIGNvbnNvbGUubG9nKGDinIUgW0ZpcmVzdG9yZV0gRm91bmQgJHtwcm9tb3MubGVuZ3RofSBhY3RpdmUgcHJvbW9zIGZvciByZXN0YXVyYW50ICR7cmVzdGF1cmFudElkfWApO1xyXG4gICAgcmV0dXJuIHByb21vcztcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcign4p2MIFtGaXJlc3RvcmVdIEVycm9yIGdldHRpbmcgYWN0aXZlIHByb21vczonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gW107XHJcbiAgfVxyXG59O1xyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PSBNRU5VUyAmIFJFU1RBVVJBTlQgPT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbi8vIEdldCBtZW51IGJ5IHJlc3RhdXJhbnRJZCAoVVBEQVRFRClcclxuZXhwb3J0IGNvbnN0IGdldE1lbnVzQnlSZXN0YXVyYW50SWQgPSBhc3luYyAocmVzdGF1cmFudElkKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnNvbGUubG9nKCfwn5SNIFtGaXJlc3RvcmVdIFNlYXJjaGluZyBtZW51cyBpbiBTVUJDT0xMRUNUSU9OIGZvciByZXN0YXVyYW50OicsIHJlc3RhdXJhbnRJZCk7XHJcbiAgICBcclxuICAgIC8vIFF1ZXJ5IGRhcmkgc3ViY29sbGVjdGlvbjogcmVzdGF1cmFudHMve3Jlc3RhdXJhbnRJZH0vbWVudXNcclxuICAgIGNvbnN0IG1lbnVzUmVmID0gY29sbGVjdGlvbihkYiwgJ3Jlc3RhdXJhbnRzJywgcmVzdGF1cmFudElkLCAnbWVudXMnKTtcclxuICAgIGNvbnN0IHEgPSBxdWVyeShtZW51c1JlZik7XHJcbiAgICBcclxuICAgIGNvbnN0IHF1ZXJ5U25hcHNob3QgPSBhd2FpdCBnZXREb2NzKHEpO1xyXG4gICAgY29uc3QgbWVudXMgPSBbXTtcclxuICAgIFxyXG4gICAgcXVlcnlTbmFwc2hvdC5mb3JFYWNoKChkb2MpID0+IHtcclxuICAgICAgY29uc3QgbWVudURhdGEgPSBkb2MuZGF0YSgpO1xyXG4gICAgICBjb25zb2xlLmxvZygn8J+ThCBbRmlyZXN0b3JlXSBNZW51IGRvY3VtZW50IGZyb20gc3ViY29sbGVjdGlvbjonLCBkb2MuaWQsIG1lbnVEYXRhKTtcclxuICAgICAgbWVudXMucHVzaCh7XHJcbiAgICAgICAgaWQ6IGRvYy5pZCxcclxuICAgICAgICAuLi5tZW51RGF0YSxcclxuICAgICAgICByZXN0YXVyYW50SWQ6IHJlc3RhdXJhbnRJZFxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICBjb25zb2xlLmxvZygn4pyFIFtGaXJlc3RvcmVdIEZvdW5kJywgbWVudXMubGVuZ3RoLCAnbWVudXMgaW4gc3ViY29sbGVjdGlvbicpO1xyXG4gICAgcmV0dXJuIG1lbnVzO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCfinYwgW0ZpcmVzdG9yZV0gRXJyb3IgZ2V0dGluZyBtZW51cyBmcm9tIHN1YmNvbGxlY3Rpb246JywgZXJyb3IpO1xyXG4gICAgXHJcbiAgICAvLyBGYWxsYmFjazogY29iYSBkYXJpIGNvbGxlY3Rpb24gbWVudXMgeWFuZyBsYW1hIChqaWthIGFkYSlcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCfwn5SEIFtGaXJlc3RvcmVdIFRyeWluZyBmYWxsYmFjazogY29sbGVjdGlvbiBtZW51cy4uLicpO1xyXG4gICAgICBjb25zdCBmYWxsYmFja1F1ZXJ5ID0gcXVlcnkoXHJcbiAgICAgICAgY29sbGVjdGlvbihkYiwgJ21lbnVzJyksXHJcbiAgICAgICAgd2hlcmUoJ3Jlc3RhdXJhbnRJZCcsICc9PScsIHJlc3RhdXJhbnRJZClcclxuICAgICAgKTtcclxuICAgICAgY29uc3QgZmFsbGJhY2tTbmFwc2hvdCA9IGF3YWl0IGdldERvY3MoZmFsbGJhY2tRdWVyeSk7XHJcbiAgICAgIGNvbnN0IGZhbGxiYWNrTWVudXMgPSBbXTtcclxuICAgICAgXHJcbiAgICAgIGZhbGxiYWNrU25hcHNob3QuZm9yRWFjaCgoZG9jKSA9PiB7XHJcbiAgICAgICAgZmFsbGJhY2tNZW51cy5wdXNoKHtcclxuICAgICAgICAgIGlkOiBkb2MuaWQsXHJcbiAgICAgICAgICAuLi5kb2MuZGF0YSgpXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG4gICAgICBcclxuICAgICAgY29uc29sZS5sb2coJ+KchSBbRmlyZXN0b3JlXSBGYWxsYmFjayBmb3VuZDonLCBmYWxsYmFja01lbnVzLmxlbmd0aCwgJ21lbnVzJyk7XHJcbiAgICAgIHJldHVybiBmYWxsYmFja01lbnVzO1xyXG4gICAgfSBjYXRjaCAoZmFsbGJhY2tFcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCfinYwgW0ZpcmVzdG9yZV0gRmFsbGJhY2sgYWxzbyBmYWlsZWQ6JywgZmFsbGJhY2tFcnJvcik7XHJcbiAgICAgIHJldHVybiBbXTtcclxuICAgIH1cclxuICB9XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgZ2V0QWN0aXZlUHJvbW9zRm9yTWVudSA9IGFzeW5jIChtZW51SWQpID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coJ/CflI0gW0ZpcmVzdG9yZV0gR2V0dGluZyBhY3RpdmUgcHJvbW9zIGZvciBtZW51OicsIG1lbnVJZCk7XHJcbiAgICBcclxuICAgIGNvbnN0IHRvZGF5ID0gbmV3IERhdGUoKTtcclxuICAgIHRvZGF5LnNldEhvdXJzKDAsIDAsIDAsIDApO1xyXG4gICAgXHJcbiAgICBjb25zdCBxID0gcXVlcnkoXHJcbiAgICAgIGNvbGxlY3Rpb24oZGIsICdwcm9tb3MnKSxcclxuICAgICAgd2hlcmUoJ21lbnVJZHMnLCAnYXJyYXktY29udGFpbnMnLCBtZW51SWQpLFxyXG4gICAgICB3aGVyZSgnc3RhdHVzJywgJz09JywgJ2FjdGl2ZScpLFxyXG4gICAgICB3aGVyZSgnc3RhcnREYXRlJywgJzw9JywgdG9kYXkpLFxyXG4gICAgICB3aGVyZSgnZW5kRGF0ZScsICc+PScsIHRvZGF5KVxyXG4gICAgKTtcclxuICAgIFxyXG4gICAgY29uc3QgcXVlcnlTbmFwc2hvdCA9IGF3YWl0IGdldERvY3MocSk7XHJcbiAgICBjb25zdCBwcm9tb3MgPSBbXTtcclxuICAgIFxyXG4gICAgcXVlcnlTbmFwc2hvdC5mb3JFYWNoKChkb2MpID0+IHtcclxuICAgICAgY29uc3QgcHJvbW9EYXRhID0gZG9jLmRhdGEoKTtcclxuICAgICAgcHJvbW9zLnB1c2goe1xyXG4gICAgICAgIGlkOiBkb2MuaWQsXHJcbiAgICAgICAgLi4ucHJvbW9EYXRhLFxyXG4gICAgICAgIHN0YXJ0RGF0ZTogYXNEYXRlKHByb21vRGF0YS5zdGFydERhdGUpLFxyXG4gICAgICAgIGVuZERhdGU6IGFzRGF0ZShwcm9tb0RhdGEuZW5kRGF0ZSlcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coYOKchSBbRmlyZXN0b3JlXSBGb3VuZCAke3Byb21vcy5sZW5ndGh9IGFjdGl2ZSBwcm9tb3MgZm9yIG1lbnUgJHttZW51SWR9YCk7XHJcbiAgICByZXR1cm4gcHJvbW9zO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCfinYwgW0ZpcmVzdG9yZV0gRXJyb3IgZ2V0dGluZyBhY3RpdmUgcHJvbW9zOicsIGVycm9yKTtcclxuICAgIHJldHVybiBbXTtcclxuICB9XHJcbn07XHJcblxyXG4vLyBHZXQgcmVzdGF1cmFudCBieSBJRCAoVVBEQVRFRClcclxuZXhwb3J0IGNvbnN0IGdldFJlc3RhdXJhbnRCeUlkID0gYXN5bmMgKHJlc3RhdXJhbnRJZCkgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBkb2NSZWYgPSBkb2MoZGIsICdyZXN0YXVyYW50cycsIHJlc3RhdXJhbnRJZCk7XHJcbiAgICBjb25zdCBkb2NTbmFwID0gYXdhaXQgZ2V0RG9jKGRvY1JlZik7XHJcblxyXG4gICAgaWYgKGRvY1NuYXAuZXhpc3RzKCkpIHtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBpZDogZG9jU25hcC5pZCxcclxuICAgICAgICAuLi5kb2NTbmFwLmRhdGEoKSxcclxuICAgICAgfTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVzdGF1cmFudCBub3QgZm91bmQnKTtcclxuICAgIH1cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcign4p2MIFtGaXJlc3RvcmVdIEVycm9yIGdldHRpbmcgcmVzdGF1cmFudDonLCBlcnJvcik7XHJcbiAgICB0aHJvdyBlcnJvcjtcclxuICB9XHJcbn07XHJcblxyXG4vLyBHZXQgcmVzdGF1cmFudHMgYnkgb3duZXIgKFVQREFURUQpXHJcbmV4cG9ydCBjb25zdCBnZXRSZXN0YXVyYW50c0J5T3duZXIgPSBhc3luYyAob3duZXJJZCkgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCByZXN0YXVyYW50c1JlZiA9IGNvbGxlY3Rpb24oZGIsICdyZXN0YXVyYW50cycpO1xyXG4gICAgY29uc3QgcSA9IHF1ZXJ5KFxyXG4gICAgICByZXN0YXVyYW50c1JlZixcclxuICAgICAgd2hlcmUoJ293bmVySWQnLCAnPT0nLCBvd25lcklkKVxyXG4gICAgKTtcclxuXHJcbiAgICBjb25zdCBxdWVyeVNuYXBzaG90ID0gYXdhaXQgZ2V0RG9jcyhxKTtcclxuICAgIGNvbnN0IHJlc3RhdXJhbnRzID0gW107XHJcblxyXG4gICAgcXVlcnlTbmFwc2hvdC5mb3JFYWNoKChkb2MpID0+IHtcclxuICAgICAgcmVzdGF1cmFudHMucHVzaCh7XHJcbiAgICAgICAgaWQ6IGRvYy5pZCxcclxuICAgICAgICAuLi5kb2MuZGF0YSgpLFxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiByZXN0YXVyYW50cztcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcign4p2MIFtGaXJlc3RvcmVdIEVycm9yIGdldHRpbmcgcmVzdGF1cmFudHM6JywgZXJyb3IpO1xyXG4gICAgdGhyb3cgZXJyb3I7XHJcbiAgfVxyXG59O1xyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PSBTWVNURU0gTk9USUZJQ0FUSU9OUyA9PT09PT09PT09PT09PT09PT09PT1cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbmV4cG9ydCBjb25zdCBnZXRTeXN0ZW1Ob3RpZmljYXRpb25zID0gYXN5bmMgKGxpbWl0Q291bnQgPSAyMCkgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBxID0gcXVlcnkoXHJcbiAgICAgIGNvbGxlY3Rpb24oZGIsIFwic3lzdGVtTm90aWZpY2F0aW9uc1wiKSxcclxuICAgICAgb3JkZXJCeShcImNyZWF0ZWRBdFwiLCBcImRlc2NcIiksXHJcbiAgICAgIGxpbWl0KGxpbWl0Q291bnQpXHJcbiAgICApO1xyXG5cclxuICAgIGNvbnN0IHNuYXAgPSBhd2FpdCBnZXREb2NzKHEpO1xyXG4gICAgY29uc3QgcmVzdWx0ID0gW107XHJcblxyXG4gICAgc25hcC5mb3JFYWNoKChkKSA9PiB7XHJcbiAgICAgIGNvbnN0IGRhdGEgPSBkLmRhdGEoKTtcclxuICAgICAgcmVzdWx0LnB1c2goe1xyXG4gICAgICAgIGlkOiBkLmlkLFxyXG4gICAgICAgIC4uLmRhdGEsXHJcbiAgICAgICAgY3JlYXRlZEF0OiBhc0RhdGUoZGF0YS5jcmVhdGVkQXQpLFxyXG4gICAgICAgIHJlYWRBdDogYXNEYXRlKGRhdGEucmVhZEF0KVxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiByZXN1bHQ7XHJcbiAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwi4p2MIFtGaXJlc3RvcmVdIGdldFN5c3RlbU5vdGlmaWNhdGlvbnMgZXJyb3I6XCIsIGVycik7XHJcbiAgICB0aHJvdyBlcnI7XHJcbiAgfVxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGdldFBlbmRpbmdSZXN0YXVyYW50c0NvdW50ID0gYXN5bmMgKCkgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBxID0gcXVlcnkoXHJcbiAgICAgIGNvbGxlY3Rpb24oZGIsIFwicmVzdGF1cmFudHNcIiksXHJcbiAgICAgIHdoZXJlKFwic3RhdHVzXCIsIFwiPT1cIiwgXCJwZW5kaW5nXCIpXHJcbiAgICApO1xyXG5cclxuICAgIGNvbnN0IHNuYXAgPSBhd2FpdCBnZXREb2NzKHEpO1xyXG4gICAgcmV0dXJuIHNuYXAuc2l6ZTtcclxuICB9IGNhdGNoIChlcnIpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCLinYwgW0ZpcmVzdG9yZV0gZ2V0UGVuZGluZ1Jlc3RhdXJhbnRzQ291bnQgZXJyb3I6XCIsIGVycik7XHJcbiAgICB0aHJvdyBlcnI7XHJcbiAgfVxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGNyZWF0ZVN5c3RlbU5vdGlmaWNhdGlvbiA9IGFzeW5jICh0aXRsZSwgbWVzc2FnZSwgdHlwZSA9IFwic3lzdGVtXCIsIHJlbGF0ZWRJZCA9IG51bGwpID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgcmVmID0gZG9jKGNvbGxlY3Rpb24oZGIsIFwic3lzdGVtTm90aWZpY2F0aW9uc1wiKSk7XHJcbiAgICBjb25zdCBkYXRhID0ge1xyXG4gICAgICBpZDogcmVmLmlkLFxyXG4gICAgICB0aXRsZSxcclxuICAgICAgbWVzc2FnZSxcclxuICAgICAgdHlwZSxcclxuICAgICAgcmVsYXRlZElkLFxyXG4gICAgICB1c2VySWQ6IFwic3lzdGVtXCIsXHJcbiAgICAgIHJlYWQ6IGZhbHNlLFxyXG4gICAgICBjcmVhdGVkQXQ6IHNlcnZlclRpbWVzdGFtcCgpXHJcbiAgICB9O1xyXG5cclxuICAgIGF3YWl0IHNldERvYyhyZWYsIGRhdGEpO1xyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgaWQ6IHJlZi5pZCB9O1xyXG4gIH0gY2F0Y2ggKGVycikge1xyXG4gICAgY29uc29sZS5lcnJvcihcIuKdjCBbRmlyZXN0b3JlXSBjcmVhdGVTeXN0ZW1Ob3RpZmljYXRpb24gZXJyb3I6XCIsIGVycik7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVyci5tZXNzYWdlIH07XHJcbiAgfVxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGdldFVucmVhZFN5c3RlbU5vdGlmaWNhdGlvbnNDb3VudCA9IGFzeW5jICgpID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgcSA9IHF1ZXJ5KFxyXG4gICAgICBjb2xsZWN0aW9uKGRiLCBcInN5c3RlbU5vdGlmaWNhdGlvbnNcIiksXHJcbiAgICAgIHdoZXJlKFwicmVhZFwiLCBcIj09XCIsIGZhbHNlKSxcclxuICAgICAgd2hlcmUoXCJ1c2VySWRcIiwgXCI9PVwiLCBcInN5c3RlbVwiKVxyXG4gICAgKTtcclxuXHJcbiAgICBjb25zdCBzbmFwID0gYXdhaXQgZ2V0RG9jcyhxKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGNvdW50OiBzbmFwLnNpemUgfTtcclxuICB9IGNhdGNoIChlcnIpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCLinYwgW0ZpcmVzdG9yZV0gZ2V0VW5yZWFkU3lzdGVtTm90aWZpY2F0aW9uc0NvdW50IGVycm9yOlwiLCBlcnIpO1xyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGNvdW50OiAwIH07XHJcbiAgfVxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IG1hcmtBbGxTeXN0ZW1Ob3RpZmljYXRpb25zQXNSZWFkID0gYXN5bmMgKCkgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBxID0gcXVlcnkoXHJcbiAgICAgIGNvbGxlY3Rpb24oZGIsIFwic3lzdGVtTm90aWZpY2F0aW9uc1wiKSxcclxuICAgICAgd2hlcmUoXCJyZWFkXCIsIFwiPT1cIiwgZmFsc2UpLFxyXG4gICAgICB3aGVyZShcInVzZXJJZFwiLCBcIj09XCIsIFwic3lzdGVtXCIpXHJcbiAgICApO1xyXG5cclxuICAgIGNvbnN0IHNuYXAgPSBhd2FpdCBnZXREb2NzKHEpO1xyXG4gICAgY29uc3QgYmF0Y2ggPSB3cml0ZUJhdGNoKGRiKTtcclxuXHJcbiAgICBzbmFwLmRvY3MuZm9yRWFjaCgoZG9jU25hcCkgPT4ge1xyXG4gICAgICBjb25zdCByZWYgPSBkb2MoZGIsIFwic3lzdGVtTm90aWZpY2F0aW9uc1wiLCBkb2NTbmFwLmlkKTtcclxuICAgICAgYmF0Y2gudXBkYXRlKHJlZiwge1xyXG4gICAgICAgIHJlYWQ6IHRydWUsXHJcbiAgICAgICAgcmVhZEF0OiBzZXJ2ZXJUaW1lc3RhbXAoKVxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGF3YWl0IGJhdGNoLmNvbW1pdCgpO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgbWVzc2FnZTogYCR7c25hcC5zaXplfSBub3RpZmlrYXNpIHNpc3RlbSBkaXRhbmRhaSBzZWJhZ2FpIGRpYmFjYWBcclxuICAgIH07XHJcbiAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwi4p2MIFtGaXJlc3RvcmVdIG1hcmtBbGxTeXN0ZW1Ob3RpZmljYXRpb25zQXNSZWFkIGVycm9yOlwiLCBlcnIpO1xyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnIubWVzc2FnZSB9O1xyXG4gIH1cclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBtYXJrU3lzdGVtTm90aWZpY2F0aW9uQXNSZWFkID0gYXN5bmMgKG5vdGlmaWNhdGlvbklkKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGF3YWl0IHVwZGF0ZURvYyhkb2MoZGIsIFwic3lzdGVtTm90aWZpY2F0aW9uc1wiLCBub3RpZmljYXRpb25JZCksIHtcclxuICAgICAgcmVhZDogdHJ1ZSxcclxuICAgICAgcmVhZEF0OiBzZXJ2ZXJUaW1lc3RhbXAoKVxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwi4p2MIFtGaXJlc3RvcmVdIG1hcmtTeXN0ZW1Ob3RpZmljYXRpb25Bc1JlYWQgZXJyb3I6XCIsIGVycik7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVyci5tZXNzYWdlIH07XHJcbiAgfVxyXG59O1xyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSBVU0VSIEZVTkNUSU9OUyA9PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbmV4cG9ydCBjb25zdCB1cGRhdGVVc2VyID0gYXN5bmMgKHVzZXJJZCwgdXBkYXRlRGF0YSkgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBhd2FpdCB1cGRhdGVEb2MoZG9jKGRiLCBcInVzZXJzXCIsIHVzZXJJZCksIHtcclxuICAgICAgLi4udXBkYXRlRGF0YSxcclxuICAgICAgdXBkYXRlZEF0OiBzZXJ2ZXJUaW1lc3RhbXAoKVxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVyci5tZXNzYWdlIH07XHJcbiAgfVxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGdldEFsbFVzZXJzID0gYXN5bmMgKCkgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBzbmFwID0gYXdhaXQgZ2V0RG9jcyhjb2xsZWN0aW9uKGRiLCBcInVzZXJzXCIpKTtcclxuICAgIHJldHVybiBzbmFwLmRvY3MubWFwKChkKSA9PiAoe1xyXG4gICAgICBpZDogZC5pZCxcclxuICAgICAgLi4uZC5kYXRhKCksXHJcbiAgICAgIGNyZWF0ZWRBdDogYXNEYXRlKGQuZGF0YSgpLmNyZWF0ZWRBdClcclxuICAgIH0pKTtcclxuICB9IGNhdGNoIChlcnIpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCLinYwgW0ZpcmVzdG9yZV0gZ2V0QWxsVXNlcnMgZXJyb3I6XCIsIGVycik7XHJcbiAgICB0aHJvdyBlcnI7XHJcbiAgfVxyXG59O1xyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09IFJFU1RBVVJBTlRTID09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbmV4cG9ydCBjb25zdCBjcmVhdGVSZXN0YXVyYW50ID0gYXN5bmMgKHJlc3RhdXJhbnREYXRhKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGV4aXN0aW5nUmVzdGF1cmFudHMgPSBhd2FpdCBnZXRSZXN0YXVyYW50c0J5T3duZXIocmVzdGF1cmFudERhdGEub3duZXJJZCk7XHJcbiAgICBpZiAoZXhpc3RpbmdSZXN0YXVyYW50cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignQW5kYSBzdWRhaCBtZW1pbGlraSByZXN0b3Jhbi4gU2V0aWFwIG93bmVyIGhhbnlhIGJvbGVoIG1lbWlsaWtpIDEgcmVzdG9yYW4uJyk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgZG9jUmVmID0gYXdhaXQgYWRkRG9jKGNvbGxlY3Rpb24oZGIsICdyZXN0YXVyYW50cycpLCB7XHJcbiAgICAgIC4uLnJlc3RhdXJhbnREYXRhLFxyXG4gICAgICBjcmVhdGVkQXQ6IHNlcnZlclRpbWVzdGFtcCgpLFxyXG4gICAgICB1cGRhdGVkQXQ6IHNlcnZlclRpbWVzdGFtcCgpXHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLy8gTm90aWZ5IGFkbWluIGFib3V0IG5ldyByZXN0YXVyYW50IHJlZ2lzdHJhdGlvblxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgdGl0bGUgPSAnUGVuZGFmdGFyYW4gUmVzdG9yYW4gQmFydSc7XHJcbiAgICAgIGNvbnN0IG1lc3NhZ2UgPSBgJHtyZXN0YXVyYW50RGF0YS5uYW1lIHx8ICdSZXN0b3Jhbid9IG1lbnVuZ2d1IHZlcmlmaWthc2kgYWRtaW4uYDtcclxuICAgICAgYXdhaXQgY3JlYXRlU3lzdGVtTm90aWZpY2F0aW9uKHRpdGxlLCBtZXNzYWdlLCAncmVzdGF1cmFudF9yZWdpc3RyYXRpb24nLCBkb2NSZWYuaWQpO1xyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICBjb25zb2xlLndhcm4oJ0ZhaWxlZCB0byBjcmVhdGUgYWRtaW4gbm90aWZpY2F0aW9uIGZvciByZXN0YXVyYW50IHJlZ2lzdHJhdGlvbjonLCBlPy5tZXNzYWdlIHx8IGUpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGRvY1JlZi5pZDtcclxuXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBbRmlyZXN0b3JlXSBFcnJvciBjcmVhdGluZyByZXN0YXVyYW50OicsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBnZXRBbGxSZXN0YXVyYW50cyA9IGFzeW5jICgpID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgcSA9IHF1ZXJ5KGNvbGxlY3Rpb24oZGIsICdyZXN0YXVyYW50cycpLCBvcmRlckJ5KCdjcmVhdGVkQXQnLCAnZGVzYycpKTtcclxuICAgIGNvbnN0IHF1ZXJ5U25hcHNob3QgPSBhd2FpdCBnZXREb2NzKHEpO1xyXG4gICAgY29uc3QgcmVzdGF1cmFudHMgPSBbXTtcclxuICAgIHF1ZXJ5U25hcHNob3QuZm9yRWFjaCgoZG9jKSA9PiB7XHJcbiAgICAgIHJlc3RhdXJhbnRzLnB1c2goeyBpZDogZG9jLmlkLCAuLi5kb2MuZGF0YSgpIH0pO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gcmVzdGF1cmFudHM7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBbRmlyZXN0b3JlXSBFcnJvciBnZXR0aW5nIHJlc3RhdXJhbnRzOicsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCB1cGRhdGVSZXN0YXVyYW50U3RhdHVzID0gYXN5bmMgKHJlc3RhdXJhbnRJZCwgc3RhdHVzLCByZWplY3Rpb25SZWFzb24gPSBudWxsKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHJlc3RhdXJhbnRSZWYgPSBkb2MoZGIsICdyZXN0YXVyYW50cycsIHJlc3RhdXJhbnRJZCk7XHJcbiAgICBjb25zdCB1cGRhdGVEYXRhID0ge1xyXG4gICAgICBzdGF0dXMsXHJcbiAgICAgIHVwZGF0ZWRBdDogc2VydmVyVGltZXN0YW1wKClcclxuICAgIH07XHJcbiAgICBcclxuICAgIGlmIChyZWplY3Rpb25SZWFzb24pIHtcclxuICAgICAgdXBkYXRlRGF0YS5yZWplY3Rpb25SZWFzb24gPSByZWplY3Rpb25SZWFzb247XHJcbiAgICAgIHVwZGF0ZURhdGEucmVqZWN0aW9uRGF0ZSA9IHNlcnZlclRpbWVzdGFtcCgpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBhd2FpdCB1cGRhdGVEb2MocmVzdGF1cmFudFJlZiwgdXBkYXRlRGF0YSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBbRmlyZXN0b3JlXSBFcnJvciB1cGRhdGluZyByZXN0YXVyYW50IHN0YXR1czonLCBlcnJvcik7XHJcbiAgICB0aHJvdyBlcnJvcjtcclxuICB9XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgdXBkYXRlUmVzdGF1cmFudCA9IGFzeW5jIChyZXN0YXVyYW50SWQsIGRhdGEpID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgcmVzdGF1cmFudFJlZiA9IGRvYyhkYiwgJ3Jlc3RhdXJhbnRzJywgcmVzdGF1cmFudElkKTtcclxuICAgIGF3YWl0IHVwZGF0ZURvYyhyZXN0YXVyYW50UmVmLCB7XHJcbiAgICAgIC4uLmRhdGEsXHJcbiAgICAgIHVwZGF0ZWRBdDogc2VydmVyVGltZXN0YW1wKClcclxuICAgIH0pO1xyXG4gICAgY29uc29sZS5sb2coJ+KchSBbRmlyZXN0b3JlXSBSZXN0YXVyYW50IHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5OicsIHJlc3RhdXJhbnRJZCk7XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcign4p2MIFtGaXJlc3RvcmVdIEVycm9yIHVwZGF0aW5nIHJlc3RhdXJhbnQ6JywgZXJyb3IpO1xyXG4gICAgdGhyb3cgZXJyb3I7XHJcbiAgfVxyXG59O1xyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gUkVTRVJWQVRJT05TID09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbmV4cG9ydCBjb25zdCBnZXRSZXN0YXVyYW50UmVzZXJ2YXRpb25zID0gYXN5bmMgKHJlc3RhdXJhbnRJZCkgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBxID0gcXVlcnkoXHJcbiAgICAgIGNvbGxlY3Rpb24oZGIsIFwicmVzZXJ2YXRpb25zXCIpLFxyXG4gICAgICB3aGVyZShcInJlc3RhdXJhbnRJZFwiLCBcIj09XCIsIHJlc3RhdXJhbnRJZCksXHJcbiAgICAgIG9yZGVyQnkoXCJjcmVhdGVkQXRcIiwgXCJkZXNjXCIpXHJcbiAgICApO1xyXG5cclxuICAgIGNvbnN0IHNuYXAgPSBhd2FpdCBnZXREb2NzKHEpO1xyXG4gICAgcmV0dXJuIHNuYXAuZG9jcy5tYXAoKGQpID0+ICh7XHJcbiAgICAgIGlkOiBkLmlkLFxyXG4gICAgICAuLi5kLmRhdGEoKSxcclxuICAgICAgY3JlYXRlZEF0OiBhc0RhdGUoZC5kYXRhKCkuY3JlYXRlZEF0KSxcclxuICAgICAgZGF0ZTogYXNEYXRlKGQuZGF0YSgpLmRhdGUpLFxyXG4gICAgfSkpO1xyXG4gIH0gY2F0Y2ggKGVycikge1xyXG4gICAgY29uc29sZS5lcnJvcihcIuKdjCBbRmlyZXN0b3JlXSBnZXRSZXN0YXVyYW50UmVzZXJ2YXRpb25zIGVycm9yOlwiLCBlcnIpO1xyXG4gICAgdGhyb3cgZXJyO1xyXG4gIH1cclxufTtcclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gRkFWT1JJVEVTID09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5leHBvcnQgY29uc3QgaXNSZXN0YXVyYW50RmF2b3JpdGUgPSBhc3luYyAodXNlcklkLCByZXN0YXVyYW50SWQpID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgcSA9IHF1ZXJ5KFxyXG4gICAgICBjb2xsZWN0aW9uKGRiLCBcImZhdm9yaXRlc1wiKSxcclxuICAgICAgd2hlcmUoXCJ1c2VySWRcIiwgXCI9PVwiLCB1c2VySWQpLFxyXG4gICAgICB3aGVyZShcInJlc3RhdXJhbnRJZFwiLCBcIj09XCIsIHJlc3RhdXJhbnRJZClcclxuICAgICk7XHJcblxyXG4gICAgY29uc3QgcXVlcnlTbmFwc2hvdCA9IGF3YWl0IGdldERvY3MocSk7XHJcbiAgICByZXR1cm4geyBcclxuICAgICAgc3VjY2VzczogdHJ1ZSwgXHJcbiAgICAgIGlzRmF2b3JpdGU6ICFxdWVyeVNuYXBzaG90LmVtcHR5IFxyXG4gICAgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcign4p2MIFtGaXJlc3RvcmVdIEVycm9yIGNoZWNraW5nIGZhdm9yaXRlOicsIGVycm9yKTtcclxuICAgIHJldHVybiB7IFxyXG4gICAgICBzdWNjZXNzOiBmYWxzZSwgXHJcbiAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlLFxyXG4gICAgICBpc0Zhdm9yaXRlOiBmYWxzZSBcclxuICAgIH07XHJcbiAgfVxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGFkZFRvRmF2b3JpdGVzID0gYXN5bmMgKHVzZXJJZCwgcmVzdGF1cmFudElkLCByZXN0YXVyYW50RGF0YSkgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmxvZygn4p6VIFtGaXJlc3RvcmVdIEFkZGluZyB0byBmYXZvcml0ZXM6JywgeyB1c2VySWQsIHJlc3RhdXJhbnRJZCB9KTtcclxuICAgIFxyXG4gICAgY29uc3QgZG9jSWQgPSBgJHt1c2VySWR9XyR7cmVzdGF1cmFudElkfWA7XHJcbiAgICBjb25zdCBmYXZvcml0ZVJlZiA9IGRvYyhkYiwgXCJmYXZvcml0ZXNcIiwgZG9jSWQpO1xyXG4gICAgXHJcbiAgICBhd2FpdCBzZXREb2MoZmF2b3JpdGVSZWYsIHtcclxuICAgICAgdXNlcklkLFxyXG4gICAgICByZXN0YXVyYW50SWQsXHJcbiAgICAgIHJlc3RhdXJhbnREYXRhLFxyXG4gICAgICBhZGRlZEF0OiBzZXJ2ZXJUaW1lc3RhbXAoKVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIGNvbnNvbGUubG9nKCfinIUgW0ZpcmVzdG9yZV0gU3VjY2Vzc2Z1bGx5IGFkZGVkIHRvIGZhdm9yaXRlcycpO1xyXG4gICAgcmV0dXJuIHsgXHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgIG1lc3NhZ2U6ICdSZXN0b3JhbiBiZXJoYXNpbCBkaXRhbWJhaGthbiBrZSBmYXZvcml0J1xyXG4gICAgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcign4p2MIFtGaXJlc3RvcmVdIEVycm9yIGFkZGluZyB0byBmYXZvcml0ZXM6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHsgXHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLCBcclxuICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UgXHJcbiAgICB9O1xyXG4gIH1cclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCByZW1vdmVGcm9tRmF2b3JpdGVzID0gYXN5bmMgKHVzZXJJZCwgcmVzdGF1cmFudElkKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnNvbGUubG9nKCfinpYgW0ZpcmVzdG9yZV0gUmVtb3ZpbmcgZnJvbSBmYXZvcml0ZXM6JywgeyB1c2VySWQsIHJlc3RhdXJhbnRJZCB9KTtcclxuICAgIFxyXG4gICAgY29uc3QgZG9jSWQgPSBgJHt1c2VySWR9XyR7cmVzdGF1cmFudElkfWA7XHJcbiAgICBjb25zdCBmYXZvcml0ZVJlZiA9IGRvYyhkYiwgXCJmYXZvcml0ZXNcIiwgZG9jSWQpO1xyXG4gICAgY29uc3QgZmF2b3JpdGVTbmFwID0gYXdhaXQgZ2V0RG9jKGZhdm9yaXRlUmVmKTtcclxuICAgIFxyXG4gICAgaWYgKGZhdm9yaXRlU25hcC5leGlzdHMoKSkge1xyXG4gICAgICBhd2FpdCBkZWxldGVEb2MoZmF2b3JpdGVSZWYpO1xyXG4gICAgICBjb25zb2xlLmxvZygn4pyFIFtGaXJlc3RvcmVdIFN1Y2Nlc3NmdWxseSByZW1vdmVkIGZyb20gZmF2b3JpdGVzJyk7XHJcbiAgICAgIHJldHVybiB7IFxyXG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgbWVzc2FnZTogJ1Jlc3RvcmFuIGJlcmhhc2lsIGRpaGFwdXMgZGFyaSBmYXZvcml0J1xyXG4gICAgICB9O1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY29uc29sZS5sb2coJ+KaoO+4jyBbRmlyZXN0b3JlXSBGYXZvcml0ZSBub3QgZm91bmQnKTtcclxuICAgICAgcmV0dXJuIHsgXHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsIFxyXG4gICAgICAgIGVycm9yOiAnRmF2b3JpdGUgbm90IGZvdW5kJyBcclxuICAgICAgfTtcclxuICAgIH1cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcign4p2MIFtGaXJlc3RvcmVdIEVycm9yIHJlbW92aW5nIGZyb20gZmF2b3JpdGVzOicsIGVycm9yKTtcclxuICAgIHJldHVybiB7IFxyXG4gICAgICBzdWNjZXNzOiBmYWxzZSwgXHJcbiAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlIFxyXG4gICAgfTtcclxuICB9XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgZ2V0VXNlckZhdm9yaXRlcyA9IGFzeW5jICh1c2VySWQpID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coJ/CflI0gW0ZpcmVzdG9yZV0gR2V0dGluZyBmYXZvcml0ZXMgZm9yIHVzZXI6JywgdXNlcklkKTtcclxuICAgIFxyXG4gICAgY29uc3QgcSA9IHF1ZXJ5KFxyXG4gICAgICBjb2xsZWN0aW9uKGRiLCAnZmF2b3JpdGVzJyksXHJcbiAgICAgIHdoZXJlKCd1c2VySWQnLCAnPT0nLCB1c2VySWQpXHJcbiAgICApO1xyXG4gICAgXHJcbiAgICBjb25zdCBxdWVyeVNuYXBzaG90ID0gYXdhaXQgZ2V0RG9jcyhxKTtcclxuICAgIGNvbnNvbGUubG9nKCfinIUgW0ZpcmVzdG9yZV0gRm91bmQnLCBxdWVyeVNuYXBzaG90LnNpemUsICdmYXZvcml0ZXMnKTtcclxuICAgIFxyXG4gICAgY29uc3QgZmF2b3JpdGVzID0gW107XHJcbiAgICBcclxuICAgIGZvciAoY29uc3QgZG9jU25hcCBvZiBxdWVyeVNuYXBzaG90LmRvY3MpIHtcclxuICAgICAgY29uc3QgZGF0YSA9IGRvY1NuYXAuZGF0YSgpO1xyXG4gICAgICBcclxuICAgICAgbGV0IHJlc3RhdXJhbnREYXRhID0gZGF0YS5yZXN0YXVyYW50RGF0YTtcclxuICAgICAgXHJcbiAgICAgIGlmICghcmVzdGF1cmFudERhdGEgfHwgT2JqZWN0LmtleXMocmVzdGF1cmFudERhdGEpLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCfimqDvuI8gW0ZpcmVzdG9yZV0gcmVzdGF1cmFudERhdGEgaXMgbnVsbCBmb3I6JywgZGF0YS5yZXN0YXVyYW50SWQpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICBjb25zdCByZXN0YXVyYW50RG9jID0gYXdhaXQgZ2V0RG9jKGRvYyhkYiwgJ3Jlc3RhdXJhbnRzJywgZGF0YS5yZXN0YXVyYW50SWQpKTtcclxuICAgICAgICAgIGlmIChyZXN0YXVyYW50RG9jLmV4aXN0cygpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3RhdXJhbnQgPSByZXN0YXVyYW50RG9jLmRhdGEoKTtcclxuICAgICAgICAgICAgcmVzdGF1cmFudERhdGEgPSB7XHJcbiAgICAgICAgICAgICAgbmFtZTogcmVzdGF1cmFudC5uYW1lIHx8ICdSZXN0b3JhbicsXHJcbiAgICAgICAgICAgICAgaW1hZ2U6IHJlc3RhdXJhbnQuaW1hZ2UgfHwgbnVsbCxcclxuICAgICAgICAgICAgICBjYXRlZ29yeTogcmVzdGF1cmFudC5jYXRlZ29yeSB8fCAnUmVzdG9yYW4nLFxyXG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiByZXN0YXVyYW50LmRlc2NyaXB0aW9uIHx8ICcnLFxyXG4gICAgICAgICAgICAgIHJhdGluZzogcmVzdGF1cmFudC5yYXRpbmcgfHwgMFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgYXdhaXQgdXBkYXRlRG9jKGRvYyhkYiwgJ2Zhdm9yaXRlcycsIGRvY1NuYXAuaWQpLCB7XHJcbiAgICAgICAgICAgICAgcmVzdGF1cmFudERhdGE6IHJlc3RhdXJhbnREYXRhXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ/CflIQgW0ZpcmVzdG9yZV0gVXBkYXRlZCByZXN0YXVyYW50RGF0YSBmb3I6JywgZGF0YS5yZXN0YXVyYW50SWQpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gY2F0Y2ggKGZldGNoRXJyb3IpIHtcclxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBbRmlyZXN0b3JlXSBFcnJvciBmZXRjaGluZyByZXN0YXVyYW50OicsIGZldGNoRXJyb3IpO1xyXG4gICAgICAgICAgcmVzdGF1cmFudERhdGEgPSB7XHJcbiAgICAgICAgICAgIG5hbWU6ICdSZXN0b3JhbicsXHJcbiAgICAgICAgICAgIHJlc3RhdXJhbnRJZDogZGF0YS5yZXN0YXVyYW50SWRcclxuICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICBmYXZvcml0ZXMucHVzaCh7XHJcbiAgICAgICAgaWQ6IGRvY1NuYXAuaWQsXHJcbiAgICAgICAgcmVzdGF1cmFudElkOiBkYXRhLnJlc3RhdXJhbnRJZCxcclxuICAgICAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxyXG4gICAgICAgIHJlc3RhdXJhbnREYXRhOiByZXN0YXVyYW50RGF0YSxcclxuICAgICAgICBhZGRlZEF0OiBhc0RhdGUoZGF0YS5hZGRlZEF0KVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coJ/Cfk4ogW0ZpcmVzdG9yZV0gUmV0dXJuaW5nJywgZmF2b3JpdGVzLmxlbmd0aCwgJ2Zhdm9yaXRlcycpO1xyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogZmF2b3JpdGVzIH07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBbRmlyZXN0b3JlXSBFcnJvciBnZXR0aW5nIHVzZXIgZmF2b3JpdGVzOicsIGVycm9yKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSwgZGF0YTogW10gfTtcclxuICB9XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgdG9nZ2xlRmF2b3JpdGUgPSBhc3luYyAodXNlcklkLCByZXN0YXVyYW50SWQsIHJlc3RhdXJhbnREYXRhID0gbnVsbCkgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmxvZygn8J+UhCBbVG9nZ2xlRmF2b3JpdGVdIFRvZ2dsaW5nOicsIHtcclxuICAgICAgdXNlcklkLFxyXG4gICAgICByZXN0YXVyYW50SWQsXHJcbiAgICAgIHJlc3RhdXJhbnREYXRhOiByZXN0YXVyYW50RGF0YSA/ICdleGlzdHMnIDogJ251bGwnXHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgY29uc3QgZG9jSWQgPSBgJHt1c2VySWR9XyR7cmVzdGF1cmFudElkfWA7XHJcbiAgICBjb25zdCBmYXZvcml0ZVJlZiA9IGRvYyhkYiwgJ2Zhdm9yaXRlcycsIGRvY0lkKTtcclxuICAgIGNvbnN0IGZhdm9yaXRlU25hcCA9IGF3YWl0IGdldERvYyhmYXZvcml0ZVJlZik7XHJcbiAgICBcclxuICAgIGlmIChmYXZvcml0ZVNuYXAuZXhpc3RzKCkpIHtcclxuICAgICAgYXdhaXQgZGVsZXRlRG9jKGZhdm9yaXRlUmVmKTtcclxuICAgICAgcmV0dXJuIHsgXHJcbiAgICAgICAgc3VjY2VzczogdHJ1ZSwgXHJcbiAgICAgICAgYWN0aW9uOiAncmVtb3ZlZCcsXHJcbiAgICAgICAgbWVzc2FnZTogJ1Jlc3RvcmFuIGRpaGFwdXMgZGFyaSBmYXZvcml0JyxcclxuICAgICAgICBpc0Zhdm9yaXRlOiBmYWxzZVxyXG4gICAgICB9O1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgbGV0IHJlc3REYXRhID0gcmVzdGF1cmFudERhdGE7XHJcbiAgICAgIFxyXG4gICAgICBpZiAoIXJlc3REYXRhKSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgIGNvbnN0IHJlc3RhdXJhbnREb2MgPSBhd2FpdCBnZXREb2MoZG9jKGRiLCAncmVzdGF1cmFudHMnLCByZXN0YXVyYW50SWQpKTtcclxuICAgICAgICAgIGlmIChyZXN0YXVyYW50RG9jLmV4aXN0cygpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3RhdXJhbnQgPSByZXN0YXVyYW50RG9jLmRhdGEoKTtcclxuICAgICAgICAgICAgcmVzdERhdGEgPSB7XHJcbiAgICAgICAgICAgICAgbmFtZTogcmVzdGF1cmFudC5uYW1lIHx8ICdSZXN0b3JhbicsXHJcbiAgICAgICAgICAgICAgaW1hZ2U6IHJlc3RhdXJhbnQuaW1hZ2UgfHwgbnVsbCxcclxuICAgICAgICAgICAgICBjYXRlZ29yeTogcmVzdGF1cmFudC5jYXRlZ29yeSB8fCAnUmVzdG9yYW4nLFxyXG4gICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiByZXN0YXVyYW50LmRlc2NyaXB0aW9uIHx8ICcnLFxyXG4gICAgICAgICAgICAgIHJhdGluZzogcmVzdGF1cmFudC5yYXRpbmcgfHwgMCxcclxuICAgICAgICAgICAgICBwcmljZVJhbmdlOiByZXN0YXVyYW50LnByaWNlUmFuZ2UgfHwgJycsXHJcbiAgICAgICAgICAgICAgYWRkcmVzczogcmVzdGF1cmFudC5hZGRyZXNzIHx8ICcnXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCfwn5OmIFtUb2dnbGVGYXZvcml0ZV0gRmV0Y2hlZCByZXN0YXVyYW50IGRhdGE6JywgcmVzdERhdGEubmFtZSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBjYXRjaCAoZmV0Y2hFcnJvcikge1xyXG4gICAgICAgICAgY29uc29sZS5lcnJvcign4p2MIFtUb2dnbGVGYXZvcml0ZV0gRXJyb3IgZmV0Y2hpbmcgcmVzdGF1cmFudCBkYXRhOicsIGZldGNoRXJyb3IpO1xyXG4gICAgICAgICAgcmVzdERhdGEgPSB7XHJcbiAgICAgICAgICAgIG5hbWU6ICdSZXN0b3JhbicsXHJcbiAgICAgICAgICAgIHJlc3RhdXJhbnRJZDogcmVzdGF1cmFudElkXHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgYXdhaXQgc2V0RG9jKGZhdm9yaXRlUmVmLCB7XHJcbiAgICAgICAgdXNlcklkLFxyXG4gICAgICAgIHJlc3RhdXJhbnRJZCxcclxuICAgICAgICByZXN0YXVyYW50RGF0YTogcmVzdERhdGEsXHJcbiAgICAgICAgYWRkZWRBdDogc2VydmVyVGltZXN0YW1wKClcclxuICAgICAgfSk7XHJcbiAgICAgIFxyXG4gICAgICBjb25zb2xlLmxvZygn4pyFIFtUb2dnbGVGYXZvcml0ZV0gQWRkZWQgdG8gZmF2b3JpdGVzIHdpdGggZGF0YScpO1xyXG4gICAgICByZXR1cm4geyBcclxuICAgICAgICBzdWNjZXNzOiB0cnVlLCBcclxuICAgICAgICBhY3Rpb246ICdhZGRlZCcsXHJcbiAgICAgICAgbWVzc2FnZTogJ1Jlc3RvcmFuIGRpdGFtYmFoa2FuIGtlIGZhdm9yaXQnLFxyXG4gICAgICAgIGlzRmF2b3JpdGU6IHRydWVcclxuICAgICAgfTtcclxuICAgIH1cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcign4p2MIFtUb2dnbGVGYXZvcml0ZV0gRXJyb3I6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHsgXHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLCBcclxuICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UsXHJcbiAgICAgIGFjdGlvbjogJ2Vycm9yJ1xyXG4gICAgfTtcclxuICB9XHJcbn07XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09IE5PVElGSUNBVElPTlMgU1lTVEVNID09PT09PT09PT09PT09PT09PT09PVxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuZXhwb3J0IGNvbnN0IGNyZWF0ZU5vdGlmaWNhdGlvbiA9IGFzeW5jIChub3RpZmljYXRpb25EYXRhKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IG5vdGlmaWNhdGlvblJlZiA9IGF3YWl0IGFkZERvYyhjb2xsZWN0aW9uKGRiLCAnbm90aWZpY2F0aW9ucycpLCB7XHJcbiAgICAgIC4uLm5vdGlmaWNhdGlvbkRhdGEsXHJcbiAgICAgIGlzUmVhZDogZmFsc2UsXHJcbiAgICAgIGNyZWF0ZWRBdDogc2VydmVyVGltZXN0YW1wKCksXHJcbiAgICAgIHVwZGF0ZWRBdDogc2VydmVyVGltZXN0YW1wKClcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBub3RpZmljYXRpb25JZDogbm90aWZpY2F0aW9uUmVmLmlkIH07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIG5vdGlmaWNhdGlvbjonLCBlcnJvcik7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICB9XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgZ2V0T3duZXJOb3RpZmljYXRpb25zID0gKG93bmVySWQsIGNhbGxiYWNrKSA9PiB7XHJcbiAgaWYgKCFvd25lcklkKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdPd25lciBJRCBpcyByZXF1aXJlZCcpO1xyXG4gICAgY2FsbGJhY2soW10pO1xyXG4gICAgcmV0dXJuICgpID0+IHt9O1xyXG4gIH1cclxuXHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHEgPSBxdWVyeShcclxuICAgICAgY29sbGVjdGlvbihkYiwgJ25vdGlmaWNhdGlvbnMnKSxcclxuICAgICAgd2hlcmUoJ293bmVySWQnLCAnPT0nLCBvd25lcklkKSxcclxuICAgICAgb3JkZXJCeSgnY3JlYXRlZEF0JywgJ2Rlc2MnKVxyXG4gICAgKTtcclxuXHJcbiAgICBjb25zdCB1bnN1YnNjcmliZSA9IG9uU25hcHNob3QocSwgXHJcbiAgICAgIChxdWVyeVNuYXBzaG90KSA9PiB7XHJcbiAgICAgICAgY29uc3Qgbm90aWZpY2F0aW9ucyA9IFtdO1xyXG4gICAgICAgIHF1ZXJ5U25hcHNob3QuZm9yRWFjaCgoZG9jKSA9PiB7XHJcbiAgICAgICAgICBub3RpZmljYXRpb25zLnB1c2goeyBcclxuICAgICAgICAgICAgaWQ6IGRvYy5pZCwgXHJcbiAgICAgICAgICAgIC4uLmRvYy5kYXRhKCkgXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBjb25zb2xlLmxvZygnTm90aWZpY2F0aW9ucyBmZXRjaGVkOicsIG5vdGlmaWNhdGlvbnMubGVuZ3RoKTsgLy8gRGVidWcgbG9nXHJcbiAgICAgICAgY2FsbGJhY2sobm90aWZpY2F0aW9ucyk7XHJcbiAgICAgIH0sXHJcbiAgICAgIChlcnJvcikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIG5vdGlmaWNhdGlvbnM6JywgZXJyb3IpO1xyXG4gICAgICAgIGNhbGxiYWNrKFtdKTtcclxuICAgICAgfVxyXG4gICAgKTtcclxuXHJcbiAgICByZXR1cm4gdW5zdWJzY3JpYmU7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHNldHRpbmcgdXAgbm90aWZpY2F0aW9ucyBsaXN0ZW5lcjonLCBlcnJvcik7XHJcbiAgICBjYWxsYmFjayhbXSk7XHJcbiAgICByZXR1cm4gKCkgPT4ge307XHJcbiAgfVxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGdldFVucmVhZE5vdGlmaWNhdGlvbkNvdW50ID0gYXN5bmMgKG93bmVySWQpID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgcSA9IHF1ZXJ5KFxyXG4gICAgICBjb2xsZWN0aW9uKGRiLCAnbm90aWZpY2F0aW9ucycpLFxyXG4gICAgICB3aGVyZSgnb3duZXJJZCcsICc9PScsIG93bmVySWQpLFxyXG4gICAgICB3aGVyZSgnaXNSZWFkJywgJz09JywgZmFsc2UpXHJcbiAgICApO1xyXG5cclxuICAgIGNvbnN0IHF1ZXJ5U25hcHNob3QgPSBhd2FpdCBnZXREb2NzKHEpO1xyXG4gICAgcmV0dXJuIHsgXHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsIFxyXG4gICAgICBjb3VudDogcXVlcnlTbmFwc2hvdC5zaXplIFxyXG4gICAgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZ2V0dGluZyB1bnJlYWQgY291bnQ6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlLCBjb3VudDogMCB9O1xyXG4gIH1cclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBtYXJrTm90aWZpY2F0aW9uQXNSZWFkID0gYXN5bmMgKG5vdGlmaWNhdGlvbklkKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IG5vdGlmaWNhdGlvblJlZiA9IGRvYyhkYiwgJ25vdGlmaWNhdGlvbnMnLCBub3RpZmljYXRpb25JZCk7XHJcbiAgICBhd2FpdCB1cGRhdGVEb2Mobm90aWZpY2F0aW9uUmVmLCB7IGlzUmVhZDogdHJ1ZSB9KTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgbWFya2luZyBub3RpZmljYXRpb24gYXMgcmVhZDonLCBlcnJvcik7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICB9XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgbWFya0FsbE5vdGlmaWNhdGlvbnNBc1JlYWQgPSBhc3luYyAob3duZXJJZCkgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBxID0gcXVlcnkoXHJcbiAgICAgIGNvbGxlY3Rpb24oZGIsICdub3RpZmljYXRpb25zJyksXHJcbiAgICAgIHdoZXJlKCdvd25lcklkJywgJz09Jywgb3duZXJJZCksXHJcbiAgICAgIHdoZXJlKCdpc1JlYWQnLCAnPT0nLCBmYWxzZSlcclxuICAgICk7XHJcblxyXG4gICAgY29uc3QgcXVlcnlTbmFwc2hvdCA9IGF3YWl0IGdldERvY3MocSk7XHJcbiAgICBjb25zdCBiYXRjaCA9IHdyaXRlQmF0Y2goZGIpO1xyXG5cclxuICAgIHF1ZXJ5U25hcHNob3QuZm9yRWFjaCgoZG9jU25hcHNob3QpID0+IHtcclxuICAgICAgY29uc3Qgbm90aWZpY2F0aW9uUmVmID0gZG9jKGRiLCAnbm90aWZpY2F0aW9ucycsIGRvY1NuYXBzaG90LmlkKTtcclxuICAgICAgYmF0Y2gudXBkYXRlKG5vdGlmaWNhdGlvblJlZiwgeyBpc1JlYWQ6IHRydWUgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBhd2FpdCBiYXRjaC5jb21taXQoKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgbWFya2luZyBhbGwgbm90aWZpY2F0aW9ucyBhcyByZWFkOicsIGVycm9yKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gIH1cclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBjcmVhdGVSZXNlcnZhdGlvbiA9IGFzeW5jIChyZXNlcnZhdGlvbkRhdGEpID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgcmVzZXJ2YXRpb25SZWYgPSBhd2FpdCBhZGREb2MoY29sbGVjdGlvbihkYiwgJ3Jlc2VydmF0aW9ucycpLCB7XHJcbiAgICAgIC4uLnJlc2VydmF0aW9uRGF0YSxcclxuICAgICAgY3JlYXRlZEF0OiBzZXJ2ZXJUaW1lc3RhbXAoKSxcclxuICAgICAgdXBkYXRlZEF0OiBzZXJ2ZXJUaW1lc3RhbXAoKVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIGNvbnN0IHJlc2VydmF0aW9uSWQgPSByZXNlcnZhdGlvblJlZi5pZDtcclxuICAgIFxyXG4gICAgY29uc3QgcmVzdGF1cmFudFJlZiA9IGRvYyhkYiwgJ3Jlc3RhdXJhbnRzJywgcmVzZXJ2YXRpb25EYXRhLnJlc3RhdXJhbnRJZCk7XHJcbiAgICBjb25zdCByZXN0YXVyYW50RG9jID0gYXdhaXQgZ2V0RG9jKHJlc3RhdXJhbnRSZWYpO1xyXG4gICAgXHJcbiAgICBpZiAocmVzdGF1cmFudERvYy5leGlzdHMoKSkge1xyXG4gICAgICBjb25zdCByZXN0YXVyYW50ID0gcmVzdGF1cmFudERvYy5kYXRhKCk7XHJcbiAgICAgIFxyXG4gICAgICBhd2FpdCBjcmVhdGVOb3RpZmljYXRpb24oe1xyXG4gICAgICAgIHR5cGU6ICduZXdfcmVzZXJ2YXRpb24nLFxyXG4gICAgICAgIHRpdGxlOiAnUmVzZXJ2YXNpIEJhcnUnLFxyXG4gICAgICAgIG1lc3NhZ2U6IGAke3Jlc2VydmF0aW9uRGF0YS5jdXN0b21lck5hbWV9IG1lbWJ1YXQgcmVzZXJ2YXNpIHVudHVrICR7cmVzZXJ2YXRpb25EYXRhLmd1ZXN0Q291bnR9IG9yYW5nYCxcclxuICAgICAgICBvd25lcklkOiByZXN0YXVyYW50Lm93bmVySWQsXHJcbiAgICAgICAgcmVzdGF1cmFudElkOiByZXNlcnZhdGlvbkRhdGEucmVzdGF1cmFudElkLFxyXG4gICAgICAgIHJlc3RhdXJhbnROYW1lOiByZXN0YXVyYW50Lm5hbWUsXHJcbiAgICAgICAgcmVzZXJ2YXRpb25JZDogcmVzZXJ2YXRpb25JZCxcclxuICAgICAgICBjdXN0b21lck5hbWU6IHJlc2VydmF0aW9uRGF0YS5jdXN0b21lck5hbWUsXHJcbiAgICAgICAgZ3Vlc3RDb3VudDogcmVzZXJ2YXRpb25EYXRhLmd1ZXN0Q291bnQsXHJcbiAgICAgICAgZGF0ZTogcmVzZXJ2YXRpb25EYXRhLmRhdGUsXHJcbiAgICAgICAgdGltZTogcmVzZXJ2YXRpb25EYXRhLnRpbWUsXHJcbiAgICAgICAgc3RhdHVzOiAncGVuZGluZydcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIHJlc2VydmF0aW9uSWQgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgcmVzZXJ2YXRpb246JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgfVxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGRlbGV0ZU5vdGlmaWNhdGlvbiA9IGFzeW5jIChub3RpZmljYXRpb25JZCkgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBhd2FpdCBkZWxldGVEb2MoZG9jKGRiLCAnbm90aWZpY2F0aW9ucycsIG5vdGlmaWNhdGlvbklkKSk7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIG5vdGlmaWNhdGlvbjonLCBlcnJvcik7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICB9XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgZGVsZXRlQWxsT3duZXJOb3RpZmljYXRpb25zID0gYXN5bmMgKG93bmVySWQpID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgcSA9IHF1ZXJ5KFxyXG4gICAgICBjb2xsZWN0aW9uKGRiLCAnbm90aWZpY2F0aW9ucycpLFxyXG4gICAgICB3aGVyZSgnb3duZXJJZCcsICc9PScsIG93bmVySWQpXHJcbiAgICApO1xyXG5cclxuICAgIGNvbnN0IHNuYXBzaG90ID0gYXdhaXQgZ2V0RG9jcyhxKTtcclxuICAgIGNvbnN0IGJhdGNoID0gd3JpdGVCYXRjaChkYik7XHJcblxyXG4gICAgc25hcHNob3QuZm9yRWFjaChkb2MgPT4ge1xyXG4gICAgICBiYXRjaC5kZWxldGUoZG9jLnJlZik7XHJcbiAgICB9KTtcclxuXHJcbiAgICBhd2FpdCBiYXRjaC5jb21taXQoKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVsZXRpbmcgYWxsIG5vdGlmaWNhdGlvbnM6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgfVxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGdldFVzZXJOb3RpZmljYXRpb25zID0gKHVzZXJJZCwgY2FsbGJhY2spID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgcSA9IHF1ZXJ5KFxyXG4gICAgICBjb2xsZWN0aW9uKGRiLCBcIm5vdGlmaWNhdGlvbnNcIiksXHJcbiAgICAgIHdoZXJlKFwidXNlcklkXCIsIFwiPT1cIiwgdXNlcklkKSxcclxuICAgICAgb3JkZXJCeShcImNyZWF0ZWRBdFwiLCBcImRlc2NcIiksXHJcbiAgICAgIGxpbWl0KDUwKVxyXG4gICAgKTtcclxuXHJcbiAgICByZXR1cm4gb25TbmFwc2hvdChxLCAoc25hcHNob3QpID0+IHtcclxuICAgICAgY29uc3Qgbm90aWZpY2F0aW9ucyA9IHNuYXBzaG90LmRvY3MubWFwKChkKSA9PiAoeyBcclxuICAgICAgICBpZDogZC5pZCwgXHJcbiAgICAgICAgLi4uZC5kYXRhKCksXHJcbiAgICAgICAgY3JlYXRlZEF0OiBhc0RhdGUoZC5kYXRhKCkuY3JlYXRlZEF0KVxyXG4gICAgICB9KSk7XHJcbiAgICAgIGNhbGxiYWNrKG5vdGlmaWNhdGlvbnMpO1xyXG4gICAgfSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHNldHRpbmcgdXAgbm90aWZpY2F0aW9ucyBsaXN0ZW5lcjonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gKCkgPT4ge307XHJcbiAgfVxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGdldFVzZXJOb3RpZmljYXRpb25zT25jZSA9IGFzeW5jICh1c2VySWQpID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgcSA9IHF1ZXJ5KFxyXG4gICAgICBjb2xsZWN0aW9uKGRiLCAnbm90aWZpY2F0aW9ucycpLFxyXG4gICAgICB3aGVyZSgndXNlcklkJywgJz09JywgdXNlcklkKSxcclxuICAgICAgb3JkZXJCeSgnY3JlYXRlZEF0JywgJ2Rlc2MnKSxcclxuICAgICAgbGltaXQoNTApXHJcbiAgICApO1xyXG5cclxuICAgIGNvbnN0IHF1ZXJ5U25hcHNob3QgPSBhd2FpdCBnZXREb2NzKHEpO1xyXG4gICAgY29uc3Qgbm90aWZpY2F0aW9ucyA9IHF1ZXJ5U25hcHNob3QuZG9jcy5tYXAoZG9jID0+ICh7XHJcbiAgICAgIGlkOiBkb2MuaWQsXHJcbiAgICAgIC4uLmRvYy5kYXRhKCksXHJcbiAgICAgIGNyZWF0ZWRBdDogYXNEYXRlKGRvYy5kYXRhKCkuY3JlYXRlZEF0KVxyXG4gICAgfSkpO1xyXG5cclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IG5vdGlmaWNhdGlvbnMgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZ2V0dGluZyBub3RpZmljYXRpb25zOicsIGVycm9yKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSwgZGF0YTogW10gfTtcclxuICB9XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgZ2V0VW5yZWFkTm90aWZpY2F0aW9uc0NvdW50ID0gYXN5bmMgKHVzZXJJZCkgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBxID0gcXVlcnkoXHJcbiAgICAgIGNvbGxlY3Rpb24oZGIsICdub3RpZmljYXRpb25zJyksXHJcbiAgICAgIHdoZXJlKCd1c2VySWQnLCAnPT0nLCB1c2VySWQpLFxyXG4gICAgICB3aGVyZSgnaXNSZWFkJywgJz09JywgZmFsc2UpXHJcbiAgICApO1xyXG5cclxuICAgIGNvbnN0IHF1ZXJ5U25hcHNob3QgPSBhd2FpdCBnZXREb2NzKHEpO1xyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgY291bnQ6IHF1ZXJ5U25hcHNob3Quc2l6ZSB9O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZXR0aW5nIHVucmVhZCBjb3VudDonLCBlcnJvcik7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UsIGNvdW50OiAwIH07XHJcbiAgfVxyXG59O1xyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gUkVWSUVXUyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbmV4cG9ydCBjb25zdCBhZGRSZXZpZXcgPSBhc3luYyAocmV2aWV3RGF0YSkgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmxvZygn8J+UjSBbRmlyZXN0b3JlXSBhZGRSZXZpZXcgY2FsbGVkIHdpdGggZGF0YTonLCByZXZpZXdEYXRhKTtcclxuXHJcbiAgICBjb25zdCB2YWxpZGF0ZWREYXRhID0ge1xyXG4gICAgICByZXN0YXVyYW50SWQ6IHJldmlld0RhdGEucmVzdGF1cmFudElkIHx8ICcnLFxyXG4gICAgICByZXN0YXVyYW50TmFtZTogcmV2aWV3RGF0YS5yZXN0YXVyYW50TmFtZSB8fCAnUmVzdG9yYW4nLFxyXG4gICAgICByYXRpbmc6IE51bWJlcihyZXZpZXdEYXRhLnJhdGluZykgfHwgMCxcclxuICAgICAgY29tbWVudDogcmV2aWV3RGF0YS5jb21tZW50IHx8ICcnLFxyXG4gICAgICB1c2VySWQ6IHJldmlld0RhdGEudXNlcklkIHx8ICcnLFxyXG4gICAgICB1c2VyTmFtZTogcmV2aWV3RGF0YS51c2VyTmFtZSB8fCAnVXNlcicsXHJcbiAgICAgIHVzZXJFbWFpbDogcmV2aWV3RGF0YS51c2VyRW1haWwgfHwgJycsXHJcbiAgICAgIGNyZWF0ZWRBdDogc2VydmVyVGltZXN0YW1wKCksXHJcbiAgICAgIGhhc093bmVyUmVwbHk6IGZhbHNlLFxyXG4gICAgICBvd25lclJlcGx5OiAnJyxcclxuICAgICAgb3duZXJJZDogJycsXHJcbiAgICAgIG93bmVyTmFtZTogJycsXHJcbiAgICAgIHJlcGxpZWRBdDogbnVsbFxyXG4gICAgfTtcclxuXHJcbiAgICBjb25zb2xlLmxvZygn8J+UjSBbRmlyZXN0b3JlXSBWYWxpZGF0ZWQgZGF0YTonLCB2YWxpZGF0ZWREYXRhKTtcclxuXHJcbiAgICBpZiAoIXZhbGlkYXRlZERhdGEucmVzdGF1cmFudElkKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVzdGF1cmFudCBJRCBpcyByZXF1aXJlZCcpO1xyXG4gICAgfVxyXG4gICAgaWYgKCF2YWxpZGF0ZWREYXRhLnVzZXJJZCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1VzZXIgSUQgaXMgcmVxdWlyZWQnKTtcclxuICAgIH1cclxuICAgIGlmICh2YWxpZGF0ZWREYXRhLnJhdGluZyA9PT0gMCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JhdGluZyBpcyByZXF1aXJlZCcpO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHJldmlld1JlZiA9IGF3YWl0IGFkZERvYyhjb2xsZWN0aW9uKGRiLCAncmV2aWV3cycpLCB2YWxpZGF0ZWREYXRhKTtcclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coJ+KchSBbRmlyZXN0b3JlXSBSZXZpZXcgYmVyaGFzaWwgZGlidWF0IGRlbmdhbiBJRDonLCByZXZpZXdSZWYuaWQpO1xyXG4gICAgXHJcbiAgICAvLyBDcmVhdGUgb3duZXIgbm90aWZpY2F0aW9uIGZvciBuZXcgcmV2aWV3IChiZXN0LWVmZm9ydClcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHJlc3RJZCA9IHZhbGlkYXRlZERhdGEucmVzdGF1cmFudElkO1xyXG4gICAgICBpZiAocmVzdElkKSB7XHJcbiAgICAgICAgY29uc3QgcmVzdFNuYXAgPSBhd2FpdCBnZXREb2MoZG9jKGRiLCAncmVzdGF1cmFudHMnLCByZXN0SWQpKTtcclxuICAgICAgICBjb25zdCByZXN0YXVyYW50ID0gcmVzdFNuYXAuZXhpc3RzKCkgPyByZXN0U25hcC5kYXRhKCkgOiBudWxsO1xyXG4gICAgICAgIGNvbnN0IG93bmVySWQgPSByZXN0YXVyYW50Py5vd25lcklkO1xyXG4gICAgICAgIGlmIChvd25lcklkKSB7XHJcbiAgICAgICAgICBhd2FpdCBhZGREb2MoY29sbGVjdGlvbihkYiwgJ25vdGlmaWNhdGlvbnMnKSwge1xyXG4gICAgICAgICAgICBvd25lcklkLFxyXG4gICAgICAgICAgICB0eXBlOiAnbmV3X3JldmlldycsXHJcbiAgICAgICAgICAgIHRpdGxlOiAnVWxhc2FuIEJhcnUnLFxyXG4gICAgICAgICAgICBtZXNzYWdlOiBgJHt2YWxpZGF0ZWREYXRhLnVzZXJOYW1lIHx8ICdVc2VyJ30gbWVtYmVyaSByYXRpbmcgJHt2YWxpZGF0ZWREYXRhLnJhdGluZ30vNWAsXHJcbiAgICAgICAgICAgIHJlc3RhdXJhbnRJZDogcmVzdElkLFxyXG4gICAgICAgICAgICByZXN0YXVyYW50TmFtZTogcmVzdGF1cmFudD8ubmFtZSB8fCB2YWxpZGF0ZWREYXRhLnJlc3RhdXJhbnROYW1lLFxyXG4gICAgICAgICAgICByZXZpZXdJZDogcmV2aWV3UmVmLmlkLFxyXG4gICAgICAgICAgICByYXRpbmc6IHZhbGlkYXRlZERhdGEucmF0aW5nLFxyXG4gICAgICAgICAgICBpc1JlYWQ6IGZhbHNlLFxyXG4gICAgICAgICAgICBjcmVhdGVkQXQ6IHNlcnZlclRpbWVzdGFtcCgpLFxyXG4gICAgICAgICAgICB1cGRhdGVkQXQ6IHNlcnZlclRpbWVzdGFtcCgpLFxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChub3RpZnlFcnIpIHtcclxuICAgICAgY29uc29sZS5lcnJvcign4p2MIFtGaXJlc3RvcmVdIEVycm9yIGNyZWF0aW5nIHJldmlldyBub3RpZmljYXRpb246Jywgbm90aWZ5RXJyKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBSZWNhbGN1bGF0ZSByZXN0YXVyYW50IHJhdGluZyBzbyBsaXN0aW5nIGNhcmRzIHJlZmxlY3QgbmV3IHJldmlld1xyXG4gICAgdHJ5IHtcclxuICAgICAgYXdhaXQgdXBkYXRlUmVzdGF1cmFudFJhdGluZyh2YWxpZGF0ZWREYXRhLnJlc3RhdXJhbnRJZCk7XHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgIGNvbnNvbGUud2FybignRmFpbGVkIHRvIHVwZGF0ZSByZXN0YXVyYW50IHJhdGluZyBhZnRlciBhZGRSZXZpZXc6JywgZT8ubWVzc2FnZSB8fCBlKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBpZDogcmV2aWV3UmVmLmlkIH07XHJcbiAgICBcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcign4p2MIFtGaXJlc3RvcmVdIEVycm9yIGluIGFkZFJldmlldzonLCBlcnJvcik7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICB9XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgZ2V0UmVzdGF1cmFudFJldmlld3MgPSBhc3luYyAocmVzdGF1cmFudElkKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnNvbGUubG9nKCfwn5SNIFtGaXJlc3RvcmVdIGdldFJlc3RhdXJhbnRSZXZpZXdzIC0gRmV0Y2hpbmcgcmV2aWV3cyBmb3IgcmVzdGF1cmFudDonLCByZXN0YXVyYW50SWQpO1xyXG5cclxuICAgIGNvbnN0IHEgPSBxdWVyeShcclxuICAgICAgY29sbGVjdGlvbihkYiwgJ3Jldmlld3MnKSxcclxuICAgICAgd2hlcmUoJ3Jlc3RhdXJhbnRJZCcsICc9PScsIHJlc3RhdXJhbnRJZCksXHJcbiAgICAgIG9yZGVyQnkoJ2NyZWF0ZWRBdCcsICdkZXNjJylcclxuICAgICk7XHJcbiAgICBcclxuICAgIGNvbnN0IHF1ZXJ5U25hcHNob3QgPSBhd2FpdCBnZXREb2NzKHEpO1xyXG4gICAgY29uc29sZS5sb2coJ/CflI0gW0ZpcmVzdG9yZV0gZ2V0UmVzdGF1cmFudFJldmlld3MgLSBSYXcgcmV2aWV3cyBmb3VuZDonLCBxdWVyeVNuYXBzaG90LnNpemUpO1xyXG5cclxuICAgIGNvbnN0IHJldmlld3MgPSBbXTtcclxuXHJcbiAgICBxdWVyeVNuYXBzaG90LmZvckVhY2goZG9jID0+IHtcclxuICAgICAgY29uc3QgcmV2aWV3RGF0YSA9IGRvYy5kYXRhKCk7XHJcbiAgICAgIGNvbnN0IHJldmlldyA9IHtcclxuICAgICAgICBpZDogZG9jLmlkLFxyXG4gICAgICAgIC4uLnJldmlld0RhdGEsXHJcbiAgICAgICAgb3duZXJSZXBseTogcmV2aWV3RGF0YS5vd25lclJlcGx5IHx8IG51bGwsXHJcbiAgICAgICAgcmVwbGllZEF0OiByZXZpZXdEYXRhLnJlcGxpZWRBdCB8fCBudWxsLFxyXG4gICAgICAgIG93bmVyTmFtZTogcmV2aWV3RGF0YS5vd25lck5hbWUgfHwgbnVsbCxcclxuICAgICAgICBjcmVhdGVkQXQ6IGFzRGF0ZShyZXZpZXdEYXRhLmNyZWF0ZWRBdClcclxuICAgICAgfTtcclxuXHJcbiAgICAgIHJldmlld3MucHVzaChyZXZpZXcpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgY29uc29sZS5sb2coJ+KchSBbRmlyZXN0b3JlXSBnZXRSZXN0YXVyYW50UmV2aWV3cyAtIEZpbmFsIHJldmlld3M6JywgcmV2aWV3cy5sZW5ndGgpO1xyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogcmV2aWV3cyB9O1xyXG5cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcign4p2MIFtGaXJlc3RvcmVdIGdldFJlc3RhdXJhbnRSZXZpZXdzIC0gRXJyb3I6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgfVxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IHVwZGF0ZVJldmlld1JlcGx5ID0gYXN5bmMgKHJldmlld0lkLCByZXBseURhdGEpID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coJ/CflI0gW0ZpcmVzdG9yZV0gdXBkYXRlUmV2aWV3UmVwbHkgLSBVcGRhdGluZyByZXBseSBmb3IgcmV2aWV3OicsIHJldmlld0lkKTtcclxuICAgIFxyXG4gICAgYXdhaXQgdXBkYXRlRG9jKGRvYyhkYiwgJ3Jldmlld3MnLCByZXZpZXdJZCksIHtcclxuICAgICAgb3duZXJSZXBseTogcmVwbHlEYXRhLnJlcGx5LFxyXG4gICAgICBvd25lcklkOiByZXBseURhdGEub3duZXJJZCxcclxuICAgICAgb3duZXJOYW1lOiByZXBseURhdGEub3duZXJOYW1lLFxyXG4gICAgICByZXBsaWVkQXQ6IHNlcnZlclRpbWVzdGFtcCgpLFxyXG4gICAgICBoYXNPd25lclJlcGx5OiB0cnVlXHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coJ+KchSBbRmlyZXN0b3JlXSB1cGRhdGVSZXZpZXdSZXBseSAtIFJlcGx5IHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5Jyk7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBbRmlyZXN0b3JlXSB1cGRhdGVSZXZpZXdSZXBseSAtIEVycm9yOicsIGVycm9yKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gIH1cclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBnZXRPd25lclJlc3RhdXJhbnRzID0gYXN5bmMgKG93bmVySWQpID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgcSA9IHF1ZXJ5KFxyXG4gICAgICBjb2xsZWN0aW9uKGRiLCBcInJlc3RhdXJhbnRzXCIpLFxyXG4gICAgICB3aGVyZShcIm93bmVySWRcIiwgXCI9PVwiLCBvd25lcklkKVxyXG4gICAgKTtcclxuXHJcbiAgICBjb25zdCBzbmFwID0gYXdhaXQgZ2V0RG9jcyhxKTtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICBkYXRhOiBzbmFwLmRvY3MubWFwKGRvYyA9PiAoeyBpZDogZG9jLmlkLCAuLi5kb2MuZGF0YSgpIH0pKVxyXG4gICAgfTtcclxuXHJcbiAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVyci5tZXNzYWdlIH07XHJcbiAgfVxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGdldE93bmVyUmV2aWV3cyA9IGFzeW5jIChvd25lcklkKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnNvbGUubG9nKCfwn5SNIFtGaXJlc3RvcmVdIGdldE93bmVyUmV2aWV3cyAtIFN0YXJ0aW5nIGZvciBvd25lcjonLCBvd25lcklkKTtcclxuXHJcbiAgICBpZiAoIW93bmVySWQpIHtcclxuICAgICAgY29uc29sZS5lcnJvcign4p2MIFtGaXJlc3RvcmVdIE93bmVyIElEIGlzIHJlcXVpcmVkJyk7XHJcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ093bmVyIElEIGlzIHJlcXVpcmVkJyB9O1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHJlc3RhdXJhbnRzUXVlcnkgPSBxdWVyeShcclxuICAgICAgY29sbGVjdGlvbihkYiwgJ3Jlc3RhdXJhbnRzJyksXHJcbiAgICAgIHdoZXJlKCdvd25lcklkJywgJz09Jywgb3duZXJJZClcclxuICAgICk7XHJcbiAgICBjb25zdCByZXN0YXVyYW50c1NuYXBzaG90ID0gYXdhaXQgZ2V0RG9jcyhyZXN0YXVyYW50c1F1ZXJ5KTtcclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coJ/CflI0gW0ZpcmVzdG9yZV0gZ2V0T3duZXJSZXZpZXdzIC0gUmVzdGF1cmFudHMgZm91bmQ6JywgcmVzdGF1cmFudHNTbmFwc2hvdC5zaXplKTtcclxuICAgIFxyXG4gICAgaWYgKHJlc3RhdXJhbnRzU25hcHNob3QuZW1wdHkpIHtcclxuICAgICAgY29uc29sZS5sb2coJ+KaoO+4jyBbRmlyZXN0b3JlXSBObyByZXN0YXVyYW50cyBmb3VuZCBmb3IgdGhpcyBvd25lcicpO1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBbXSB9O1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHJlc3RhdXJhbnRJZHMgPSBbXTtcclxuICAgIGNvbnN0IHJlc3RhdXJhbnRNYXAgPSB7fTtcclxuICAgIFxyXG4gICAgcmVzdGF1cmFudHNTbmFwc2hvdC5mb3JFYWNoKGRvYyA9PiB7XHJcbiAgICAgIHJlc3RhdXJhbnRJZHMucHVzaChkb2MuaWQpO1xyXG4gICAgICByZXN0YXVyYW50TWFwW2RvYy5pZF0gPSBkb2MuZGF0YSgpLm5hbWU7XHJcbiAgICAgIGNvbnNvbGUubG9nKGDwn4+qIFtGaXJlc3RvcmVdIFJlc3RhdXJhbnQ6ICR7ZG9jLmlkfSAtICR7ZG9jLmRhdGEoKS5uYW1lfWApO1xyXG4gICAgfSk7XHJcblxyXG4gICAgY29uc29sZS5sb2coJ/CflI0gW0ZpcmVzdG9yZV0gUmVzdGF1cmFudCBJRHMgdG8gc2VhcmNoOicsIHJlc3RhdXJhbnRJZHMpO1xyXG5cclxuICAgIGNvbnN0IHJldmlld3NRdWVyeSA9IHF1ZXJ5KFxyXG4gICAgICBjb2xsZWN0aW9uKGRiLCAncmV2aWV3cycpLFxyXG4gICAgICBvcmRlckJ5KCdjcmVhdGVkQXQnLCAnZGVzYycpXHJcbiAgICApO1xyXG4gICAgXHJcbiAgICBjb25zdCByZXZpZXdzU25hcHNob3QgPSBhd2FpdCBnZXREb2NzKHJldmlld3NRdWVyeSk7XHJcbiAgICBjb25zb2xlLmxvZygn8J+UjSBbRmlyZXN0b3JlXSBUb3RhbCByZXZpZXdzIGluIGRhdGFiYXNlOicsIHJldmlld3NTbmFwc2hvdC5zaXplKTtcclxuXHJcbiAgICBjb25zdCByZXZpZXdzID0gW107XHJcblxyXG4gICAgcmV2aWV3c1NuYXBzaG90LmZvckVhY2goZG9jID0+IHtcclxuICAgICAgY29uc3QgcmV2aWV3RGF0YSA9IGRvYy5kYXRhKCk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAocmVzdGF1cmFudElkcy5pbmNsdWRlcyhyZXZpZXdEYXRhLnJlc3RhdXJhbnRJZCkpIHtcclxuICAgICAgICBjb25zdCByZXZpZXcgPSB7XHJcbiAgICAgICAgICBpZDogZG9jLmlkLFxyXG4gICAgICAgICAgLi4ucmV2aWV3RGF0YSxcclxuICAgICAgICAgIHJlc3RhdXJhbnROYW1lOiByZXN0YXVyYW50TWFwW3Jldmlld0RhdGEucmVzdGF1cmFudElkXSB8fCByZXZpZXdEYXRhLnJlc3RhdXJhbnROYW1lLFxyXG4gICAgICAgICAgY3JlYXRlZEF0OiBhc0RhdGUocmV2aWV3RGF0YS5jcmVhdGVkQXQpLFxyXG4gICAgICAgICAgcmVwbGllZEF0OiBhc0RhdGUocmV2aWV3RGF0YS5yZXBsaWVkQXQpXHJcbiAgICAgICAgfTtcclxuICAgICAgICBjb25zb2xlLmxvZygn4pyFIFtGaXJlc3RvcmVdIFJldmlldyBiZWxvbmdzIHRvIG93bmVyOicsIHJldmlldyk7XHJcbiAgICAgICAgcmV2aWV3cy5wdXNoKHJldmlldyk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGNvbnNvbGUubG9nKCfinIUgW0ZpcmVzdG9yZV0gZ2V0T3duZXJSZXZpZXdzIC0gRmluYWwgcmV2aWV3cyBmb3VuZDonLCByZXZpZXdzLmxlbmd0aCk7XHJcbiAgICBcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJldmlld3MgfTtcclxuXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBbRmlyZXN0b3JlXSBnZXRPd25lclJldmlld3MgLSBFcnJvcjonLCBlcnJvcik7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICB9XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgZ2V0VXNlclJldmlld3MgPSBhc3luYyAodXNlcklkKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnNvbGUubG9nKCfwn5SNIFtGaXJlc3RvcmVdIGdldFVzZXJSZXZpZXdzIC0gU3RhcnRpbmcgZm9yIHVzZXI6JywgdXNlcklkKTtcclxuXHJcbiAgICBpZiAoIXVzZXJJZCkge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCfinYwgW0ZpcmVzdG9yZV0gVXNlciBJRCBpcyByZXF1aXJlZCcpO1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdVc2VyIElEIGlzIHJlcXVpcmVkJyB9O1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHEgPSBxdWVyeShcclxuICAgICAgY29sbGVjdGlvbihkYiwgJ3Jldmlld3MnKSxcclxuICAgICAgd2hlcmUoJ3VzZXJJZCcsICc9PScsIHVzZXJJZCksXHJcbiAgICAgIG9yZGVyQnkoJ2NyZWF0ZWRBdCcsICdkZXNjJylcclxuICAgICk7XHJcbiAgICBcclxuICAgIGNvbnN0IHF1ZXJ5U25hcHNob3QgPSBhd2FpdCBnZXREb2NzKHEpO1xyXG4gICAgY29uc29sZS5sb2coJ/CflI0gW0ZpcmVzdG9yZV0gZ2V0VXNlclJldmlld3MgLSBSYXcgcmV2aWV3cyBmb3VuZDonLCBxdWVyeVNuYXBzaG90LnNpemUpO1xyXG5cclxuICAgIGNvbnN0IHJldmlld3MgPSBbXTtcclxuXHJcbiAgICBxdWVyeVNuYXBzaG90LmZvckVhY2goZG9jID0+IHtcclxuICAgICAgY29uc3QgcmV2aWV3RGF0YSA9IGRvYy5kYXRhKCk7XHJcbiAgICAgIGNvbnN0IHJldmlldyA9IHtcclxuICAgICAgICBpZDogZG9jLmlkLFxyXG4gICAgICAgIC4uLnJldmlld0RhdGEsXHJcbiAgICAgICAgb3duZXJSZXBseTogcmV2aWV3RGF0YS5vd25lclJlcGx5IHx8IG51bGwsXHJcbiAgICAgICAgcmVwbGllZEF0OiByZXZpZXdEYXRhLnJlcGxpZWRBdCB8fCBudWxsLFxyXG4gICAgICAgIGNyZWF0ZWRBdDogYXNEYXRlKHJldmlld0RhdGEuY3JlYXRlZEF0KVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgcmV2aWV3cy5wdXNoKHJldmlldyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zb2xlLmxvZygn4pyFIFtGaXJlc3RvcmVdIGdldFVzZXJSZXZpZXdzIC0gRmluYWwgcmV2aWV3cyBjb3VudDonLCByZXZpZXdzLmxlbmd0aCk7XHJcbiAgICBcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJldmlld3MgfTtcclxuXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBbRmlyZXN0b3JlXSBnZXRVc2VyUmV2aWV3cyAtIEVycm9yOicsIGVycm9yKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gIH1cclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCB1cGRhdGVSZXN0YXVyYW50UmF0aW5nID0gYXN5bmMgKHJlc3RhdXJhbnRJZCkgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmxvZyhg8J+UjSBbUmF0aW5nXSBTVEFSVDogVXBkYXRpbmcgcmF0aW5nIGZvciByZXN0YXVyYW50OiAke3Jlc3RhdXJhbnRJZH1gKTtcclxuICAgIFxyXG4gICAgY29uc3QgcmVzdGF1cmFudFJlZiA9IGRvYyhkYiwgJ3Jlc3RhdXJhbnRzJywgcmVzdGF1cmFudElkKTtcclxuICAgIGNvbnN0IHJlc3RhdXJhbnRTbmFwID0gYXdhaXQgZ2V0RG9jKHJlc3RhdXJhbnRSZWYpO1xyXG4gICAgY29uc3QgcmVzdGF1cmFudE5hbWUgPSByZXN0YXVyYW50U25hcC5leGlzdHMoKSA/IHJlc3RhdXJhbnRTbmFwLmRhdGEoKS5uYW1lIDogJ1Vua25vd24nO1xyXG4gICAgXHJcbiAgICBjb25zb2xlLmxvZyhg8J+TiyBbUmF0aW5nXSBSZXN0YXVyYW50OiAke3Jlc3RhdXJhbnROYW1lfSAoJHtyZXN0YXVyYW50SWR9KWApO1xyXG4gICAgXHJcbiAgICBjb25zdCByZXZpZXdzUmVmID0gY29sbGVjdGlvbihkYiwgJ3Jldmlld3MnKTtcclxuICAgIGNvbnN0IHEgPSBxdWVyeShyZXZpZXdzUmVmLCB3aGVyZSgncmVzdGF1cmFudElkJywgJz09JywgcmVzdGF1cmFudElkKSk7XHJcbiAgICBjb25zdCBxdWVyeVNuYXBzaG90ID0gYXdhaXQgZ2V0RG9jcyhxKTtcclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coYPCfk4ogW1JhdGluZ10gRm91bmQgJHtxdWVyeVNuYXBzaG90LnNpemV9IHRvdGFsIHJldmlldyBkb2N1bWVudHNgKTtcclxuICAgIFxyXG4gICAgaWYgKHF1ZXJ5U25hcHNob3QuZW1wdHkpIHtcclxuICAgICAgY29uc29sZS5sb2coYOKdjCBbUmF0aW5nXSBObyByZXZpZXdzIGZvdW5kLCBzZXR0aW5nIHRvIDBgKTtcclxuICAgICAgYXdhaXQgdXBkYXRlRG9jKHJlc3RhdXJhbnRSZWYsIHtcclxuICAgICAgICByYXRpbmc6IDAsXHJcbiAgICAgICAgcmV2aWV3Q291bnQ6IDAsXHJcbiAgICAgICAgbGFzdFJhdGluZ1VwZGF0ZTogc2VydmVyVGltZXN0YW1wKClcclxuICAgICAgfSk7XHJcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIHJhdGluZzogMCwgY291bnQ6IDAgfTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgbGV0IHRvdGFsUmF0aW5nID0gMDtcclxuICAgIGxldCByZXZpZXdDb3VudCA9IDA7XHJcbiAgICBcclxuICAgIHF1ZXJ5U25hcHNob3QuZm9yRWFjaCgoZG9jKSA9PiB7XHJcbiAgICAgIGNvbnN0IHJldmlldyA9IGRvYy5kYXRhKCk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAocmV2aWV3LnJhdGluZyAmJiByZXZpZXcucmF0aW5nID4gMCkge1xyXG4gICAgICAgIHRvdGFsUmF0aW5nICs9IHJldmlldy5yYXRpbmc7XHJcbiAgICAgICAgcmV2aWV3Q291bnQrKztcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIGNvbnN0IGF2ZXJhZ2VSYXRpbmcgPSByZXZpZXdDb3VudCA+IDAgPyB0b3RhbFJhdGluZyAvIHJldmlld0NvdW50IDogMDtcclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coYPCfp64gW1JhdGluZ10gQ2FsY3VsYXRpb246YCk7XHJcbiAgICBjb25zb2xlLmxvZyhgICAgLSBWYWxpZCByZXZpZXdzOiAke3Jldmlld0NvdW50fS8ke3F1ZXJ5U25hcHNob3Quc2l6ZX1gKTtcclxuICAgIGNvbnNvbGUubG9nKGAgICAtIFRvdGFsIHJhdGluZzogJHt0b3RhbFJhdGluZ31gKTtcclxuICAgIGNvbnNvbGUubG9nKGAgICAtIEF2ZXJhZ2U6ICR7YXZlcmFnZVJhdGluZy50b0ZpeGVkKDEpfWApO1xyXG4gICAgXHJcbiAgICBjb25zb2xlLmxvZyhg8J+SviBbUmF0aW5nXSBVcGRhdGluZyByZXN0YXVyYW50IGRvY3VtZW50Li4uYCk7XHJcbiAgICBhd2FpdCB1cGRhdGVEb2MocmVzdGF1cmFudFJlZiwge1xyXG4gICAgICByYXRpbmc6IE51bWJlcihhdmVyYWdlUmF0aW5nLnRvRml4ZWQoMSkpLFxyXG4gICAgICByZXZpZXdDb3VudDogcmV2aWV3Q291bnQsXHJcbiAgICAgIGxhc3RSYXRpbmdVcGRhdGU6IHNlcnZlclRpbWVzdGFtcCgpXHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgY29uc29sZS5sb2coYOKchSBbUmF0aW5nXSBTVUNDRVNTOiBVcGRhdGVkICR7cmVzdGF1cmFudE5hbWV9IHRvIHJhdGluZyAke2F2ZXJhZ2VSYXRpbmcudG9GaXhlZCgxKX0gKCR7cmV2aWV3Q291bnR9IHJldmlld3MpYCk7XHJcbiAgICBcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgIHJhdGluZzogYXZlcmFnZVJhdGluZyxcclxuICAgICAgcmV2aWV3Q291bnQ6IHJldmlld0NvdW50XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBbUmF0aW5nXSBFUlJPUjonLCBlcnJvcik7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICB9XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgdXBkYXRlVXNlclJvbGUgPSBhc3luYyAodXNlcklkLCBuZXdSb2xlKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHVzZXJSZWYgPSBkb2MoZGIsICd1c2VycycsIHVzZXJJZCk7XHJcbiAgICBhd2FpdCB1cGRhdGVEb2ModXNlclJlZiwge1xyXG4gICAgICByb2xlOiBuZXdSb2xlLFxyXG4gICAgICB1cGRhdGVkQXQ6IHNlcnZlclRpbWVzdGFtcCgpXHJcbiAgICB9KTtcclxuICAgIGNvbnNvbGUubG9nKGBVc2VyICR7dXNlcklkfSByb2xlIGNoYW5nZWQgdG8gJHtuZXdSb2xlfWApO1xyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIHVzZXIgcm9sZTonLCBlcnJvcik7XHJcbiAgICB0aHJvdyBlcnJvcjtcclxuICB9XHJcbn07XHJcblxyXG4vLyBGdW5nc2kgdW50dWsgbWVuZGFwYXRrYW4gc2VtdWEgcmVwb3J0c1xyXG4vLyAoUmVtb3ZlZCBkdXBsaWNhdGUgZ2V0UmVwb3J0czsgc2VlIGNvbnNvbGlkYXRlZCB2ZXJzaW9uIGJlbG93IHRoYXQgaW5jbHVkZXMgcmV2aWV3SWQgZmlsdGVyIGFuZCB0aW1lc3RhbXAgbm9ybWFsaXphdGlvbilcclxuXHJcbi8vIEZ1bmdzaSB1bnR1ayBtZW5hbmdndWhrYW4gYWt1biB1c2VyXHJcbmV4cG9ydCBjb25zdCBzdXNwZW5kVXNlckFjY291bnQgPSBhc3luYyAodXNlcklkLCByZWFzb24pID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgdXNlclJlZiA9IGRvYyhkYiwgJ3VzZXJzJywgdXNlcklkKTtcclxuICAgIFxyXG4gICAgLy8gVXBkYXRlIHN0YXR1cyB1c2VyXHJcbiAgICBhd2FpdCB1cGRhdGVEb2ModXNlclJlZiwge1xyXG4gICAgICBzdGF0dXM6ICdzdXNwZW5kZWQnLFxyXG4gICAgICBzdXNwZW5zaW9uUmVhc29uOiByZWFzb24sXHJcbiAgICAgIHN1c3BlbmRlZEF0OiBzZXJ2ZXJUaW1lc3RhbXAoKVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8vIExvZyB0aGUgc3VzcGVuc2lvblxyXG4gICAgYXdhaXQgYWRkRG9jKGNvbGxlY3Rpb24oZGIsICdzdXNwZW5zaW9uX2xvZ3MnKSwge1xyXG4gICAgICB1c2VySWQsXHJcbiAgICAgIHJlYXNvbixcclxuICAgICAgYWN0aW9uQnk6ICdhZG1pbicsXHJcbiAgICAgIGFjdGlvblR5cGU6ICdzdXNwZW5kJyxcclxuICAgICAgY3JlYXRlZEF0OiBzZXJ2ZXJUaW1lc3RhbXAoKVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3Igc3VzcGVuZGluZyB1c2VyOicsIGVycm9yKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gIH1cclxufTtcclxuXHJcbi8vIEZ1bmdzaSB1bnR1ayBtZW5hbmdndWhrYW4gcmVzdG9yYW5cclxuZXhwb3J0IGNvbnN0IHN1c3BlbmRSZXN0YXVyYW50QWNjb3VudCA9IGFzeW5jIChyZXN0YXVyYW50SWQsIHJlYXNvbikgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCByZXN0YXVyYW50UmVmID0gZG9jKGRiLCAncmVzdGF1cmFudHMnLCByZXN0YXVyYW50SWQpO1xyXG4gICAgXHJcbiAgICAvLyBVcGRhdGUgc3RhdHVzIHJlc3RvcmFuXHJcbiAgICBhd2FpdCB1cGRhdGVEb2MocmVzdGF1cmFudFJlZiwge1xyXG4gICAgICBzdGF0dXM6ICdzdXNwZW5kZWQnLFxyXG4gICAgICBzdXNwZW5zaW9uUmVhc29uOiByZWFzb24sXHJcbiAgICAgIHN1c3BlbmRlZEF0OiBzZXJ2ZXJUaW1lc3RhbXAoKVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8vIExvZyB0aGUgc3VzcGVuc2lvblxyXG4gICAgYXdhaXQgYWRkRG9jKGNvbGxlY3Rpb24oZGIsICdzdXNwZW5zaW9uX2xvZ3MnKSwge1xyXG4gICAgICByZXN0YXVyYW50SWQsXHJcbiAgICAgIHJlYXNvbixcclxuICAgICAgYWN0aW9uQnk6ICdhZG1pbicsXHJcbiAgICAgIGFjdGlvblR5cGU6ICdzdXNwZW5kJyxcclxuICAgICAgY3JlYXRlZEF0OiBzZXJ2ZXJUaW1lc3RhbXAoKVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3Igc3VzcGVuZGluZyByZXN0YXVyYW50OicsIGVycm9yKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gIH1cclxufTtcclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PSBSRUFMLVRJTUUgUkVTRVJWQVRJT05TID09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5leHBvcnQgY29uc3Qgc3Vic2NyaWJlVG9SZXN0YXVyYW50UmVzZXJ2YXRpb25zID0gKHJlc3RhdXJhbnRJZCwgY2FsbGJhY2spID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgcSA9IHF1ZXJ5KFxyXG4gICAgICBjb2xsZWN0aW9uKGRiLCAncmVzZXJ2YXRpb25zJyksXHJcbiAgICAgIHdoZXJlKCdyZXN0YXVyYW50SWQnLCAnPT0nLCByZXN0YXVyYW50SWQpLFxyXG4gICAgICBvcmRlckJ5KCdjcmVhdGVkQXQnLCAnZGVzYycpXHJcbiAgICApO1xyXG5cclxuICAgIHJldHVybiBvblNuYXBzaG90KHEsIChxdWVyeVNuYXBzaG90KSA9PiB7XHJcbiAgICAgIGNvbnN0IHJlc2VydmF0aW9ucyA9IFtdO1xyXG4gICAgICBxdWVyeVNuYXBzaG90LmZvckVhY2goKGRvYykgPT4ge1xyXG4gICAgICAgIHJlc2VydmF0aW9ucy5wdXNoKHsgXHJcbiAgICAgICAgICBpZDogZG9jLmlkLCBcclxuICAgICAgICAgIC4uLmRvYy5kYXRhKCksXHJcbiAgICAgICAgICBjcmVhdGVkQXQ6IGFzRGF0ZShkb2MuZGF0YSgpLmNyZWF0ZWRBdCksXHJcbiAgICAgICAgICBkYXRlOiBhc0RhdGUoZG9jLmRhdGEoKS5kYXRlKVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgICAgY2FsbGJhY2socmVzZXJ2YXRpb25zKTtcclxuICAgIH0pO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCfinYwgW0ZpcmVzdG9yZV0gRXJyb3IgaW4gc3Vic2NyaWJlVG9SZXN0YXVyYW50UmVzZXJ2YXRpb25zOicsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufTtcclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gTUVOVSA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbmV4cG9ydCBjb25zdCBjcmVhdGVNZW51ID0gYXN5bmMgKG1lbnVEYXRhKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGRvY1JlZiA9IGF3YWl0IGFkZERvYyhjb2xsZWN0aW9uKGRiLCAnbWVudXMnKSwge1xyXG4gICAgICAuLi5tZW51RGF0YSxcclxuICAgICAgY3JlYXRlZEF0OiBzZXJ2ZXJUaW1lc3RhbXAoKSxcclxuICAgICAgdXBkYXRlZEF0OiBzZXJ2ZXJUaW1lc3RhbXAoKVxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gZG9jUmVmLmlkO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCfinYwgW0ZpcmVzdG9yZV0gRXJyb3IgY3JlYXRpbmcgbWVudTonLCBlcnJvcik7XHJcbiAgICB0aHJvdyBlcnJvcjtcclxuICB9XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgZ2V0TWVudXNCeVJlc3RhdXJhbnQgPSBhc3luYyAocmVzdGF1cmFudElkKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHEgPSBxdWVyeShcclxuICAgICAgY29sbGVjdGlvbihkYiwgJ21lbnVzJyksXHJcbiAgICAgIHdoZXJlKCdyZXN0YXVyYW50SWQnLCAnPT0nLCByZXN0YXVyYW50SWQpLFxyXG4gICAgICBvcmRlckJ5KCdjcmVhdGVkQXQnLCAnZGVzYycpXHJcbiAgICApO1xyXG4gICAgY29uc3QgcXVlcnlTbmFwc2hvdCA9IGF3YWl0IGdldERvY3MocSk7XHJcbiAgICBjb25zdCBtZW51cyA9IFtdO1xyXG4gICAgcXVlcnlTbmFwc2hvdC5mb3JFYWNoKChkb2MpID0+IHtcclxuICAgICAgbWVudXMucHVzaCh7IFxyXG4gICAgICAgIGlkOiBkb2MuaWQsIFxyXG4gICAgICAgIC4uLmRvYy5kYXRhKCksXHJcbiAgICAgICAgY3JlYXRlZEF0OiBhc0RhdGUoZG9jLmRhdGEoKS5jcmVhdGVkQXQpXHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gbWVudXM7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBbRmlyZXN0b3JlXSBFcnJvciBnZXR0aW5nIG1lbnVzOicsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCB1cGRhdGVNZW51ID0gYXN5bmMgKG1lbnVJZCwgbWVudURhdGEpID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgbWVudVJlZiA9IGRvYyhkYiwgJ21lbnVzJywgbWVudUlkKTtcclxuICAgIGF3YWl0IHVwZGF0ZURvYyhtZW51UmVmLCB7XHJcbiAgICAgIC4uLm1lbnVEYXRhLFxyXG4gICAgICB1cGRhdGVkQXQ6IHNlcnZlclRpbWVzdGFtcCgpXHJcbiAgICB9KTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcign4p2MIFtGaXJlc3RvcmVdIEVycm9yIHVwZGF0aW5nIG1lbnU6JywgZXJyb3IpO1xyXG4gICAgdGhyb3cgZXJyb3I7XHJcbiAgfVxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGRlbGV0ZU1lbnUgPSBhc3luYyAobWVudUlkKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IG1lbnVSZWYgPSBkb2MoZGIsICdtZW51cycsIG1lbnVJZCk7XHJcbiAgICBhd2FpdCBkZWxldGVEb2MobWVudVJlZik7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBbRmlyZXN0b3JlXSBFcnJvciBkZWxldGluZyBtZW51OicsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBnZXRNZW51QnlJZCA9IGFzeW5jIChtZW51SWQpID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgbWVudVJlZiA9IGRvYyhkYiwgJ21lbnVzJywgbWVudUlkKTtcclxuICAgIGNvbnN0IG1lbnVTbmFwID0gYXdhaXQgZ2V0RG9jKG1lbnVSZWYpO1xyXG5cclxuICAgIGlmIChtZW51U25hcC5leGlzdHMoKSkge1xyXG4gICAgICByZXR1cm4geyBpZDogbWVudVNuYXAuaWQsIC4uLm1lbnVTbmFwLmRhdGEoKSB9O1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNZW51IHRpZGFrIGRpdGVtdWthbicpO1xyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCfinYwgW0ZpcmVzdG9yZV0gRXJyb3IgZ2V0dGluZyBtZW51OicsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufTtcclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gUFJPTU9TID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5leHBvcnQgY29uc3QgZ2V0UHJvbW9zQnlSZXN0YXVyYW50SWQgPSBhc3luYyAocmVzdGF1cmFudElkKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHByb21vc1JlZiA9IGNvbGxlY3Rpb24oZGIsICdwcm9tb3MnKTtcclxuICAgIGNvbnN0IHEgPSBxdWVyeShcclxuICAgICAgcHJvbW9zUmVmLFxyXG4gICAgICB3aGVyZSgncmVzdGF1cmFudElkJywgJz09JywgcmVzdGF1cmFudElkKSxcclxuICAgICAgb3JkZXJCeSgnY3JlYXRlZEF0JywgJ2Rlc2MnKVxyXG4gICAgKTtcclxuXHJcbiAgICBjb25zdCBxdWVyeVNuYXBzaG90ID0gYXdhaXQgZ2V0RG9jcyhxKTtcclxuICAgIGNvbnN0IHByb21vcyA9IFtdO1xyXG5cclxuICAgIHF1ZXJ5U25hcHNob3QuZm9yRWFjaCgoZG9jKSA9PiB7XHJcbiAgICAgIHByb21vcy5wdXNoKHtcclxuICAgICAgICBpZDogZG9jLmlkLFxyXG4gICAgICAgIC4uLmRvYy5kYXRhKCksXHJcbiAgICAgICAgY3JlYXRlZEF0OiBhc0RhdGUoZG9jLmRhdGEoKS5jcmVhdGVkQXQpLFxyXG4gICAgICAgIHN0YXJ0RGF0ZTogYXNEYXRlKGRvYy5kYXRhKCkuc3RhcnREYXRlKSxcclxuICAgICAgICBlbmREYXRlOiBhc0RhdGUoZG9jLmRhdGEoKS5lbmREYXRlKVxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBwcm9tb3M7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBbRmlyZXN0b3JlXSBFcnJvciBnZXR0aW5nIHByb21vczonLCBlcnJvcik7XHJcbiAgICB0aHJvdyBlcnJvcjtcclxuICB9XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgdXBkYXRlUHJvbW8gPSBhc3luYyAocHJvbW9JZCwgcHJvbW9EYXRhKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHByb21vUmVmID0gZG9jKGRiLCAncHJvbW9zJywgcHJvbW9JZCk7XHJcbiAgICBhd2FpdCB1cGRhdGVEb2MocHJvbW9SZWYsIHtcclxuICAgICAgLi4ucHJvbW9EYXRhLFxyXG4gICAgICB1cGRhdGVkQXQ6IHNlcnZlclRpbWVzdGFtcCgpXHJcbiAgICB9KTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcign4p2MIFtGaXJlc3RvcmVdIEVycm9yIHVwZGF0aW5nIHByb21vOicsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBkZWxldGVQcm9tbyA9IGFzeW5jIChwcm9tb0lkKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHByb21vUmVmID0gZG9jKGRiLCAncHJvbW9zJywgcHJvbW9JZCk7XHJcbiAgICBhd2FpdCBkZWxldGVEb2MocHJvbW9SZWYpO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCfinYwgW0ZpcmVzdG9yZV0gRXJyb3IgZGVsZXRpbmcgcHJvbW86JywgZXJyb3IpO1xyXG4gICAgdGhyb3cgZXJyb3I7XHJcbiAgfVxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGdldFByb21vQnlJZCA9IGFzeW5jIChwcm9tb0lkKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHByb21vUmVmID0gZG9jKGRiLCAncHJvbW9zJywgcHJvbW9JZCk7XHJcbiAgICBjb25zdCBwcm9tb1NuYXAgPSBhd2FpdCBnZXREb2MocHJvbW9SZWYpO1xyXG5cclxuICAgIGlmIChwcm9tb1NuYXAuZXhpc3RzKCkpIHtcclxuICAgICAgcmV0dXJuIHsgaWQ6IHByb21vU25hcC5pZCwgLi4ucHJvbW9TbmFwLmRhdGEoKSB9O1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdQcm9tbyB0aWRhayBkaXRlbXVrYW4nKTtcclxuICAgIH1cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcign4p2MIFtGaXJlc3RvcmVdIEVycm9yIGdldHRpbmcgcHJvbW86JywgZXJyb3IpO1xyXG4gICAgdGhyb3cgZXJyb3I7XHJcbiAgfVxyXG59O1xyXG5cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PSBSRVNUQVVSQU5UIFNUQVRVUyA9PT09PT09PT09PT09PT09PT09PT09PT1cclxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cclxuXHJcbmV4cG9ydCBjb25zdCB1cGRhdGVSZXN0YXVyYW50T3BlblN0YXR1cyA9IGFzeW5jIChyZXN0YXVyYW50SWQsIGlzT3BlbikgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCByZXN0YXVyYW50UmVmID0gZG9jKGRiLCAncmVzdGF1cmFudHMnLCByZXN0YXVyYW50SWQpO1xyXG4gICAgYXdhaXQgdXBkYXRlRG9jKHJlc3RhdXJhbnRSZWYsIHtcclxuICAgICAgaXNPcGVuLFxyXG4gICAgICB1cGRhdGVkQXQ6IHNlcnZlclRpbWVzdGFtcCgpXHJcbiAgICB9KTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcign4p2MIFtGaXJlc3RvcmVdIEVycm9yIHVwZGF0aW5nIHJlc3RhdXJhbnQgc3RhdHVzOicsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufTtcclxuXHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT0gREFTSEJPQVJEIFNUQVRTID09PT09PT09PT09PT09PT09PT09PT09PT09XHJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XHJcblxyXG5leHBvcnQgY29uc3QgZ2V0RGFzaGJvYXJkU3RhdHMgPSBhc3luYyAob3duZXJJZCkgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCByZXN0YXVyYW50cyA9IGF3YWl0IGdldFJlc3RhdXJhbnRzQnlPd25lcihvd25lcklkKTtcclxuICAgIGxldCB0b3RhbFBlbmRpbmdSZXNlcnZhdGlvbnMgPSAwO1xyXG4gICAgbGV0IHRvdGFsVG9kYXlSZXNlcnZhdGlvbnMgPSAwO1xyXG5cclxuICAgIGZvciAoY29uc3QgcmVzdGF1cmFudCBvZiByZXN0YXVyYW50cykge1xyXG4gICAgICBjb25zdCByZXNlcnZhdGlvbnMgPSBhd2FpdCBnZXRSZXN0YXVyYW50UmVzZXJ2YXRpb25zKHJlc3RhdXJhbnQuaWQpO1xyXG4gICAgICB0b3RhbFBlbmRpbmdSZXNlcnZhdGlvbnMgKz0gcmVzZXJ2YXRpb25zLmZpbHRlcihyID0+IHIuc3RhdHVzID09PSAncGVuZGluZycpLmxlbmd0aDtcclxuICAgICAgXHJcbiAgICAgIGNvbnN0IHRvZGF5ID0gbmV3IERhdGUoKS50b0RhdGVTdHJpbmcoKTtcclxuICAgICAgdG90YWxUb2RheVJlc2VydmF0aW9ucyArPSByZXNlcnZhdGlvbnMuZmlsdGVyKHIgPT4ge1xyXG4gICAgICAgIGNvbnN0IHJlc2VydmF0aW9uRGF0ZSA9IG5ldyBEYXRlKHIuZGF0ZSkudG9EYXRlU3RyaW5nKCk7XHJcbiAgICAgICAgcmV0dXJuIHJlc2VydmF0aW9uRGF0ZSA9PT0gdG9kYXk7XHJcbiAgICAgIH0pLmxlbmd0aDtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICB0b3RhbFJlc3RhdXJhbnRzOiByZXN0YXVyYW50cy5sZW5ndGgsXHJcbiAgICAgIHRvdGFsUGVuZGluZ1Jlc2VydmF0aW9ucyxcclxuICAgICAgdG90YWxUb2RheVJlc2VydmF0aW9uc1xyXG4gICAgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcign4p2MIFtGaXJlc3RvcmVdIEVycm9yIGdldHRpbmcgZGFzaGJvYXJkIHN0YXRzOicsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBnZXRSZXN0YXVyYW50UmV2aWV3c1N1bW1hcnkgPSBhc3luYyAocmVzdGF1cmFudElkKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHEgPSBxdWVyeShcclxuICAgICAgY29sbGVjdGlvbihkYiwgJ3Jldmlld3MnKSxcclxuICAgICAgd2hlcmUoJ3Jlc3RhdXJhbnRJZCcsICc9PScsIHJlc3RhdXJhbnRJZClcclxuICAgICk7XHJcbiAgICBcclxuICAgIGNvbnN0IHF1ZXJ5U25hcHNob3QgPSBhd2FpdCBnZXREb2NzKHEpO1xyXG4gICAgXHJcbiAgICBpZiAocXVlcnlTbmFwc2hvdC5lbXB0eSkge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGF2ZXJhZ2VSYXRpbmc6IDAsXHJcbiAgICAgICAgcmV2aWV3Q291bnQ6IDAsXHJcbiAgICAgICAgdG90YWxSYXRpbmc6IDBcclxuICAgICAgfTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgbGV0IHRvdGFsUmF0aW5nID0gMDtcclxuICAgIGNvbnN0IHJldmlld3MgPSBbXTtcclxuICAgIFxyXG4gICAgcXVlcnlTbmFwc2hvdC5mb3JFYWNoKChkb2MpID0+IHtcclxuICAgICAgY29uc3QgcmV2aWV3RGF0YSA9IGRvYy5kYXRhKCk7XHJcbiAgICAgIHJldmlld3MucHVzaCh7IGlkOiBkb2MuaWQsIC4uLnJldmlld0RhdGEgfSk7XHJcbiAgICAgIHRvdGFsUmF0aW5nICs9IHJldmlld0RhdGEucmF0aW5nIHx8IDA7XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgY29uc3QgcmV2aWV3Q291bnQgPSByZXZpZXdzLmxlbmd0aDtcclxuICAgIGNvbnN0IGF2ZXJhZ2VSYXRpbmcgPSByZXZpZXdDb3VudCA+IDAgPyB0b3RhbFJhdGluZyAvIHJldmlld0NvdW50IDogMDtcclxuICAgIFxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgYXZlcmFnZVJhdGluZyxcclxuICAgICAgcmV2aWV3Q291bnQsXHJcbiAgICAgIHRvdGFsUmF0aW5nLFxyXG4gICAgICByZXZpZXdzXHJcbiAgICB9O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZXR0aW5nIHJlc3RhdXJhbnQgcmV2aWV3cyBzdW1tYXJ5OicsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBzeW5jUmVzdGF1cmFudFJhdGluZyA9IGFzeW5jIChyZXN0YXVyYW50SWQpID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgcmV2aWV3c1JlZiA9IGNvbGxlY3Rpb24oZGIsICdyZXZpZXdzJyk7XHJcbiAgICBjb25zdCBxID0gcXVlcnkocmV2aWV3c1JlZiwgd2hlcmUoJ3Jlc3RhdXJhbnRJZCcsICc9PScsIHJlc3RhdXJhbnRJZCkpO1xyXG4gICAgY29uc3QgcXVlcnlTbmFwc2hvdCA9IGF3YWl0IGdldERvY3MocSk7XHJcbiAgICBcclxuICAgIGNvbnN0IHJldmlld0NvdW50ID0gcXVlcnlTbmFwc2hvdC5zaXplO1xyXG4gICAgbGV0IHRvdGFsUmF0aW5nID0gMDtcclxuICAgIFxyXG4gICAgcXVlcnlTbmFwc2hvdC5mb3JFYWNoKChkb2MpID0+IHtcclxuICAgICAgY29uc3QgcmV2aWV3ID0gZG9jLmRhdGEoKTtcclxuICAgICAgaWYgKHJldmlldy5yYXRpbmcgJiYgcmV2aWV3LnJhdGluZyA+IDApIHtcclxuICAgICAgICB0b3RhbFJhdGluZyArPSByZXZpZXcucmF0aW5nO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgY29uc3QgYXZlcmFnZVJhdGluZyA9IHJldmlld0NvdW50ID4gMCA/IHRvdGFsUmF0aW5nIC8gcmV2aWV3Q291bnQgOiAwO1xyXG4gICAgXHJcbiAgICBjb25zdCByZXN0YXVyYW50UmVmID0gZG9jKGRiLCAncmVzdGF1cmFudHMnLCByZXN0YXVyYW50SWQpO1xyXG4gICAgYXdhaXQgdXBkYXRlRG9jKHJlc3RhdXJhbnRSZWYsIHtcclxuICAgICAgcmF0aW5nOiBOdW1iZXIoYXZlcmFnZVJhdGluZy50b0ZpeGVkKDEpKSxcclxuICAgICAgcmV2aWV3Q291bnQ6IHJldmlld0NvdW50LFxyXG4gICAgICBsYXN0UmF0aW5nVXBkYXRlOiBzZXJ2ZXJUaW1lc3RhbXAoKVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIGNvbnNvbGUubG9nKGDinIUgU3luY2VkIHJhdGluZyBmb3IgJHtyZXN0YXVyYW50SWR9OiAke2F2ZXJhZ2VSYXRpbmcudG9GaXhlZCgxKX0gKCR7cmV2aWV3Q291bnR9IHJldmlld3MpYCk7XHJcbiAgICBcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgIHJhdGluZzogYXZlcmFnZVJhdGluZyxcclxuICAgICAgcmV2aWV3Q291bnQ6IHJldmlld0NvdW50XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBFcnJvciBzeW5jaW5nIHJhdGluZzonLCBlcnJvcik7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICB9XHJcbn07XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT0gUkVQT1JUIFJFVklFVyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuZXhwb3J0IGNvbnN0IHJlcG9ydFJldmlldyA9IGFzeW5jIChyZXBvcnREYXRhKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHJlcG9ydFJlZiA9IGF3YWl0IGFkZERvYyhjb2xsZWN0aW9uKGRiLCAncmV2aWV3UmVwb3J0cycpLCB7XHJcbiAgICAgIC4uLnJlcG9ydERhdGEsXHJcbiAgICAgIGNyZWF0ZWRBdDogc2VydmVyVGltZXN0YW1wKCksXHJcbiAgICAgIHVwZGF0ZWRBdDogc2VydmVyVGltZXN0YW1wKClcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICAvLyBVcGRhdGUgcmV2aWV3IGRlbmdhbiBzdGF0dXMgcmVwb3J0XHJcbiAgICBjb25zdCByZXZpZXdSZWYgPSBkb2MoZGIsICdyZXZpZXdzJywgcmVwb3J0RGF0YS5yZXZpZXdJZCk7XHJcbiAgICBhd2FpdCB1cGRhdGVEb2MocmV2aWV3UmVmLCB7XHJcbiAgICAgIHJlcG9ydFN0YXR1czogJ3BlbmRpbmcnLFxyXG4gICAgICByZXBvcnRlZEF0OiBzZXJ2ZXJUaW1lc3RhbXAoKSxcclxuICAgICAgdXBkYXRlZEF0OiBzZXJ2ZXJUaW1lc3RhbXAoKVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIC8vIE5vdGlmeSBhZG1pbiAoc3lzdGVtIG5vdGlmaWNhdGlvbilcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHRpdGxlID0gJ0xhcG9yYW4gVWxhc2FuIEJhcnUnO1xyXG4gICAgICBjb25zdCByZXN0YXVyYW50ID0gcmVwb3J0RGF0YS5yZXN0YXVyYW50TmFtZSB8fCByZXBvcnREYXRhLnJlc3RhdXJhbnRJZCB8fCAnUmVzdG9yYW4nO1xyXG4gICAgICBjb25zdCByZWFzb24gPSByZXBvcnREYXRhLnJlYXNvbiB8fCByZXBvcnREYXRhLmNhdGVnb3J5IHx8ICdBbGFzYW4gdGlkYWsgdGVyc2VkaWEnO1xyXG4gICAgICBjb25zdCBtZXNzYWdlID0gYFVsYXNhbiBkaWxhcG9ya2FuIHBhZGEgJHtyZXN0YXVyYW50fS4gQWxhc2FuOiAke3JlYXNvbn0uYDtcclxuICAgICAgYXdhaXQgY3JlYXRlU3lzdGVtTm90aWZpY2F0aW9uKHRpdGxlLCBtZXNzYWdlLCAncmV2aWV3X3JlcG9ydCcsIHJlcG9ydFJlZi5pZCk7XHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgIGNvbnNvbGUud2FybignRmFpbGVkIHRvIGNyZWF0ZSBhZG1pbiBub3RpZmljYXRpb24gZm9yIHJldmlldyByZXBvcnQ6JywgZT8ubWVzc2FnZSB8fCBlKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgcmVwb3J0SWQ6IHJlcG9ydFJlZi5pZCB9O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZXBvcnRpbmcgcmV2aWV3OicsIGVycm9yKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gIH1cclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBnZXRSZXZpZXdSZXBvcnRzID0gYXN5bmMgKHN0YXR1cyA9ICdwZW5kaW5nJykgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBsZXQgcTtcclxuICAgIGlmIChzdGF0dXMgPT09ICdhbGwnKSB7XHJcbiAgICAgIHEgPSBxdWVyeShcclxuICAgICAgICBjb2xsZWN0aW9uKGRiLCAncmV2aWV3UmVwb3J0cycpLFxyXG4gICAgICAgIG9yZGVyQnkoJ2NyZWF0ZWRBdCcsICdkZXNjJylcclxuICAgICAgKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHEgPSBxdWVyeShcclxuICAgICAgICBjb2xsZWN0aW9uKGRiLCAncmV2aWV3UmVwb3J0cycpLFxyXG4gICAgICAgIHdoZXJlKCdyZXBvcnRTdGF0dXMnLCAnPT0nLCBzdGF0dXMpLFxyXG4gICAgICAgIG9yZGVyQnkoJ2NyZWF0ZWRBdCcsICdkZXNjJylcclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBzbmFwc2hvdCA9IGF3YWl0IGdldERvY3MocSk7XHJcbiAgICBjb25zdCByZXBvcnRzID0gc25hcHNob3QuZG9jcy5tYXAoZG9jID0+ICh7XHJcbiAgICAgIGlkOiBkb2MuaWQsXHJcbiAgICAgIC4uLmRvYy5kYXRhKCksXHJcbiAgICAgIC8vIGtlZXAgY3JlYXRlZEF0IGFzIEZpcmVzdG9yZSBUaW1lc3RhbXAgZm9yIFVJIC50b0RhdGUoKSB1c2FnZVxyXG4gICAgfSkpO1xyXG5cclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHJlcG9ydHMgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZ2V0dGluZyByZXZpZXcgcmVwb3J0czonLCBlcnJvcik7XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfTtcclxuICB9XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgdXBkYXRlUmVwb3J0U3RhdHVzID0gYXN5bmMgKHJlcG9ydElkLCBzdGF0dXMsIGFkbWluTm90ZXMgPSAnJykgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCByZXBvcnRSZWYgPSBkb2MoZGIsICdyZXZpZXdSZXBvcnRzJywgcmVwb3J0SWQpO1xyXG4gICAgYXdhaXQgdXBkYXRlRG9jKHJlcG9ydFJlZiwge1xyXG4gICAgICByZXBvcnRTdGF0dXM6IHN0YXR1cyxcclxuICAgICAgYWRtaW5Ob3RlcyxcclxuICAgICAgdXBkYXRlZEF0OiBzZXJ2ZXJUaW1lc3RhbXAoKSxcclxuICAgICAgcmVzb2x2ZWRBdDogc3RhdHVzICE9PSAncGVuZGluZycgPyBzZXJ2ZXJUaW1lc3RhbXAoKSA6IG51bGxcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICBpZiAoc3RhdHVzID09PSAnYXBwcm92ZWQnKSB7XHJcbiAgICAgIGNvbnN0IHJlcG9ydERvYyA9IGF3YWl0IGdldERvYyhyZXBvcnRSZWYpO1xyXG4gICAgICBjb25zdCByZXBvcnREYXRhID0gcmVwb3J0RG9jLmRhdGEoKTtcclxuICAgICAgXHJcbiAgICAgIGNvbnN0IHJldmlld1JlZiA9IGRvYyhkYiwgJ3Jldmlld3MnLCByZXBvcnREYXRhLnJldmlld0lkKTtcclxuICAgICAgYXdhaXQgdXBkYXRlRG9jKHJldmlld1JlZiwge1xyXG4gICAgICAgIHJlcG9ydFN0YXR1czogJ2FwcHJvdmVkJyxcclxuICAgICAgICB1cGRhdGVkQXQ6IHNlcnZlclRpbWVzdGFtcCgpXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIHJlcG9ydCBzdGF0dXM6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgfVxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGNyZWF0ZVJlc2VydmF0aW9uTm90aWZpY2F0aW9uID0gYXN5bmMgKG93bmVySWQsIHJlc2VydmF0aW9uRGF0YSkgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmxvZygn8J+TnSBNZW1idWF0IG5vdGlmaWthc2kgdW50dWsgb3duZXI6Jywgb3duZXJJZCk7XHJcbiAgICBjb25zb2xlLmxvZygn8J+TiiBEYXRhIHJlc2VydmFzaTonLCByZXNlcnZhdGlvbkRhdGEpO1xyXG5cclxuICAgIGlmICghb3duZXJJZCkge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCfinYwgT3duZXIgSUQgdGlkYWsgZGl0ZW11a2FuJyk7XHJcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ093bmVyIElEIHRpZGFrIGRpdGVtdWthbicgfTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBub3RpZmljYXRpb25EYXRhID0ge1xyXG4gICAgICBvd25lcklkOiBvd25lcklkLFxyXG4gICAgICB0eXBlOiAnbmV3X3Jlc2VydmF0aW9uJyxcclxuICAgICAgdGl0bGU6ICfwn46JIFJlc2VydmFzaSBCYXJ1IScsXHJcbiAgICAgIG1lc3NhZ2U6IGAke3Jlc2VydmF0aW9uRGF0YS5jdXN0b21lck5hbWV9IG1lbWJ1YXQgcmVzZXJ2YXNpIHVudHVrICR7cmVzZXJ2YXRpb25EYXRhLmd1ZXN0Q291bnR9IG9yYW5nYCxcclxuICAgICAgcmVzdGF1cmFudE5hbWU6IHJlc2VydmF0aW9uRGF0YS5yZXN0YXVyYW50TmFtZSxcclxuICAgICAgY3VzdG9tZXJOYW1lOiByZXNlcnZhdGlvbkRhdGEuY3VzdG9tZXJOYW1lLFxyXG4gICAgICBndWVzdENvdW50OiByZXNlcnZhdGlvbkRhdGEuZ3Vlc3RDb3VudCxcclxuICAgICAgcmVzZXJ2YXRpb25JZDogcmVzZXJ2YXRpb25EYXRhLmlkLFxyXG4gICAgICByZXN0YXVyYW50SWQ6IHJlc2VydmF0aW9uRGF0YS5yZXN0YXVyYW50SWQsXHJcbiAgICAgIGlzUmVhZDogZmFsc2UsXHJcbiAgICAgIGNyZWF0ZWRBdDogc2VydmVyVGltZXN0YW1wKCksXHJcbiAgICAgIGRhdGU6IHJlc2VydmF0aW9uRGF0YS5kYXRlLFxyXG4gICAgICB0aW1lOiByZXNlcnZhdGlvbkRhdGEudGltZSxcclxuICAgICAgcGhvbmU6IHJlc2VydmF0aW9uRGF0YS5waG9uZSxcclxuICAgICAgdG90YWxQcmljZTogcmVzZXJ2YXRpb25EYXRhLnRvdGFsUHJpY2UsXHJcbiAgICAgIGRvd25QYXltZW50OiByZXNlcnZhdGlvbkRhdGEuZG93blBheW1lbnRcclxuICAgIH07XHJcblxyXG4gICAgY29uc29sZS5sb2coJ/Cfk4QgRGF0YSBub3RpZmlrYXNpIHlhbmcgYWthbiBkaXNpbXBhbjonLCBub3RpZmljYXRpb25EYXRhKTtcclxuXHJcbiAgICBjb25zdCBkb2NSZWYgPSBhd2FpdCBhZGREb2MoY29sbGVjdGlvbihkYiwgJ25vdGlmaWNhdGlvbnMnKSwgbm90aWZpY2F0aW9uRGF0YSk7XHJcbiAgICBcclxuICAgIGNvbnNvbGUubG9nKCfinIUgTm90aWZpa2FzaSBiZXJoYXNpbCBkaWJ1YXQgZGVuZ2FuIElEOicsIGRvY1JlZi5pZCk7XHJcbiAgICByZXR1cm4geyBcclxuICAgICAgc3VjY2VzczogdHJ1ZSwgXHJcbiAgICAgIGlkOiBkb2NSZWYuaWQsXHJcbiAgICAgIG1lc3NhZ2U6ICdOb3RpZmlrYXNpIGJlcmhhc2lsIGRpYnVhdCcgXHJcbiAgICB9O1xyXG4gICAgXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBFcnJvciBjcmVhdGluZyBub3RpZmljYXRpb246JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHsgXHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLCBcclxuICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UsXHJcbiAgICAgIHN0YWNrOiBlcnJvci5zdGFjayBcclxuICAgIH07XHJcbiAgfVxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGdldFJlcG9ydHMgPSBhc3luYyAoKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHEgPSBxdWVyeShcclxuICAgICAgY29sbGVjdGlvbihkYiwgJ3JlcG9ydHMnKSxcclxuICAgICAgd2hlcmUoJ3Jldmlld0lkJywgJyE9JywgbnVsbCksIC8vIEhhbnlhIHJlcG9ydHMgeWFuZyBhZGEgcmV2aWV3SWRcclxuICAgICAgb3JkZXJCeSgnY3JlYXRlZEF0JywgJ2Rlc2MnKVxyXG4gICAgKTtcclxuICAgIGNvbnN0IHF1ZXJ5U25hcHNob3QgPSBhd2FpdCBnZXREb2NzKHEpO1xyXG4gICAgY29uc3QgcmVwb3J0cyA9IHF1ZXJ5U25hcHNob3QuZG9jcy5tYXAoZG9jID0+ICh7IFxyXG4gICAgICBpZDogZG9jLmlkLCBcclxuICAgICAgLi4uZG9jLmRhdGEoKSBcclxuICAgIH0pKTtcclxuICAgIFxyXG4gICAgLy8gQ29udmVydCB0aW1lc3RhbXBzXHJcbiAgICByZXR1cm4gcmVwb3J0cy5tYXAocmVwb3J0ID0+ICh7XHJcbiAgICAgIC4uLnJlcG9ydCxcclxuICAgICAgY3JlYXRlZEF0OiByZXBvcnQuY3JlYXRlZEF0Py50b0RhdGUgPyByZXBvcnQuY3JlYXRlZEF0LnRvRGF0ZSgpIDogcmVwb3J0LmNyZWF0ZWRBdCxcclxuICAgICAgdXBkYXRlZEF0OiByZXBvcnQudXBkYXRlZEF0Py50b0RhdGUgPyByZXBvcnQudXBkYXRlZEF0LnRvRGF0ZSgpIDogcmVwb3J0LnVwZGF0ZWRBdFxyXG4gICAgfSkpO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZXR0aW5nIHJlcG9ydHM6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIFtdO1xyXG4gIH1cclxufTtcclxuXHJcbi8vIEdldCB1c2VyIGJ5IElEXHJcbmV4cG9ydCBjb25zdCBnZXRVc2VyQnlJZCA9IGFzeW5jICh1c2VySWQpID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgdXNlckRvYyA9IGF3YWl0IGdldERvYyhkb2MoZGIsICd1c2VycycsIHVzZXJJZCkpO1xyXG4gICAgaWYgKHVzZXJEb2MuZXhpc3RzKCkpIHtcclxuICAgICAgcmV0dXJuIHsgaWQ6IHVzZXJEb2MuaWQsIC4uLnVzZXJEb2MuZGF0YSgpIH07XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZ2V0dGluZyB1c2VyOicsIGVycm9yKTtcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxufTtcclxuXHJcbi8vIEdldCByZXZpZXcgYnkgSURcclxuZXhwb3J0IGNvbnN0IGdldFJldmlld0J5SWQgPSBhc3luYyAocmV2aWV3SWQpID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgcmV2aWV3RG9jID0gYXdhaXQgZ2V0RG9jKGRvYyhkYiwgJ3Jldmlld3MnLCByZXZpZXdJZCkpO1xyXG4gICAgaWYgKHJldmlld0RvYy5leGlzdHMoKSkge1xyXG4gICAgICBjb25zdCBkYXRhID0gcmV2aWV3RG9jLmRhdGEoKTtcclxuICAgICAgcmV0dXJuIHsgXHJcbiAgICAgICAgaWQ6IHJldmlld0RvYy5pZCwgXHJcbiAgICAgICAgLi4uZGF0YSxcclxuICAgICAgICBjcmVhdGVkQXQ6IGRhdGEuY3JlYXRlZEF0Py50b0RhdGUgPyBkYXRhLmNyZWF0ZWRBdC50b0RhdGUoKSA6IGRhdGEuY3JlYXRlZEF0XHJcbiAgICAgIH07XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZ2V0dGluZyByZXZpZXc6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG59O1xyXG5cclxuLy8gRGVsZXRlIHJldmlld1xyXG5leHBvcnQgY29uc3QgZGVsZXRlUmV2aWV3ID0gYXN5bmMgKHJldmlld0lkKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIC8vIEZldGNoIHJldmlldyB0byBnZXQgcmVzdGF1cmFudElkIGJlZm9yZSBkZWxldGlvblxyXG4gICAgY29uc3QgcmV2aWV3UmVmID0gZG9jKGRiLCAncmV2aWV3cycsIHJldmlld0lkKTtcclxuICAgIGNvbnN0IHNuYXAgPSBhd2FpdCBnZXREb2MocmV2aWV3UmVmKTtcclxuICAgIGNvbnN0IHJlc3RhdXJhbnRJZCA9IHNuYXAuZXhpc3RzKCkgPyBzbmFwLmRhdGEoKS5yZXN0YXVyYW50SWQgOiBudWxsO1xyXG5cclxuICAgIC8vIERlbGV0ZSByZXZpZXdcclxuICAgIGF3YWl0IGRlbGV0ZURvYyhyZXZpZXdSZWYpO1xyXG4gICAgXHJcbiAgICAvLyBMb2cgZGVsZXRpb25cclxuICAgIGF3YWl0IGFkZERvYyhjb2xsZWN0aW9uKGRiLCAncmV2aWV3X2RlbGV0aW9ucycpLCB7XHJcbiAgICAgIHJldmlld0lkLFxyXG4gICAgICByZXN0YXVyYW50SWQ6IHJlc3RhdXJhbnRJZCB8fCBudWxsLFxyXG4gICAgICBkZWxldGVkQXQ6IHNlcnZlclRpbWVzdGFtcCgpLFxyXG4gICAgICBkZWxldGVkQnk6ICdhZG1pbicsXHJcbiAgICAgIHJlYXNvbjogJ1JlcG9ydCBhcHByb3ZlZCdcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIFJlY2FsY3VsYXRlIHJlc3RhdXJhbnQgcmF0aW5nIHNvIGxpc3RpbmcgY2FyZHMgc3RheSBpbiBzeW5jXHJcbiAgICBpZiAocmVzdGF1cmFudElkKSB7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgYXdhaXQgdXBkYXRlUmVzdGF1cmFudFJhdGluZyhyZXN0YXVyYW50SWQpO1xyXG4gICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gdXBkYXRlIHJlc3RhdXJhbnQgcmF0aW5nIGFmdGVyIGRlbGV0aW9uOicsIGU/Lm1lc3NhZ2UgfHwgZSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyByZXZpZXc6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XHJcbiAgfVxyXG59O1xyXG5cclxuLy8gQ291bnQgdXNlciBhcHByb3ZlZCByZXBvcnRzXHJcbmV4cG9ydCBjb25zdCBjb3VudFVzZXJBcHByb3ZlZFJlcG9ydHMgPSBhc3luYyAodXNlcklkKSA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHEgPSBxdWVyeShcclxuICAgICAgY29sbGVjdGlvbihkYiwgJ3JlcG9ydHMnKSxcclxuICAgICAgd2hlcmUoJ3VzZXJJZCcsICc9PScsIHVzZXJJZCksXHJcbiAgICAgIHdoZXJlKCdzdGF0dXMnLCAnPT0nLCAnYXBwcm92ZWQnKVxyXG4gICAgKTtcclxuICAgIGNvbnN0IHF1ZXJ5U25hcHNob3QgPSBhd2FpdCBnZXREb2NzKHEpO1xyXG4gICAgcmV0dXJuIHF1ZXJ5U25hcHNob3Quc2l6ZTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgY291bnRpbmcgdXNlciByZXBvcnRzOicsIGVycm9yKTtcclxuICAgIHJldHVybiAwO1xyXG4gIH1cclxufTtcclxuXHJcblxyXG5cclxuLy8gRXhwb3J0IHNlbXVhIGZ1bmdzaVxyXG5leHBvcnQgZGVmYXVsdCB7XHJcbiAgLy8gUHJvbW8gRnVuY3Rpb25zXHJcbiAgYWRkUHJvbW8sXHJcbiAgYWRkUHJvbW9BbmRVcGRhdGVSZXN0YXVyYW50LFxyXG4gIGdldEFjdGl2ZVByb21vc0ZvclJlc3RhdXJhbnQsXHJcbiAgZ2V0QWN0aXZlUHJvbW9zRm9yTWVudSxcclxuICBnZXRQcm9tb3NCeVJlc3RhdXJhbnRJZCxcclxuICB1cGRhdGVQcm9tbyxcclxuICBkZWxldGVQcm9tbyxcclxuICBnZXRQcm9tb0J5SWQsXHJcbiAgXHJcbiAgLy8gTWVudSAmIFJlc3RhdXJhbnQgRnVuY3Rpb25zXHJcbiAgZ2V0TWVudXNCeVJlc3RhdXJhbnRJZCxcclxuICBnZXRSZXN0YXVyYW50QnlJZCxcclxuICBnZXRSZXN0YXVyYW50c0J5T3duZXIsXHJcbiAgY3JlYXRlUmVzdGF1cmFudCxcclxuICBnZXRBbGxSZXN0YXVyYW50cyxcclxuICB1cGRhdGVSZXN0YXVyYW50U3RhdHVzLFxyXG4gIHVwZGF0ZVJlc3RhdXJhbnQsXHJcbiAgdXBkYXRlUmVzdGF1cmFudE9wZW5TdGF0dXMsXHJcbiAgXHJcbiAgLy8gTm90aWZpY2F0aW9uIEZ1bmN0aW9uc1xyXG4gIGdldFN5c3RlbU5vdGlmaWNhdGlvbnMsXHJcbiAgY3JlYXRlU3lzdGVtTm90aWZpY2F0aW9uLFxyXG4gIGdldE93bmVyTm90aWZpY2F0aW9ucyxcclxuICBnZXRVc2VyTm90aWZpY2F0aW9ucyxcclxuICBnZXRVc2VyTm90aWZpY2F0aW9uc09uY2UsXHJcbiAgbWFya05vdGlmaWNhdGlvbkFzUmVhZCxcclxuICBtYXJrQWxsTm90aWZpY2F0aW9uc0FzUmVhZCxcclxuICBjcmVhdGVOb3RpZmljYXRpb24sXHJcbiAgZGVsZXRlTm90aWZpY2F0aW9uLFxyXG4gIGRlbGV0ZUFsbE93bmVyTm90aWZpY2F0aW9ucyxcclxuICBcclxuICAvLyBSZXZpZXcgRnVuY3Rpb25zXHJcbiAgYWRkUmV2aWV3LFxyXG4gIGdldFJlc3RhdXJhbnRSZXZpZXdzLFxyXG4gIGdldE93bmVyUmV2aWV3cyxcclxuICBnZXRVc2VyUmV2aWV3cyxcclxuICB1cGRhdGVSZXZpZXdSZXBseSxcclxuICB1cGRhdGVSZXN0YXVyYW50UmF0aW5nLFxyXG4gIHJlcG9ydFJldmlldyxcclxuICBnZXRSZXZpZXdSZXBvcnRzLFxyXG4gIHVwZGF0ZVJlcG9ydFN0YXR1cyxcclxuICBcclxuICAvLyBSZXNlcnZhdGlvbiBGdW5jdGlvbnNcclxuICBnZXRSZXN0YXVyYW50UmVzZXJ2YXRpb25zLFxyXG4gIGNyZWF0ZVJlc2VydmF0aW9uLFxyXG4gIHN1YnNjcmliZVRvUmVzdGF1cmFudFJlc2VydmF0aW9ucyxcclxuICBcclxuICAvLyBGYXZvcml0ZSBGdW5jdGlvbnNcclxuICBpc1Jlc3RhdXJhbnRGYXZvcml0ZSxcclxuICBhZGRUb0Zhdm9yaXRlcyxcclxuICByZW1vdmVGcm9tRmF2b3JpdGVzLFxyXG4gIGdldFVzZXJGYXZvcml0ZXMsXHJcbiAgdG9nZ2xlRmF2b3JpdGUsXHJcbiAgXHJcbiAgLy8gT3RoZXIgRnVuY3Rpb25zXHJcbiAgZ2V0RGFzaGJvYXJkU3RhdHMsXHJcbiAgdXBkYXRlVXNlcixcclxuICBnZXRBbGxVc2VycyxcclxuICB1cGRhdGVVc2VyUm9sZVxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGNyZWF0ZVVzZXJSZXNlcnZhdGlvbk5vdGlmaWNhdGlvbiA9IGFzeW5jICh1c2VySWQsIHJlc2VydmF0aW9uRGF0YSkgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBpZiAoIXVzZXJJZCkgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnVXNlciBJRCB0aWRhayBkaXRlbXVrYW4nIH07XHJcbiAgICBjb25zdCBub3RpZmljYXRpb25EYXRhID0ge1xyXG4gICAgICB1c2VySWQsXHJcbiAgICAgIHR5cGU6ICdyZXNlcnZhdGlvbl9jb25maXJtZWQnLFxyXG4gICAgICB0aXRsZTogJ1Jlc2VydmFzaSBEaXNldHVqdWknLFxyXG4gICAgICBtZXNzYWdlOiBgUmVzZXJ2YXNpIEFuZGEgZGkgJHtyZXNlcnZhdGlvbkRhdGEucmVzdGF1cmFudE5hbWV9IHVudHVrICR7cmVzZXJ2YXRpb25EYXRhLmd1ZXN0Q291bnR9IG9yYW5nIHRlbGFoIGRpa29uZmlybWFzaWAsXHJcbiAgICAgIHJlc2VydmF0aW9uSWQ6IHJlc2VydmF0aW9uRGF0YS5pZCxcclxuICAgICAgcmVzdGF1cmFudElkOiByZXNlcnZhdGlvbkRhdGEucmVzdGF1cmFudElkLFxyXG4gICAgICByZXN0YXVyYW50TmFtZTogcmVzZXJ2YXRpb25EYXRhLnJlc3RhdXJhbnROYW1lLFxyXG4gICAgICBkYXRlOiByZXNlcnZhdGlvbkRhdGEuZGF0ZSxcclxuICAgICAgdGltZTogcmVzZXJ2YXRpb25EYXRhLnRpbWUsXHJcbiAgICAgIHRvdGFsUHJpY2U6IHJlc2VydmF0aW9uRGF0YS50b3RhbFByaWNlLFxyXG4gICAgICBkb3duUGF5bWVudDogcmVzZXJ2YXRpb25EYXRhLmRvd25QYXltZW50LFxyXG4gICAgICBpc1JlYWQ6IGZhbHNlLFxyXG4gICAgICBjcmVhdGVkQXQ6IHNlcnZlclRpbWVzdGFtcCgpLFxyXG4gICAgICB1cGRhdGVkQXQ6IHNlcnZlclRpbWVzdGFtcCgpLFxyXG4gICAgfTtcclxuICAgIGNvbnN0IGRvY1JlZiA9IGF3YWl0IGFkZERvYyhjb2xsZWN0aW9uKGRiLCAnbm90aWZpY2F0aW9ucycpLCBub3RpZmljYXRpb25EYXRhKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGlkOiBkb2NSZWYuaWQgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcign4p2MIEVycm9yIGNyZWF0aW5nIHVzZXIgcmVzZXJ2YXRpb24gbm90aWZpY2F0aW9uOicsIGVycm9yKTtcclxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9O1xyXG4gIH1cclxufTsiXSwibmFtZXMiOlsiY29sbGVjdGlvbiIsImRvYyIsImdldERvYyIsImdldERvY3MiLCJzZXREb2MiLCJ1cGRhdGVEb2MiLCJkZWxldGVEb2MiLCJxdWVyeSIsIndoZXJlIiwib3JkZXJCeSIsImxpbWl0IiwiYWRkRG9jIiwib25TbmFwc2hvdCIsIndyaXRlQmF0Y2giLCJzZXJ2ZXJUaW1lc3RhbXAiLCJkYiIsImFzRGF0ZSIsInYiLCJ0b0RhdGUiLCJnZXRVc2Vyc1dpdGhBcHByb3ZlZFJlcG9ydHMiLCJtaW5Db3VudCIsInEiLCJzbmFwIiwiY291bnRzIiwiTWFwIiwibGFzdENyZWF0ZWRBdCIsImJ5VXNlciIsImZvckVhY2giLCJkIiwiZGF0YSIsInVpZCIsInVzZXJJZCIsInNldCIsImdldCIsImNyZWF0ZWQiLCJjcmVhdGVkQXQiLCJwcmV2IiwicmVzdWx0cyIsImtleXMiLCJjb3VudCIsInVzZXJTbmFwIiwidXNlciIsImV4aXN0cyIsInB1c2giLCJsYXN0UmVwb3J0QXQiLCJkaXNwbGF5TmFtZSIsIm5hbWUiLCJlbWFpbCIsInNvcnQiLCJhIiwiYiIsInN1Y2Nlc3MiLCJlcnIiLCJjb25zb2xlIiwiZXJyb3IiLCJtZXNzYWdlIiwiZ2V0VXNlcnNXaXRoUmVwZWF0ZWROZWdhdGl2ZVJldmlld3MiLCJ0aHJlc2hvbGQiLCJrZXlDb3VudHMiLCJsYXN0QXQiLCJyaWQiLCJyZXN0YXVyYW50SWQiLCJrZXkiLCJlbnRyaWVzIiwic3BsaXQiLCJyZXN0U25hcCIsInJlc3RhdXJhbnQiLCJ1c2VyTmFtZSIsInVzZXJFbWFpbCIsInJlc3RhdXJhbnROYW1lIiwiZ2V0TG93UmF0ZWRSZXN0YXVyYW50cyIsImRvY3MiLCJtYXAiLCJpZCIsImdldFJlcG9ydGVkVXNlcnNCeVN0YXR1cyIsInN0YXR1cyIsInJldmlld0lkcyIsIlNldCIsImNyZWF0ZWRNYXAiLCJyZXZpZXdJZCIsImFkZCIsInJldmlld0RvY3MiLCJQcm9taXNlIiwiYWxsIiwiQXJyYXkiLCJmcm9tIiwidXNlckNvdW50cyIsInVzZXJMYXN0IiwidXNlclNldCIsImxhc3QiLCJ1c2VycyIsInRoZW4iLCJhZGRQcm9tb0FuZFVwZGF0ZVJlc3RhdXJhbnQiLCJwcm9tb0RhdGEiLCJsb2ciLCJwcm9tb1JlZiIsInVwZGF0ZWRBdCIsInJlc3RhdXJhbnRSZWYiLCJpc1Byb21vIiwiZGlzY291bnQiLCJkaXNjb3VudFZhbHVlIiwibWluUHVyY2hhc2UiLCJwcm9tb0V4cGlyeSIsImVuZERhdGUiLCJwcm9tb1RpdGxlIiwicHJvbW9EZXNjcmlwdGlvbiIsImRlc2NyaXB0aW9uIiwicHJvbW9UZXh0IiwiZGlzY291bnRUeXBlIiwiYWRkUHJvbW8iLCJnZXRBY3RpdmVQcm9tb3NGb3JSZXN0YXVyYW50IiwidG9kYXkiLCJEYXRlIiwic2V0SG91cnMiLCJxdWVyeVNuYXBzaG90IiwicHJvbW9zIiwic3RhcnREYXRlIiwibGVuZ3RoIiwiZ2V0TWVudXNCeVJlc3RhdXJhbnRJZCIsIm1lbnVzUmVmIiwibWVudXMiLCJtZW51RGF0YSIsImZhbGxiYWNrUXVlcnkiLCJmYWxsYmFja1NuYXBzaG90IiwiZmFsbGJhY2tNZW51cyIsImZhbGxiYWNrRXJyb3IiLCJnZXRBY3RpdmVQcm9tb3NGb3JNZW51IiwibWVudUlkIiwiZ2V0UmVzdGF1cmFudEJ5SWQiLCJkb2NSZWYiLCJkb2NTbmFwIiwiRXJyb3IiLCJnZXRSZXN0YXVyYW50c0J5T3duZXIiLCJvd25lcklkIiwicmVzdGF1cmFudHNSZWYiLCJyZXN0YXVyYW50cyIsImdldFN5c3RlbU5vdGlmaWNhdGlvbnMiLCJsaW1pdENvdW50IiwicmVzdWx0IiwicmVhZEF0IiwiZ2V0UGVuZGluZ1Jlc3RhdXJhbnRzQ291bnQiLCJzaXplIiwiY3JlYXRlU3lzdGVtTm90aWZpY2F0aW9uIiwidGl0bGUiLCJ0eXBlIiwicmVsYXRlZElkIiwicmVmIiwicmVhZCIsImdldFVucmVhZFN5c3RlbU5vdGlmaWNhdGlvbnNDb3VudCIsIm1hcmtBbGxTeXN0ZW1Ob3RpZmljYXRpb25zQXNSZWFkIiwiYmF0Y2giLCJ1cGRhdGUiLCJjb21taXQiLCJtYXJrU3lzdGVtTm90aWZpY2F0aW9uQXNSZWFkIiwibm90aWZpY2F0aW9uSWQiLCJ1cGRhdGVVc2VyIiwidXBkYXRlRGF0YSIsImdldEFsbFVzZXJzIiwiY3JlYXRlUmVzdGF1cmFudCIsInJlc3RhdXJhbnREYXRhIiwiZXhpc3RpbmdSZXN0YXVyYW50cyIsImUiLCJ3YXJuIiwiZ2V0QWxsUmVzdGF1cmFudHMiLCJ1cGRhdGVSZXN0YXVyYW50U3RhdHVzIiwicmVqZWN0aW9uUmVhc29uIiwicmVqZWN0aW9uRGF0ZSIsInVwZGF0ZVJlc3RhdXJhbnQiLCJnZXRSZXN0YXVyYW50UmVzZXJ2YXRpb25zIiwiZGF0ZSIsImlzUmVzdGF1cmFudEZhdm9yaXRlIiwiaXNGYXZvcml0ZSIsImVtcHR5IiwiYWRkVG9GYXZvcml0ZXMiLCJkb2NJZCIsImZhdm9yaXRlUmVmIiwiYWRkZWRBdCIsInJlbW92ZUZyb21GYXZvcml0ZXMiLCJmYXZvcml0ZVNuYXAiLCJnZXRVc2VyRmF2b3JpdGVzIiwiZmF2b3JpdGVzIiwiT2JqZWN0IiwicmVzdGF1cmFudERvYyIsImltYWdlIiwiY2F0ZWdvcnkiLCJyYXRpbmciLCJmZXRjaEVycm9yIiwidG9nZ2xlRmF2b3JpdGUiLCJhY3Rpb24iLCJyZXN0RGF0YSIsInByaWNlUmFuZ2UiLCJhZGRyZXNzIiwiY3JlYXRlTm90aWZpY2F0aW9uIiwibm90aWZpY2F0aW9uRGF0YSIsIm5vdGlmaWNhdGlvblJlZiIsImlzUmVhZCIsImdldE93bmVyTm90aWZpY2F0aW9ucyIsImNhbGxiYWNrIiwidW5zdWJzY3JpYmUiLCJub3RpZmljYXRpb25zIiwiZ2V0VW5yZWFkTm90aWZpY2F0aW9uQ291bnQiLCJtYXJrTm90aWZpY2F0aW9uQXNSZWFkIiwibWFya0FsbE5vdGlmaWNhdGlvbnNBc1JlYWQiLCJkb2NTbmFwc2hvdCIsImNyZWF0ZVJlc2VydmF0aW9uIiwicmVzZXJ2YXRpb25EYXRhIiwicmVzZXJ2YXRpb25SZWYiLCJyZXNlcnZhdGlvbklkIiwiY3VzdG9tZXJOYW1lIiwiZ3Vlc3RDb3VudCIsInRpbWUiLCJkZWxldGVOb3RpZmljYXRpb24iLCJkZWxldGVBbGxPd25lck5vdGlmaWNhdGlvbnMiLCJzbmFwc2hvdCIsImRlbGV0ZSIsImdldFVzZXJOb3RpZmljYXRpb25zIiwiZ2V0VXNlck5vdGlmaWNhdGlvbnNPbmNlIiwiZ2V0VW5yZWFkTm90aWZpY2F0aW9uc0NvdW50IiwiYWRkUmV2aWV3IiwicmV2aWV3RGF0YSIsInZhbGlkYXRlZERhdGEiLCJOdW1iZXIiLCJjb21tZW50IiwiaGFzT3duZXJSZXBseSIsIm93bmVyUmVwbHkiLCJvd25lck5hbWUiLCJyZXBsaWVkQXQiLCJyZXZpZXdSZWYiLCJyZXN0SWQiLCJub3RpZnlFcnIiLCJ1cGRhdGVSZXN0YXVyYW50UmF0aW5nIiwiZ2V0UmVzdGF1cmFudFJldmlld3MiLCJyZXZpZXdzIiwicmV2aWV3IiwidXBkYXRlUmV2aWV3UmVwbHkiLCJyZXBseURhdGEiLCJyZXBseSIsImdldE93bmVyUmVzdGF1cmFudHMiLCJnZXRPd25lclJldmlld3MiLCJyZXN0YXVyYW50c1F1ZXJ5IiwicmVzdGF1cmFudHNTbmFwc2hvdCIsInJlc3RhdXJhbnRJZHMiLCJyZXN0YXVyYW50TWFwIiwicmV2aWV3c1F1ZXJ5IiwicmV2aWV3c1NuYXBzaG90IiwiaW5jbHVkZXMiLCJnZXRVc2VyUmV2aWV3cyIsInJlc3RhdXJhbnRTbmFwIiwicmV2aWV3c1JlZiIsInJldmlld0NvdW50IiwibGFzdFJhdGluZ1VwZGF0ZSIsInRvdGFsUmF0aW5nIiwiYXZlcmFnZVJhdGluZyIsInRvRml4ZWQiLCJ1cGRhdGVVc2VyUm9sZSIsIm5ld1JvbGUiLCJ1c2VyUmVmIiwicm9sZSIsInN1c3BlbmRVc2VyQWNjb3VudCIsInJlYXNvbiIsInN1c3BlbnNpb25SZWFzb24iLCJzdXNwZW5kZWRBdCIsImFjdGlvbkJ5IiwiYWN0aW9uVHlwZSIsInN1c3BlbmRSZXN0YXVyYW50QWNjb3VudCIsInN1YnNjcmliZVRvUmVzdGF1cmFudFJlc2VydmF0aW9ucyIsInJlc2VydmF0aW9ucyIsImNyZWF0ZU1lbnUiLCJnZXRNZW51c0J5UmVzdGF1cmFudCIsInVwZGF0ZU1lbnUiLCJtZW51UmVmIiwiZGVsZXRlTWVudSIsImdldE1lbnVCeUlkIiwibWVudVNuYXAiLCJnZXRQcm9tb3NCeVJlc3RhdXJhbnRJZCIsInByb21vc1JlZiIsInVwZGF0ZVByb21vIiwicHJvbW9JZCIsImRlbGV0ZVByb21vIiwiZ2V0UHJvbW9CeUlkIiwicHJvbW9TbmFwIiwidXBkYXRlUmVzdGF1cmFudE9wZW5TdGF0dXMiLCJpc09wZW4iLCJnZXREYXNoYm9hcmRTdGF0cyIsInRvdGFsUGVuZGluZ1Jlc2VydmF0aW9ucyIsInRvdGFsVG9kYXlSZXNlcnZhdGlvbnMiLCJmaWx0ZXIiLCJyIiwidG9EYXRlU3RyaW5nIiwicmVzZXJ2YXRpb25EYXRlIiwidG90YWxSZXN0YXVyYW50cyIsImdldFJlc3RhdXJhbnRSZXZpZXdzU3VtbWFyeSIsInN5bmNSZXN0YXVyYW50UmF0aW5nIiwicmVwb3J0UmV2aWV3IiwicmVwb3J0RGF0YSIsInJlcG9ydFJlZiIsInJlcG9ydFN0YXR1cyIsInJlcG9ydGVkQXQiLCJyZXBvcnRJZCIsImdldFJldmlld1JlcG9ydHMiLCJyZXBvcnRzIiwidXBkYXRlUmVwb3J0U3RhdHVzIiwiYWRtaW5Ob3RlcyIsInJlc29sdmVkQXQiLCJyZXBvcnREb2MiLCJjcmVhdGVSZXNlcnZhdGlvbk5vdGlmaWNhdGlvbiIsInBob25lIiwidG90YWxQcmljZSIsImRvd25QYXltZW50Iiwic3RhY2siLCJnZXRSZXBvcnRzIiwicmVwb3J0IiwiZ2V0VXNlckJ5SWQiLCJ1c2VyRG9jIiwiZ2V0UmV2aWV3QnlJZCIsInJldmlld0RvYyIsImRlbGV0ZVJldmlldyIsImRlbGV0ZWRBdCIsImRlbGV0ZWRCeSIsImNvdW50VXNlckFwcHJvdmVkUmVwb3J0cyIsImNyZWF0ZVVzZXJSZXNlcnZhdGlvbk5vdGlmaWNhdGlvbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./lib/firestore.js\n");

/***/ })

};
;